import{r as G,j as o,a as Ta,u as os,d as qe,b as el}from"./index-BhCGuXjH.js";/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var js={};js.version="0.18.5";var Pi=1252,rl=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Ln={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Rn=function(e){rl.indexOf(e)!=-1&&(Pi=Ln[0]=e)};function tl(){Rn(1252)}var ut=function(e){Rn(e)};function Mn(){ut(1200),tl()}function y0(e){for(var t=[],r=0,a=e.length;r<a;++r)t[r]=e.charCodeAt(r);return t}function al(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function Bi(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var La=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?al(e.slice(2)):t==254&&r==255?Bi(e.slice(2)):t==65279?e.slice(1):e},ps=function(t){return String.fromCharCode(t)},b0=function(t){return String.fromCharCode(t)},Ga,Lt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Xa(e){for(var t="",r=0,a=0,s=0,n=0,i=0,c=0,l=0,f=0;f<e.length;)r=e.charCodeAt(f++),n=r>>2,a=e.charCodeAt(f++),i=(r&3)<<4|a>>4,s=e.charCodeAt(f++),c=(a&15)<<2|s>>6,l=s&63,isNaN(a)?c=l=64:isNaN(s)&&(l=64),t+=Lt.charAt(n)+Lt.charAt(i)+Lt.charAt(c)+Lt.charAt(l);return t}function Qr(e){var t="",r=0,a=0,s=0,n=0,i=0,c=0,l=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var f=0;f<e.length;)n=Lt.indexOf(e.charAt(f++)),i=Lt.indexOf(e.charAt(f++)),r=n<<2|i>>4,t+=String.fromCharCode(r),c=Lt.indexOf(e.charAt(f++)),a=(i&15)<<4|c>>2,c!==64&&(t+=String.fromCharCode(a)),l=Lt.indexOf(e.charAt(f++)),s=(c&3)<<6|l,l!==64&&(t+=String.fromCharCode(s));return t}var $e=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),jt=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function Pt(e){return $e?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function E0(e){return $e?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var qr=function(t){return $e?jt(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function $s(e){if(typeof ArrayBuffer>"u")return qr(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),a=0;a!=e.length;++a)r[a]=e.charCodeAt(a)&255;return t}function Ht(e){if(Array.isArray(e))return e.map(function(a){return String.fromCharCode(a)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function sl(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function Pn(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return Pn(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var Tr=$e?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:jt(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var a=new Uint8Array(r),s=0;for(t=0,r=0;t<e.length;r+=s,++t)if(s=e[t].length,e[t]instanceof Uint8Array)a.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";a.set(new Uint8Array(e[t]),r)}return a}return[].concat.apply([],e.map(function(n){return Array.isArray(n)?n:[].slice.call(n)}))};function nl(e){for(var t=[],r=0,a=e.length+250,s=Pt(e.length+255),n=0;n<e.length;++n){var i=e.charCodeAt(n);if(i<128)s[r++]=i;else if(i<2048)s[r++]=192|i>>6&31,s[r++]=128|i&63;else if(i>=55296&&i<57344){i=(i&1023)+64;var c=e.charCodeAt(++n)&1023;s[r++]=240|i>>8&7,s[r++]=128|i>>2&63,s[r++]=128|c>>6&15|(i&3)<<4,s[r++]=128|c&63}else s[r++]=224|i>>12&15,s[r++]=128|i>>6&63,s[r++]=128|i&63;r>a&&(t.push(s.slice(0,r)),r=0,s=Pt(65535),a=65530)}return t.push(s.slice(0,r)),Tr(t)}var Vr=/\u0000/g,Ra=/[\u0001-\u0006]/g;function wa(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function xt(e,t){var r=""+e;return r.length>=t?r:ur("0",t-r.length)+r}function Bn(e,t){var r=""+e;return r.length>=t?r:ur(" ",t-r.length)+r}function Ds(e,t){var r=""+e;return r.length>=t?r:r+ur(" ",t-r.length)}function il(e,t){var r=""+Math.round(e);return r.length>=t?r:ur("0",t-r.length)+r}function cl(e,t){var r=""+e;return r.length>=t?r:ur("0",t-r.length)+r}var S0=Math.pow(2,32);function xa(e,t){if(e>S0||e<-S0)return il(e,t);var r=Math.round(e);return cl(r,t)}function Is(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var T0=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],an=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function ol(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',e}var Ie={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"上午/下午 "hh"時"mm"分"ss"秒 "'},N0={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},ll={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Os(e,t,r){for(var a=e<0?-1:1,s=e*a,n=0,i=1,c=0,l=1,f=0,d=0,u=Math.floor(s);f<t&&(u=Math.floor(s),c=u*i+n,d=u*f+l,!(s-u<5e-8));)s=1/(s-u),n=i,i=c,l=f,f=d;if(d>t&&(f>t?(d=l,c=n):(d=f,c=i)),!r)return[0,a*c,d];var h=Math.floor(a*c/d);return[h,a*c-h*d,d]}function Jt(e,t,r){if(e>2958465||e<0)return null;var a=e|0,s=Math.floor(86400*(e-a)),n=0,i=[],c={D:a,T:s,u:86400*(e-a)-s,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(c.u)<1e-6&&(c.u=0),t&&t.date1904&&(a+=1462),c.u>.9999&&(c.u=0,++s==86400&&(c.T=s=0,++a,++c.D)),a===60)i=r?[1317,10,29]:[1900,2,29],n=3;else if(a===0)i=r?[1317,8,29]:[1900,1,0],n=6;else{a>60&&--a;var l=new Date(1900,0,1);l.setDate(l.getDate()+a-1),i=[l.getFullYear(),l.getMonth()+1,l.getDate()],n=l.getDay(),a<60&&(n=(n+6)%7),r&&(n=ml(l,i))}return c.y=i[0],c.m=i[1],c.d=i[2],c.S=s%60,s=Math.floor(s/60),c.M=s%60,s=Math.floor(s/60),c.H=s,c.q=n,c}var Ui=new Date(1899,11,31,0,0,0),fl=Ui.getTime(),dl=new Date(1900,2,1,0,0,0);function Wi(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=dl&&(r+=24*60*60*1e3),(r-(fl+(e.getTimezoneOffset()-Ui.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function Un(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function hl(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function ul(e){var t=e<0?12:11,r=Un(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function xl(e){var t=Un(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function Ka(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=ul(e):t===10?r=e.toFixed(10).substr(0,12):r=xl(e),Un(hl(r.toUpperCase()))}function ra(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):Ka(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return ct(14,Wi(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function ml(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function gl(e,t,r,a){var s="",n=0,i=0,c=r.y,l,f=0;switch(e){case 98:c=r.y+543;case 121:switch(t.length){case 1:case 2:l=c%100,f=2;break;default:l=c%1e4,f=4;break}break;case 109:switch(t.length){case 1:case 2:l=r.m,f=t.length;break;case 3:return an[r.m-1][1];case 5:return an[r.m-1][0];default:return an[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:l=r.d,f=t.length;break;case 3:return T0[r.q][0];default:return T0[r.q][1]}break;case 104:switch(t.length){case 1:case 2:l=1+(r.H+11)%12,f=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:l=r.H,f=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:l=r.M,f=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?xt(r.S,t.length):(a>=2?i=a===3?1e3:100:i=a===1?10:1,n=Math.round(i*(r.S+r.u)),n>=60*i&&(n=0),t==="s"?n===0?"0":""+n/i:(s=xt(n,2+a),t==="ss"?s.substr(0,2):"."+s.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":l=r.D*24+r.H;break;case"[m]":case"[mm]":l=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":l=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}f=t.length===3?1:2;break;case 101:l=c,f=1;break}var d=f>0?xt(l,f):"";return d}function Rt(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,a=e.substr(0,r);r!=e.length;r+=t)a+=(a.length>0?",":"")+e.substr(r,t);return a}var Hi=/%/g;function pl(e,t,r){var a=t.replace(Hi,""),s=t.length-a.length;return Nt(e,a,r*Math.pow(10,2*s))+ur("%",s)}function vl(e,t,r){for(var a=t.length-1;t.charCodeAt(a-1)===44;)--a;return Nt(e,t.substr(0,a),r/Math.pow(10,3*(t.length-a)))}function Vi(e,t){var r,a=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+Vi(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var n=Math.floor(Math.log(t)*Math.LOG10E)%s;if(n<0&&(n+=s),r=(t/Math.pow(10,n)).toPrecision(a+1+(s+n)%s),r.indexOf("e")===-1){var i=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+n):r+="E+"+(i-n);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,s)+"."+r.substr(2+s),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,l,f,d){return l+f+d.substr(0,(s+n)%s)+"."+d.substr(n)+"E"})}else r=t.toExponential(a);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var $i=/# (\?+)( ?)\/( ?)(\d+)/;function wl(e,t,r){var a=parseInt(e[4],10),s=Math.round(t*a),n=Math.floor(s/a),i=s-n*a,c=a;return r+(n===0?"":""+n)+" "+(i===0?ur(" ",e[1].length+1+e[4].length):Bn(i,e[1].length)+e[2]+"/"+e[3]+xt(c,e[4].length))}function kl(e,t,r){return r+(t===0?"":""+t)+ur(" ",e[1].length+2+e[4].length)}var zi=/^#*0*\.([0#]+)/,Gi=/\).*[0#]/,Xi=/\(###\) ###\\?-####/;function Wr(e){for(var t="",r,a=0;a!=e.length;++a)switch(r=e.charCodeAt(a)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function F0(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function C0(e,t){var r=e-Math.floor(e),a=Math.pow(10,t);return t<(""+Math.round(r*a)).length?0:Math.round(r*a)}function _l(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function yl(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function rt(e,t,r){if(e.charCodeAt(0)===40&&!t.match(Gi)){var a=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?rt("n",a,r):"("+rt("n",a,-r)+")"}if(t.charCodeAt(t.length-1)===44)return vl(e,t,r);if(t.indexOf("%")!==-1)return pl(e,t,r);if(t.indexOf("E")!==-1)return Vi(t,r);if(t.charCodeAt(0)===36)return"$"+rt(e,t.substr(t.charAt(1)==" "?2:1),r);var s,n,i,c,l=Math.abs(r),f=r<0?"-":"";if(t.match(/^00+$/))return f+xa(l,t.length);if(t.match(/^[#?]+$/))return s=xa(r,0),s==="0"&&(s=""),s.length>t.length?s:Wr(t.substr(0,t.length-s.length))+s;if(n=t.match($i))return wl(n,l,f);if(t.match(/^#+0+$/))return f+xa(l,t.length-t.indexOf("0"));if(n=t.match(zi))return s=F0(r,n[1].length).replace(/^([^\.]+)$/,"$1."+Wr(n[1])).replace(/\.$/,"."+Wr(n[1])).replace(/\.(\d*)$/,function(g,x){return"."+x+ur("0",Wr(n[1]).length-x.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),n=t.match(/^(0*)\.(#*)$/))return f+F0(l,n[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,n[1].length?"0.":".");if(n=t.match(/^#{1,3},##0(\.?)$/))return f+Rt(xa(l,0));if(n=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+rt(e,t,-r):Rt(""+(Math.floor(r)+_l(r,n[1].length)))+"."+xt(C0(r,n[1].length),n[1].length);if(n=t.match(/^#,#*,#0/))return rt(e,t.replace(/^#,#*,/,""),r);if(n=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=wa(rt(e,t.replace(/[\\-]/g,""),r)),i=0,wa(wa(t.replace(/\\/g,"")).replace(/[0#]/g,function(g){return i<s.length?s.charAt(i++):g==="0"?"0":""}));if(t.match(Xi))return s=rt(e,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var d="";if(n=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(n[4].length,7),c=Os(l,Math.pow(10,i)-1,!1),s=""+f,d=Nt("n",n[1],c[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),s+=d+n[2]+"/"+n[3],d=Ds(c[2],i),d.length<n[4].length&&(d=Wr(n[4].substr(n[4].length-d.length))+d),s+=d,s;if(n=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(n[1].length,n[4].length),7),c=Os(l,Math.pow(10,i)-1,!0),f+(c[0]||(c[1]?"":"0"))+" "+(c[1]?Bn(c[1],i)+n[2]+"/"+n[3]+Ds(c[2],i):ur(" ",2*i+1+n[2].length+n[3].length));if(n=t.match(/^[#0?]+$/))return s=xa(r,0),t.length<=s.length?s:Wr(t.substr(0,t.length-s.length))+s;if(n=t.match(/^([#0?]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(n[2].length,10)).replace(/([^0])0+$/,"$1"),i=s.indexOf(".");var u=t.indexOf(".")-i,h=t.length-s.length-u;return Wr(t.substr(0,u)+s+t.substr(t.length-h))}if(n=t.match(/^00,000\.([#0]*0)$/))return i=C0(r,n[1].length),r<0?"-"+rt(e,t,-r):Rt(yl(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?xt(0,3-g.length):"")+g})+"."+xt(i,n[1].length);switch(t){case"###,##0.00":return rt(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var m=Rt(xa(l,0));return m!=="0"?f+m:"";case"###,###.00":return rt(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return rt(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function bl(e,t,r){for(var a=t.length-1;t.charCodeAt(a-1)===44;)--a;return Nt(e,t.substr(0,a),r/Math.pow(10,3*(t.length-a)))}function El(e,t,r){var a=t.replace(Hi,""),s=t.length-a.length;return Nt(e,a,r*Math.pow(10,2*s))+ur("%",s)}function Ki(e,t){var r,a=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+Ki(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var n=Math.floor(Math.log(t)*Math.LOG10E)%s;if(n<0&&(n+=s),r=(t/Math.pow(10,n)).toPrecision(a+1+(s+n)%s),!r.match(/[Ee]/)){var i=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+n):r+="E+"+(i-n),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,l,f,d){return l+f+d.substr(0,(s+n)%s)+"."+d.substr(n)+"E"})}else r=t.toExponential(a);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function wt(e,t,r){if(e.charCodeAt(0)===40&&!t.match(Gi)){var a=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?wt("n",a,r):"("+wt("n",a,-r)+")"}if(t.charCodeAt(t.length-1)===44)return bl(e,t,r);if(t.indexOf("%")!==-1)return El(e,t,r);if(t.indexOf("E")!==-1)return Ki(t,r);if(t.charCodeAt(0)===36)return"$"+wt(e,t.substr(t.charAt(1)==" "?2:1),r);var s,n,i,c,l=Math.abs(r),f=r<0?"-":"";if(t.match(/^00+$/))return f+xt(l,t.length);if(t.match(/^[#?]+$/))return s=""+r,r===0&&(s=""),s.length>t.length?s:Wr(t.substr(0,t.length-s.length))+s;if(n=t.match($i))return kl(n,l,f);if(t.match(/^#+0+$/))return f+xt(l,t.length-t.indexOf("0"));if(n=t.match(zi))return s=(""+r).replace(/^([^\.]+)$/,"$1."+Wr(n[1])).replace(/\.$/,"."+Wr(n[1])),s=s.replace(/\.(\d*)$/,function(g,x){return"."+x+ur("0",Wr(n[1]).length-x.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),n=t.match(/^(0*)\.(#*)$/))return f+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,n[1].length?"0.":".");if(n=t.match(/^#{1,3},##0(\.?)$/))return f+Rt(""+l);if(n=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+wt(e,t,-r):Rt(""+r)+"."+ur("0",n[1].length);if(n=t.match(/^#,#*,#0/))return wt(e,t.replace(/^#,#*,/,""),r);if(n=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=wa(wt(e,t.replace(/[\\-]/g,""),r)),i=0,wa(wa(t.replace(/\\/g,"")).replace(/[0#]/g,function(g){return i<s.length?s.charAt(i++):g==="0"?"0":""}));if(t.match(Xi))return s=wt(e,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var d="";if(n=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(n[4].length,7),c=Os(l,Math.pow(10,i)-1,!1),s=""+f,d=Nt("n",n[1],c[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),s+=d+n[2]+"/"+n[3],d=Ds(c[2],i),d.length<n[4].length&&(d=Wr(n[4].substr(n[4].length-d.length))+d),s+=d,s;if(n=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(n[1].length,n[4].length),7),c=Os(l,Math.pow(10,i)-1,!0),f+(c[0]||(c[1]?"":"0"))+" "+(c[1]?Bn(c[1],i)+n[2]+"/"+n[3]+Ds(c[2],i):ur(" ",2*i+1+n[2].length+n[3].length));if(n=t.match(/^[#0?]+$/))return s=""+r,t.length<=s.length?s:Wr(t.substr(0,t.length-s.length))+s;if(n=t.match(/^([#0]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(n[2].length,10)).replace(/([^0])0+$/,"$1"),i=s.indexOf(".");var u=t.indexOf(".")-i,h=t.length-s.length-u;return Wr(t.substr(0,u)+s+t.substr(t.length-h))}if(n=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+wt(e,t,-r):Rt(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?xt(0,3-g.length):"")+g})+"."+xt(0,n[1].length);switch(t){case"###,###":case"##,###":case"#,###":var m=Rt(""+l);return m!=="0"?f+m:"";default:if(t.match(/\.[0#?]*$/))return wt(e,t.slice(0,t.lastIndexOf(".")),r)+Wr(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function Nt(e,t,r){return(r|0)===r?wt(e,t,r):rt(e,t,r)}function Sl(e){for(var t=[],r=!1,a=0,s=0;a<e.length;++a)switch(e.charCodeAt(a)){case 34:r=!r;break;case 95:case 42:case 92:++a;break;case 59:t[t.length]=e.substr(s,a-s),s=a+1}if(t[t.length]=e.substr(s),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var Yi=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Na(e){for(var t=0,r="",a="";t<e.length;)switch(r=e.charAt(t)){case"G":Is(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"上":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="上午/下午")return!0;++t;break;case"[":for(a=r;e.charAt(t++)!=="]"&&t<e.length;)a+=e.charAt(t);if(a.match(Yi))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function Tl(e,t,r,a){for(var s=[],n="",i=0,c="",l="t",f,d,u,h="H";i<e.length;)switch(c=e.charAt(i)){case"G":if(!Is(e,i))throw new Error("unrecognized character "+c+" in "+e);s[s.length]={t:"G",v:"General"},i+=7;break;case'"':for(n="";(u=e.charCodeAt(++i))!==34&&i<e.length;)n+=String.fromCharCode(u);s[s.length]={t:"t",v:n},++i;break;case"\\":var m=e.charAt(++i),g=m==="("||m===")"?m:"t";s[s.length]={t:g,v:m},++i;break;case"_":s[s.length]={t:"t",v:" "},i+=2;break;case"@":s[s.length]={t:"T",v:t},++i;break;case"B":case"b":if(e.charAt(i+1)==="1"||e.charAt(i+1)==="2"){if(f==null&&(f=Jt(t,r,e.charAt(i+1)==="2"),f==null))return"";s[s.length]={t:"X",v:e.substr(i,2)},l=c,i+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":c=c.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||f==null&&(f=Jt(t,r),f==null))return"";for(n=c;++i<e.length&&e.charAt(i).toLowerCase()===c;)n+=c;c==="m"&&l.toLowerCase()==="h"&&(c="M"),c==="h"&&(c=h),s[s.length]={t:c,v:n},l=c;break;case"A":case"a":case"上":var x={t:c,v:c};if(f==null&&(f=Jt(t,r)),e.substr(i,3).toUpperCase()==="A/P"?(f!=null&&(x.v=f.H>=12?"P":"A"),x.t="T",h="h",i+=3):e.substr(i,5).toUpperCase()==="AM/PM"?(f!=null&&(x.v=f.H>=12?"PM":"AM"),x.t="T",i+=5,h="h"):e.substr(i,5).toUpperCase()==="上午/下午"?(f!=null&&(x.v=f.H>=12?"下午":"上午"),x.t="T",i+=5,h="h"):(x.t="t",++i),f==null&&x.t==="T")return"";s[s.length]=x,l=c;break;case"[":for(n=c;e.charAt(i++)!=="]"&&i<e.length;)n+=e.charAt(i);if(n.slice(-1)!=="]")throw'unterminated "[" block: |'+n+"|";if(n.match(Yi)){if(f==null&&(f=Jt(t,r),f==null))return"";s[s.length]={t:"Z",v:n.toLowerCase()},l=n.charAt(1)}else n.indexOf("$")>-1&&(n=(n.match(/\$([^-\[\]]*)/)||[])[1]||"$",Na(e)||(s[s.length]={t:"t",v:n}));break;case".":if(f!=null){for(n=c;++i<e.length&&(c=e.charAt(i))==="0";)n+=c;s[s.length]={t:"s",v:n};break}case"0":case"#":for(n=c;++i<e.length&&"0#?.,E+-%".indexOf(c=e.charAt(i))>-1;)n+=c;s[s.length]={t:"n",v:n};break;case"?":for(n=c;e.charAt(++i)===c;)n+=c;s[s.length]={t:c,v:n},l=c;break;case"*":++i,(e.charAt(i)==" "||e.charAt(i)=="*")&&++i;break;case"(":case")":s[s.length]={t:a===1?"t":c,v:c},++i;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(n=c;i<e.length&&"0123456789".indexOf(e.charAt(++i))>-1;)n+=e.charAt(i);s[s.length]={t:"D",v:n};break;case" ":s[s.length]={t:c,v:c},++i;break;case"$":s[s.length]={t:"t",v:"$"},++i;break;default:if(",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(c)===-1)throw new Error("unrecognized character "+c+" in "+e);s[s.length]={t:"t",v:c},++i;break}var p=0,k=0,b;for(i=s.length-1,l="t";i>=0;--i)switch(s[i].t){case"h":case"H":s[i].t=h,l="h",p<1&&(p=1);break;case"s":(b=s[i].v.match(/\.0+$/))&&(k=Math.max(k,b[0].length-1)),p<3&&(p=3);case"d":case"y":case"M":case"e":l=s[i].t;break;case"m":l==="s"&&(s[i].t="M",p<2&&(p=2));break;case"X":break;case"Z":p<1&&s[i].v.match(/[Hh]/)&&(p=1),p<2&&s[i].v.match(/[Mm]/)&&(p=2),p<3&&s[i].v.match(/[Ss]/)&&(p=3)}switch(p){case 0:break;case 1:f.u>=.5&&(f.u=0,++f.S),f.S>=60&&(f.S=0,++f.M),f.M>=60&&(f.M=0,++f.H);break;case 2:f.u>=.5&&(f.u=0,++f.S),f.S>=60&&(f.S=0,++f.M);break}var w="",j;for(i=0;i<s.length;++i)switch(s[i].t){case"t":case"T":case" ":case"D":break;case"X":s[i].v="",s[i].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[i].v=gl(s[i].t.charCodeAt(0),s[i].v,f,k),s[i].t="t";break;case"n":case"?":for(j=i+1;s[j]!=null&&((c=s[j].t)==="?"||c==="D"||(c===" "||c==="t")&&s[j+1]!=null&&(s[j+1].t==="?"||s[j+1].t==="t"&&s[j+1].v==="/")||s[i].t==="("&&(c===" "||c==="n"||c===")")||c==="t"&&(s[j].v==="/"||s[j].v===" "&&s[j+1]!=null&&s[j+1].t=="?"));)s[i].v+=s[j].v,s[j]={v:"",t:";"},++j;w+=s[i].v,i=j-1;break;case"G":s[i].t="t",s[i].v=ra(t,r);break}var R="",I,E;if(w.length>0){w.charCodeAt(0)==40?(I=t<0&&w.charCodeAt(0)===45?-t:t,E=Nt("n",w,I)):(I=t<0&&a>1?-t:t,E=Nt("n",w,I),I<0&&s[0]&&s[0].t=="t"&&(E=E.substr(1),s[0].v="-"+s[0].v)),j=E.length-1;var U=s.length;for(i=0;i<s.length;++i)if(s[i]!=null&&s[i].t!="t"&&s[i].v.indexOf(".")>-1){U=i;break}var N=s.length;if(U===s.length&&E.indexOf("E")===-1){for(i=s.length-1;i>=0;--i)s[i]==null||"n?".indexOf(s[i].t)===-1||(j>=s[i].v.length-1?(j-=s[i].v.length,s[i].v=E.substr(j+1,s[i].v.length)):j<0?s[i].v="":(s[i].v=E.substr(0,j+1),j=-1),s[i].t="t",N=i);j>=0&&N<s.length&&(s[N].v=E.substr(0,j+1)+s[N].v)}else if(U!==s.length&&E.indexOf("E")===-1){for(j=E.indexOf(".")-1,i=U;i>=0;--i)if(!(s[i]==null||"n?".indexOf(s[i].t)===-1)){for(d=s[i].v.indexOf(".")>-1&&i===U?s[i].v.indexOf(".")-1:s[i].v.length-1,R=s[i].v.substr(d+1);d>=0;--d)j>=0&&(s[i].v.charAt(d)==="0"||s[i].v.charAt(d)==="#")&&(R=E.charAt(j--)+R);s[i].v=R,s[i].t="t",N=i}for(j>=0&&N<s.length&&(s[N].v=E.substr(0,j+1)+s[N].v),j=E.indexOf(".")+1,i=U;i<s.length;++i)if(!(s[i]==null||"n?(".indexOf(s[i].t)===-1&&i!==U)){for(d=s[i].v.indexOf(".")>-1&&i===U?s[i].v.indexOf(".")+1:0,R=s[i].v.substr(0,d);d<s[i].v.length;++d)j<E.length&&(R+=E.charAt(j++));s[i].v=R,s[i].t="t",N=i}}}for(i=0;i<s.length;++i)s[i]!=null&&"n?".indexOf(s[i].t)>-1&&(I=a>1&&t<0&&i>0&&s[i-1].v==="-"?-t:t,s[i].v=Nt(s[i].t,s[i].v,I),s[i].t="t");var B="";for(i=0;i!==s.length;++i)s[i]!=null&&(B+=s[i].v);return B}var A0=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function j0(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function Nl(e,t){var r=Sl(e),a=r.length,s=r[a-1].indexOf("@");if(a<4&&s>-1&&--a,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||s>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=s>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=s>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=s>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var n=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[a,n];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var i=r[0].match(A0),c=r[1].match(A0);return j0(t,i)?[a,r[0]]:j0(t,c)?[a,r[1]]:[a,r[i!=null&&c!=null?2:1]]}return[a,n]}function ct(e,t,r){r==null&&(r={});var a="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?a=r.dateNF:a=e;break;case"number":e==14&&r.dateNF?a=r.dateNF:a=(r.table!=null?r.table:Ie)[e],a==null&&(a=r.table&&r.table[N0[e]]||Ie[N0[e]]),a==null&&(a=ll[e]||"General");break}if(Is(a,0))return ra(t,r);t instanceof Date&&(t=Wi(t,r.date1904));var s=Nl(a,t);if(Is(s[1]))return ra(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return Tl(s[1],t,r,s[0])}function Ft(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(Ie[r]==null){t<0&&(t=r);continue}if(Ie[r]==e){t=r;break}}t<0&&(t=391)}return Ie[t]=e,t}function zs(e){for(var t=0;t!=392;++t)e[t]!==void 0&&Ft(e[t],t)}function Fa(){Ie=ol()}var Fl={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},Ji=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function Cl(e){var t=typeof e=="number"?Ie[e]:e;return t=t.replace(Ji,"(\\d+)"),new RegExp("^"+t+"$")}function Al(e,t,r){var a=-1,s=-1,n=-1,i=-1,c=-1,l=-1;(t.match(Ji)||[]).forEach(function(u,h){var m=parseInt(r[h+1],10);switch(u.toLowerCase().charAt(0)){case"y":a=m;break;case"d":n=m;break;case"h":i=m;break;case"s":l=m;break;case"m":i>=0?c=m:s=m;break}}),l>=0&&c==-1&&s>=0&&(c=s,s=-1);var f=(""+(a>=0?a:new Date().getFullYear())).slice(-4)+"-"+("00"+(s>=1?s:1)).slice(-2)+"-"+("00"+(n>=1?n:1)).slice(-2);f.length==7&&(f="0"+f),f.length==8&&(f="20"+f);var d=("00"+(i>=0?i:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return i==-1&&c==-1&&l==-1?f:a==-1&&s==-1&&n==-1?d:f+"T"+d}var jl=function(){var e={};e.version="1.2.0";function t(){for(var E=0,U=new Array(256),N=0;N!=256;++N)E=N,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,U[N]=E;return typeof Int32Array<"u"?new Int32Array(U):U}var r=t();function a(E){var U=0,N=0,B=0,L=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(B=0;B!=256;++B)L[B]=E[B];for(B=0;B!=256;++B)for(N=E[B],U=256+B;U<4096;U+=256)N=L[U]=N>>>8^E[N&255];var P=[];for(B=1;B!=16;++B)P[B-1]=typeof Int32Array<"u"?L.subarray(B*256,B*256+256):L.slice(B*256,B*256+256);return P}var s=a(r),n=s[0],i=s[1],c=s[2],l=s[3],f=s[4],d=s[5],u=s[6],h=s[7],m=s[8],g=s[9],x=s[10],p=s[11],k=s[12],b=s[13],w=s[14];function j(E,U){for(var N=U^-1,B=0,L=E.length;B<L;)N=N>>>8^r[(N^E.charCodeAt(B++))&255];return~N}function R(E,U){for(var N=U^-1,B=E.length-15,L=0;L<B;)N=w[E[L++]^N&255]^b[E[L++]^N>>8&255]^k[E[L++]^N>>16&255]^p[E[L++]^N>>>24]^x[E[L++]]^g[E[L++]]^m[E[L++]]^h[E[L++]]^u[E[L++]]^d[E[L++]]^f[E[L++]]^l[E[L++]]^c[E[L++]]^i[E[L++]]^n[E[L++]]^r[E[L++]];for(B+=15;L<B;)N=N>>>8^r[(N^E[L++])&255];return~N}function I(E,U){for(var N=U^-1,B=0,L=E.length,P=0,Q=0;B<L;)P=E.charCodeAt(B++),P<128?N=N>>>8^r[(N^P)&255]:P<2048?(N=N>>>8^r[(N^(192|P>>6&31))&255],N=N>>>8^r[(N^(128|P&63))&255]):P>=55296&&P<57344?(P=(P&1023)+64,Q=E.charCodeAt(B++)&1023,N=N>>>8^r[(N^(240|P>>8&7))&255],N=N>>>8^r[(N^(128|P>>2&63))&255],N=N>>>8^r[(N^(128|Q>>6&15|(P&3)<<4))&255],N=N>>>8^r[(N^(128|Q&63))&255]):(N=N>>>8^r[(N^(224|P>>12&15))&255],N=N>>>8^r[(N^(128|P>>6&63))&255],N=N>>>8^r[(N^(128|P&63))&255]);return~N}return e.table=r,e.bstr=j,e.buf=R,e.str=I,e}(),Ae=function(){var t={};t.version="1.2.1";function r(v,T){for(var _=v.split("/"),y=T.split("/"),F=0,C=0,z=Math.min(_.length,y.length);F<z;++F){if(C=_[F].length-y[F].length)return C;if(_[F]!=y[F])return _[F]<y[F]?-1:1}return _.length-y.length}function a(v){if(v.charAt(v.length-1)=="/")return v.slice(0,-1).indexOf("/")===-1?v:a(v.slice(0,-1));var T=v.lastIndexOf("/");return T===-1?v:v.slice(0,T+1)}function s(v){if(v.charAt(v.length-1)=="/")return s(v.slice(0,-1));var T=v.lastIndexOf("/");return T===-1?v:v.slice(T+1)}function n(v,T){typeof T=="string"&&(T=new Date(T));var _=T.getHours();_=_<<6|T.getMinutes(),_=_<<5|T.getSeconds()>>>1,v.write_shift(2,_);var y=T.getFullYear()-1980;y=y<<4|T.getMonth()+1,y=y<<5|T.getDate(),v.write_shift(2,y)}function i(v){var T=v.read_shift(2)&65535,_=v.read_shift(2)&65535,y=new Date,F=_&31;_>>>=5;var C=_&15;_>>>=4,y.setMilliseconds(0),y.setFullYear(_+1980),y.setMonth(C-1),y.setDate(F);var z=T&31;T>>>=5;var te=T&63;return T>>>=6,y.setHours(T),y.setMinutes(te),y.setSeconds(z<<1),y}function c(v){Cr(v,0);for(var T={},_=0;v.l<=v.length-4;){var y=v.read_shift(2),F=v.read_shift(2),C=v.l+F,z={};switch(y){case 21589:_=v.read_shift(1),_&1&&(z.mtime=v.read_shift(4)),F>5&&(_&2&&(z.atime=v.read_shift(4)),_&4&&(z.ctime=v.read_shift(4))),z.mtime&&(z.mt=new Date(z.mtime*1e3));break}v.l=C,T[y]=z}return T}var l;function f(){return l||(l={})}function d(v,T){if(v[0]==80&&v[1]==75)return Er(v,T);if((v[0]|32)==109&&(v[1]|32)==105)return Je(v,T);if(v.length<512)throw new Error("CFB file size "+v.length+" < 512");var _=3,y=512,F=0,C=0,z=0,te=0,V=0,X=[],K=v.slice(0,512);Cr(K,0);var le=u(K);switch(_=le[0],_){case 3:y=512;break;case 4:y=4096;break;case 0:if(le[1]==0)return Er(v,T);default:throw new Error("Major Version: Expected 3 or 4 saw "+_)}y!==512&&(K=v.slice(0,y),Cr(K,28));var ve=v.slice(0,y);h(K,_);var Se=K.read_shift(4,"i");if(_===3&&Se!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Se);K.l+=4,z=K.read_shift(4,"i"),K.l+=4,K.chk("00100000","Mini Stream Cutoff Size: "),te=K.read_shift(4,"i"),F=K.read_shift(4,"i"),V=K.read_shift(4,"i"),C=K.read_shift(4,"i");for(var de=-1,_e=0;_e<109&&(de=K.read_shift(4,"i"),!(de<0));++_e)X[_e]=de;var Ue=m(v,y);p(V,C,Ue,y,X);var or=b(Ue,z,X,y);or[z].name="!Directory",F>0&&te!==Q&&(or[te].name="!MiniFAT"),or[X[0]].name="!FAT",or.fat_addrs=X,or.ssz=y;var lr={},jr=[],ja=[],Da=[];w(z,or,Ue,jr,F,lr,ja,te),g(ja,Da,jr),jr.shift();var Ia={FileIndex:ja,FullPaths:Da};return T&&T.raw&&(Ia.raw={header:ve,sectors:Ue}),Ia}function u(v){if(v[v.l]==80&&v[v.l+1]==75)return[0,0];v.chk(fe,"Header Signature: "),v.l+=16;var T=v.read_shift(2,"u");return[v.read_shift(2,"u"),T]}function h(v,T){var _=9;switch(v.l+=2,_=v.read_shift(2)){case 9:if(T!=3)throw new Error("Sector Shift: Expected 9 saw "+_);break;case 12:if(T!=4)throw new Error("Sector Shift: Expected 12 saw "+_);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+_)}v.chk("0600","Mini Sector Shift: "),v.chk("000000000000","Reserved: ")}function m(v,T){for(var _=Math.ceil(v.length/T)-1,y=[],F=1;F<_;++F)y[F-1]=v.slice(F*T,(F+1)*T);return y[_-1]=v.slice(_*T),y}function g(v,T,_){for(var y=0,F=0,C=0,z=0,te=0,V=_.length,X=[],K=[];y<V;++y)X[y]=K[y]=y,T[y]=_[y];for(;te<K.length;++te)y=K[te],F=v[y].L,C=v[y].R,z=v[y].C,X[y]===y&&(F!==-1&&X[F]!==F&&(X[y]=X[F]),C!==-1&&X[C]!==C&&(X[y]=X[C])),z!==-1&&(X[z]=y),F!==-1&&y!=X[y]&&(X[F]=X[y],K.lastIndexOf(F)<te&&K.push(F)),C!==-1&&y!=X[y]&&(X[C]=X[y],K.lastIndexOf(C)<te&&K.push(C));for(y=1;y<V;++y)X[y]===y&&(C!==-1&&X[C]!==C?X[y]=X[C]:F!==-1&&X[F]!==F&&(X[y]=X[F]));for(y=1;y<V;++y)if(v[y].type!==0){if(te=y,te!=X[te])do te=X[te],T[y]=T[te]+"/"+T[y];while(te!==0&&X[te]!==-1&&te!=X[te]);X[y]=-1}for(T[0]+="/",y=1;y<V;++y)v[y].type!==2&&(T[y]+="/")}function x(v,T,_){for(var y=v.start,F=v.size,C=[],z=y;_&&F>0&&z>=0;)C.push(T.slice(z*P,z*P+P)),F-=P,z=Yt(_,z*4);return C.length===0?Y(0):Tr(C).slice(0,v.size)}function p(v,T,_,y,F){var C=Q;if(v===Q){if(T!==0)throw new Error("DIFAT chain shorter than expected")}else if(v!==-1){var z=_[v],te=(y>>>2)-1;if(!z)return;for(var V=0;V<te&&(C=Yt(z,V*4))!==Q;++V)F.push(C);p(Yt(z,y-4),T-1,_,y,F)}}function k(v,T,_,y,F){var C=[],z=[];F||(F=[]);var te=y-1,V=0,X=0;for(V=T;V>=0;){F[V]=!0,C[C.length]=V,z.push(v[V]);var K=_[Math.floor(V*4/y)];if(X=V*4&te,y<4+X)throw new Error("FAT boundary crossed: "+V+" 4 "+y);if(!v[K])break;V=Yt(v[K],X)}return{nodes:C,data:V0([z])}}function b(v,T,_,y){var F=v.length,C=[],z=[],te=[],V=[],X=y-1,K=0,le=0,ve=0,Se=0;for(K=0;K<F;++K)if(te=[],ve=K+T,ve>=F&&(ve-=F),!z[ve]){V=[];var de=[];for(le=ve;le>=0;){de[le]=!0,z[le]=!0,te[te.length]=le,V.push(v[le]);var _e=_[Math.floor(le*4/y)];if(Se=le*4&X,y<4+Se)throw new Error("FAT boundary crossed: "+le+" 4 "+y);if(!v[_e]||(le=Yt(v[_e],Se),de[le]))break}C[ve]={nodes:te,data:V0([V])}}return C}function w(v,T,_,y,F,C,z,te){for(var V=0,X=y.length?2:0,K=T[v].data,le=0,ve=0,Se;le<K.length;le+=128){var de=K.slice(le,le+128);Cr(de,64),ve=de.read_shift(2),Se=Xn(de,0,ve-X),y.push(Se);var _e={name:Se,type:de.read_shift(1),color:de.read_shift(1),L:de.read_shift(4,"i"),R:de.read_shift(4,"i"),C:de.read_shift(4,"i"),clsid:de.read_shift(16),state:de.read_shift(4,"i"),start:0,size:0},Ue=de.read_shift(2)+de.read_shift(2)+de.read_shift(2)+de.read_shift(2);Ue!==0&&(_e.ct=j(de,de.l-8));var or=de.read_shift(2)+de.read_shift(2)+de.read_shift(2)+de.read_shift(2);or!==0&&(_e.mt=j(de,de.l-8)),_e.start=de.read_shift(4,"i"),_e.size=de.read_shift(4,"i"),_e.size<0&&_e.start<0&&(_e.size=_e.type=0,_e.start=Q,_e.name=""),_e.type===5?(V=_e.start,F>0&&V!==Q&&(T[V].name="!StreamData")):_e.size>=4096?(_e.storage="fat",T[_e.start]===void 0&&(T[_e.start]=k(_,_e.start,T.fat_addrs,T.ssz)),T[_e.start].name=_e.name,_e.content=T[_e.start].data.slice(0,_e.size)):(_e.storage="minifat",_e.size<0?_e.size=0:V!==Q&&_e.start!==Q&&T[V]&&(_e.content=x(_e,T[V].data,(T[te]||{}).data))),_e.content&&Cr(_e.content,0),C[Se]=_e,z.push(_e)}}function j(v,T){return new Date((Jr(v,T+4)/1e7*Math.pow(2,32)+Jr(v,T)/1e7-11644473600)*1e3)}function R(v,T){return f(),d(l.readFileSync(v),T)}function I(v,T){var _=T&&T.type;switch(_||$e&&Buffer.isBuffer(v)&&(_="buffer"),_||"base64"){case"file":return R(v,T);case"base64":return d(qr(Qr(v)),T);case"binary":return d(qr(v),T)}return d(v,T)}function E(v,T){var _=T||{},y=_.root||"Root Entry";if(v.FullPaths||(v.FullPaths=[]),v.FileIndex||(v.FileIndex=[]),v.FullPaths.length!==v.FileIndex.length)throw new Error("inconsistent CFB structure");v.FullPaths.length===0&&(v.FullPaths[0]=y+"/",v.FileIndex[0]={name:y,type:5}),_.CLSID&&(v.FileIndex[0].clsid=_.CLSID),U(v)}function U(v){var T="Sh33tJ5";if(!Ae.find(v,"/"+T)){var _=Y(4);_[0]=55,_[1]=_[3]=50,_[2]=54,v.FileIndex.push({name:T,type:2,content:_,size:4,L:69,R:69,C:69}),v.FullPaths.push(v.FullPaths[0]+T),N(v)}}function N(v,T){E(v);for(var _=!1,y=!1,F=v.FullPaths.length-1;F>=0;--F){var C=v.FileIndex[F];switch(C.type){case 0:y?_=!0:(v.FileIndex.pop(),v.FullPaths.pop());break;case 1:case 2:case 5:y=!0,isNaN(C.R*C.L*C.C)&&(_=!0),C.R>-1&&C.L>-1&&C.R==C.L&&(_=!0);break;default:_=!0;break}}if(!(!_&&!T)){var z=new Date(1987,1,19),te=0,V=Object.create?Object.create(null):{},X=[];for(F=0;F<v.FullPaths.length;++F)V[v.FullPaths[F]]=!0,v.FileIndex[F].type!==0&&X.push([v.FullPaths[F],v.FileIndex[F]]);for(F=0;F<X.length;++F){var K=a(X[F][0]);y=V[K],y||(X.push([K,{name:s(K).replace("/",""),type:1,clsid:pe,ct:z,mt:z,content:null}]),V[K]=!0)}for(X.sort(function(Se,de){return r(Se[0],de[0])}),v.FullPaths=[],v.FileIndex=[],F=0;F<X.length;++F)v.FullPaths[F]=X[F][0],v.FileIndex[F]=X[F][1];for(F=0;F<X.length;++F){var le=v.FileIndex[F],ve=v.FullPaths[F];if(le.name=s(ve).replace("/",""),le.L=le.R=le.C=-(le.color=1),le.size=le.content?le.content.length:0,le.start=0,le.clsid=le.clsid||pe,F===0)le.C=X.length>1?1:-1,le.size=0,le.type=5;else if(ve.slice(-1)=="/"){for(te=F+1;te<X.length&&a(v.FullPaths[te])!=ve;++te);for(le.C=te>=X.length?-1:te,te=F+1;te<X.length&&a(v.FullPaths[te])!=a(ve);++te);le.R=te>=X.length?-1:te,le.type=1}else a(v.FullPaths[F+1]||"")==a(ve)&&(le.R=F+1),le.type=2}}}function B(v,T){var _=T||{};if(_.fileType=="mad")return ua(v,_);switch(N(v),_.fileType){case"zip":return dt(v,_)}var y=function(Se){for(var de=0,_e=0,Ue=0;Ue<Se.FileIndex.length;++Ue){var or=Se.FileIndex[Ue];if(or.content){var lr=or.content.length;lr>0&&(lr<4096?de+=lr+63>>6:_e+=lr+511>>9)}}for(var jr=Se.FullPaths.length+3>>2,ja=de+7>>3,Da=de+127>>7,Ia=ja+_e+jr+Da,Kt=Ia+127>>7,tn=Kt<=109?0:Math.ceil((Kt-109)/127);Ia+Kt+tn+127>>7>Kt;)tn=++Kt<=109?0:Math.ceil((Kt-109)/127);var St=[1,tn,Kt,Da,jr,_e,de,0];return Se.FileIndex[0].size=de<<6,St[7]=(Se.FileIndex[0].start=St[0]+St[1]+St[2]+St[3]+St[4]+St[5])+(St[6]+7>>3),St}(v),F=Y(y[7]<<9),C=0,z=0;{for(C=0;C<8;++C)F.write_shift(1,ie[C]);for(C=0;C<8;++C)F.write_shift(2,0);for(F.write_shift(2,62),F.write_shift(2,3),F.write_shift(2,65534),F.write_shift(2,9),F.write_shift(2,6),C=0;C<3;++C)F.write_shift(2,0);for(F.write_shift(4,0),F.write_shift(4,y[2]),F.write_shift(4,y[0]+y[1]+y[2]+y[3]-1),F.write_shift(4,0),F.write_shift(4,4096),F.write_shift(4,y[3]?y[0]+y[1]+y[2]-1:Q),F.write_shift(4,y[3]),F.write_shift(-4,y[1]?y[0]-1:Q),F.write_shift(4,y[1]),C=0;C<109;++C)F.write_shift(-4,C<y[2]?y[1]+C:-1)}if(y[1])for(z=0;z<y[1];++z){for(;C<236+z*127;++C)F.write_shift(-4,C<y[2]?y[1]+C:-1);F.write_shift(-4,z===y[1]-1?Q:z+1)}var te=function(Se){for(z+=Se;C<z-1;++C)F.write_shift(-4,C+1);Se&&(++C,F.write_shift(-4,Q))};for(z=C=0,z+=y[1];C<z;++C)F.write_shift(-4,he.DIFSECT);for(z+=y[2];C<z;++C)F.write_shift(-4,he.FATSECT);te(y[3]),te(y[4]);for(var V=0,X=0,K=v.FileIndex[0];V<v.FileIndex.length;++V)K=v.FileIndex[V],K.content&&(X=K.content.length,!(X<4096)&&(K.start=z,te(X+511>>9)));for(te(y[6]+7>>3);F.l&511;)F.write_shift(-4,he.ENDOFCHAIN);for(z=C=0,V=0;V<v.FileIndex.length;++V)K=v.FileIndex[V],K.content&&(X=K.content.length,!(!X||X>=4096)&&(K.start=z,te(X+63>>6)));for(;F.l&511;)F.write_shift(-4,he.ENDOFCHAIN);for(C=0;C<y[4]<<2;++C){var le=v.FullPaths[C];if(!le||le.length===0){for(V=0;V<17;++V)F.write_shift(4,0);for(V=0;V<3;++V)F.write_shift(4,-1);for(V=0;V<12;++V)F.write_shift(4,0);continue}K=v.FileIndex[C],C===0&&(K.start=K.size?K.start-1:Q);var ve=C===0&&_.root||K.name;if(X=2*(ve.length+1),F.write_shift(64,ve,"utf16le"),F.write_shift(2,X),F.write_shift(1,K.type),F.write_shift(1,K.color),F.write_shift(-4,K.L),F.write_shift(-4,K.R),F.write_shift(-4,K.C),K.clsid)F.write_shift(16,K.clsid,"hex");else for(V=0;V<4;++V)F.write_shift(4,0);F.write_shift(4,K.state||0),F.write_shift(4,0),F.write_shift(4,0),F.write_shift(4,0),F.write_shift(4,0),F.write_shift(4,K.start),F.write_shift(4,K.size),F.write_shift(4,0)}for(C=1;C<v.FileIndex.length;++C)if(K=v.FileIndex[C],K.size>=4096)if(F.l=K.start+1<<9,$e&&Buffer.isBuffer(K.content))K.content.copy(F,F.l,0,K.size),F.l+=K.size+511&-512;else{for(V=0;V<K.size;++V)F.write_shift(1,K.content[V]);for(;V&511;++V)F.write_shift(1,0)}for(C=1;C<v.FileIndex.length;++C)if(K=v.FileIndex[C],K.size>0&&K.size<4096)if($e&&Buffer.isBuffer(K.content))K.content.copy(F,F.l,0,K.size),F.l+=K.size+63&-64;else{for(V=0;V<K.size;++V)F.write_shift(1,K.content[V]);for(;V&63;++V)F.write_shift(1,0)}if($e)F.l=F.length;else for(;F.l<F.length;)F.write_shift(1,0);return F}function L(v,T){var _=v.FullPaths.map(function(V){return V.toUpperCase()}),y=_.map(function(V){var X=V.split("/");return X[X.length-(V.slice(-1)=="/"?2:1)]}),F=!1;T.charCodeAt(0)===47?(F=!0,T=_[0].slice(0,-1)+T):F=T.indexOf("/")!==-1;var C=T.toUpperCase(),z=F===!0?_.indexOf(C):y.indexOf(C);if(z!==-1)return v.FileIndex[z];var te=!C.match(Ra);for(C=C.replace(Vr,""),te&&(C=C.replace(Ra,"!")),z=0;z<_.length;++z)if((te?_[z].replace(Ra,"!"):_[z]).replace(Vr,"")==C||(te?y[z].replace(Ra,"!"):y[z]).replace(Vr,"")==C)return v.FileIndex[z];return null}var P=64,Q=-2,fe="d0cf11e0a1b11ae1",ie=[208,207,17,224,161,177,26,225],pe="00000000000000000000000000000000",he={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:Q,FREESECT:-1,HEADER_SIGNATURE:fe,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:pe,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function Ve(v,T,_){f();var y=B(v,_);l.writeFileSync(T,y)}function H(v){for(var T=new Array(v.length),_=0;_<v.length;++_)T[_]=String.fromCharCode(v[_]);return T.join("")}function we(v,T){var _=B(v,T);switch(T&&T.type||"buffer"){case"file":return f(),l.writeFileSync(T.filename,_),_;case"binary":return typeof _=="string"?_:H(_);case"base64":return Xa(typeof _=="string"?_:H(_));case"buffer":if($e)return Buffer.isBuffer(_)?_:jt(_);case"array":return typeof _=="string"?qr(_):_}return _}var Ee;function A(v){try{var T=v.InflateRaw,_=new T;if(_._processChunk(new Uint8Array([3,0]),_._finishFlushFlag),_.bytesRead)Ee=v;else throw new Error("zlib does not expose bytesRead")}catch(y){console.error("cannot use native zlib: "+(y.message||y))}}function M(v,T){if(!Ee)return lt(v,T);var _=Ee.InflateRaw,y=new _,F=y._processChunk(v.slice(v.l),y._finishFlushFlag);return v.l+=y.bytesRead,F}function D(v){return Ee?Ee.deflateRawSync(v):ye(v)}var O=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],W=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],ee=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function se(v){var T=(v<<1|v<<11)&139536|(v<<5|v<<15)&558144;return(T>>16|T>>8|T)&255}for(var J=typeof Uint8Array<"u",q=J?new Uint8Array(256):[],ke=0;ke<256;++ke)q[ke]=se(ke);function S(v,T){var _=q[v&255];return T<=8?_>>>8-T:(_=_<<8|q[v>>8&255],T<=16?_>>>16-T:(_=_<<8|q[v>>16&255],_>>>24-T))}function je(v,T){var _=T&7,y=T>>>3;return(v[y]|(_<=6?0:v[y+1]<<8))>>>_&3}function Ce(v,T){var _=T&7,y=T>>>3;return(v[y]|(_<=5?0:v[y+1]<<8))>>>_&7}function Be(v,T){var _=T&7,y=T>>>3;return(v[y]|(_<=4?0:v[y+1]<<8))>>>_&15}function Fe(v,T){var _=T&7,y=T>>>3;return(v[y]|(_<=3?0:v[y+1]<<8))>>>_&31}function ce(v,T){var _=T&7,y=T>>>3;return(v[y]|(_<=1?0:v[y+1]<<8))>>>_&127}function Ye(v,T,_){var y=T&7,F=T>>>3,C=(1<<_)-1,z=v[F]>>>y;return _<8-y||(z|=v[F+1]<<8-y,_<16-y)||(z|=v[F+2]<<16-y,_<24-y)||(z|=v[F+3]<<24-y),z&C}function hr(v,T,_){var y=T&7,F=T>>>3;return y<=5?v[F]|=(_&7)<<y:(v[F]|=_<<y&255,v[F+1]=(_&7)>>8-y),T+3}function Re(v,T,_){var y=T&7,F=T>>>3;return _=(_&1)<<y,v[F]|=_,T+1}function Ur(v,T,_){var y=T&7,F=T>>>3;return _<<=y,v[F]|=_&255,_>>>=8,v[F+1]=_,T+8}function Kr(v,T,_){var y=T&7,F=T>>>3;return _<<=y,v[F]|=_&255,_>>>=8,v[F+1]=_&255,v[F+2]=_>>>8,T+16}function $r(v,T){var _=v.length,y=2*_>T?2*_:T+5,F=0;if(_>=T)return v;if($e){var C=E0(y);if(v.copy)v.copy(C);else for(;F<v.length;++F)C[F]=v[F];return C}else if(J){var z=new Uint8Array(y);if(z.set)z.set(v);else for(;F<_;++F)z[F]=v[F];return z}return v.length=y,v}function cr(v){for(var T=new Array(v),_=0;_<v;++_)T[_]=0;return T}function ae(v,T,_){var y=1,F=0,C=0,z=0,te=0,V=v.length,X=J?new Uint16Array(32):cr(32);for(C=0;C<32;++C)X[C]=0;for(C=V;C<_;++C)v[C]=0;V=v.length;var K=J?new Uint16Array(V):cr(V);for(C=0;C<V;++C)X[F=v[C]]++,y<F&&(y=F),K[C]=0;for(X[0]=0,C=1;C<=y;++C)X[C+16]=te=te+X[C-1]<<1;for(C=0;C<V;++C)te=v[C],te!=0&&(K[C]=X[te+16]++);var le=0;for(C=0;C<V;++C)if(le=v[C],le!=0)for(te=S(K[C],y)>>y-le,z=(1<<y+4-le)-1;z>=0;--z)T[te|z<<le]=le&15|C<<4;return y}var re=J?new Uint16Array(512):cr(512),ge=J?new Uint16Array(32):cr(32);if(!J){for(var Te=0;Te<512;++Te)re[Te]=0;for(Te=0;Te<32;++Te)ge[Te]=0}(function(){for(var v=[],T=0;T<32;T++)v.push(5);ae(v,ge,32);var _=[];for(T=0;T<=143;T++)_.push(8);for(;T<=255;T++)_.push(9);for(;T<=279;T++)_.push(7);for(;T<=287;T++)_.push(8);ae(_,re,288)})();var Oe=function(){for(var T=J?new Uint8Array(32768):[],_=0,y=0;_<ee.length-1;++_)for(;y<ee[_+1];++y)T[y]=_;for(;y<32768;++y)T[y]=29;var F=J?new Uint8Array(259):[];for(_=0,y=0;_<W.length-1;++_)for(;y<W[_+1];++y)F[y]=_;function C(te,V){for(var X=0;X<te.length;){var K=Math.min(65535,te.length-X),le=X+K==te.length;for(V.write_shift(1,+le),V.write_shift(2,K),V.write_shift(2,~K&65535);K-- >0;)V[V.l++]=te[X++]}return V.l}function z(te,V){for(var X=0,K=0,le=J?new Uint16Array(32768):[];K<te.length;){var ve=Math.min(65535,te.length-K);if(ve<10){for(X=hr(V,X,+(K+ve==te.length)),X&7&&(X+=8-(X&7)),V.l=X/8|0,V.write_shift(2,ve),V.write_shift(2,~ve&65535);ve-- >0;)V[V.l++]=te[K++];X=V.l*8;continue}X=hr(V,X,+(K+ve==te.length)+2);for(var Se=0;ve-- >0;){var de=te[K];Se=(Se<<5^de)&32767;var _e=-1,Ue=0;if((_e=le[Se])&&(_e|=K&-32768,_e>K&&(_e-=32768),_e<K))for(;te[_e+Ue]==te[K+Ue]&&Ue<250;)++Ue;if(Ue>2){de=F[Ue],de<=22?X=Ur(V,X,q[de+1]>>1)-1:(Ur(V,X,3),X+=5,Ur(V,X,q[de-23]>>5),X+=3);var or=de<8?0:de-4>>2;or>0&&(Kr(V,X,Ue-W[de]),X+=or),de=T[K-_e],X=Ur(V,X,q[de]>>3),X-=3;var lr=de<4?0:de-2>>1;lr>0&&(Kr(V,X,K-_e-ee[de]),X+=lr);for(var jr=0;jr<Ue;++jr)le[Se]=K&32767,Se=(Se<<5^te[K])&32767,++K;ve-=Ue-1}else de<=143?de=de+48:X=Re(V,X,1),X=Ur(V,X,q[de]),le[Se]=K&32767,++K}X=Ur(V,X,0)-1}return V.l=(X+7)/8|0,V.l}return function(V,X){return V.length<8?C(V,X):z(V,X)}}();function ye(v){var T=Y(50+Math.floor(v.length*1.1)),_=Oe(v,T);return T.slice(0,_)}var Z=J?new Uint16Array(32768):cr(32768),ue=J?new Uint16Array(32768):cr(32768),oe=J?new Uint16Array(128):cr(128),be=1,De=1;function Pe(v,T){var _=Fe(v,T)+257;T+=5;var y=Fe(v,T)+1;T+=5;var F=Be(v,T)+4;T+=4;for(var C=0,z=J?new Uint8Array(19):cr(19),te=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],V=1,X=J?new Uint8Array(8):cr(8),K=J?new Uint8Array(8):cr(8),le=z.length,ve=0;ve<F;++ve)z[O[ve]]=C=Ce(v,T),V<C&&(V=C),X[C]++,T+=3;var Se=0;for(X[0]=0,ve=1;ve<=V;++ve)K[ve]=Se=Se+X[ve-1]<<1;for(ve=0;ve<le;++ve)(Se=z[ve])!=0&&(te[ve]=K[Se]++);var de=0;for(ve=0;ve<le;++ve)if(de=z[ve],de!=0){Se=q[te[ve]]>>8-de;for(var _e=(1<<7-de)-1;_e>=0;--_e)oe[Se|_e<<de]=de&7|ve<<3}var Ue=[];for(V=1;Ue.length<_+y;)switch(Se=oe[ce(v,T)],T+=Se&7,Se>>>=3){case 16:for(C=3+je(v,T),T+=2,Se=Ue[Ue.length-1];C-- >0;)Ue.push(Se);break;case 17:for(C=3+Ce(v,T),T+=3;C-- >0;)Ue.push(0);break;case 18:for(C=11+ce(v,T),T+=7;C-- >0;)Ue.push(0);break;default:Ue.push(Se),V<Se&&(V=Se);break}var or=Ue.slice(0,_),lr=Ue.slice(_);for(ve=_;ve<286;++ve)or[ve]=0;for(ve=y;ve<30;++ve)lr[ve]=0;return be=ae(or,Z,286),De=ae(lr,ue,30),T}function tr(v,T){if(v[0]==3&&!(v[1]&3))return[Pt(T),2];for(var _=0,y=0,F=E0(T||1<<18),C=0,z=F.length>>>0,te=0,V=0;!(y&1);){if(y=Ce(v,_),_+=3,y>>>1)y>>1==1?(te=9,V=5):(_=Pe(v,_),te=be,V=De);else{_&7&&(_+=8-(_&7));var X=v[_>>>3]|v[(_>>>3)+1]<<8;if(_+=32,X>0)for(!T&&z<C+X&&(F=$r(F,C+X),z=F.length);X-- >0;)F[C++]=v[_>>>3],_+=8;continue}for(;;){!T&&z<C+32767&&(F=$r(F,C+32767),z=F.length);var K=Ye(v,_,te),le=y>>>1==1?re[K]:Z[K];if(_+=le&15,le>>>=4,!(le>>>8&255))F[C++]=le;else{if(le==256)break;le-=257;var ve=le<8?0:le-4>>2;ve>5&&(ve=0);var Se=C+W[le];ve>0&&(Se+=Ye(v,_,ve),_+=ve),K=Ye(v,_,V),le=y>>>1==1?ge[K]:ue[K],_+=le&15,le>>>=4;var de=le<4?0:le-2>>1,_e=ee[le];for(de>0&&(_e+=Ye(v,_,de),_+=de),!T&&z<Se&&(F=$r(F,Se+100),z=F.length);C<Se;)F[C]=F[C-_e],++C}}}return T?[F,_+7>>>3]:[F.slice(0,C),_+7>>>3]}function lt(v,T){var _=v.slice(v.l||0),y=tr(_,T);return v.l+=y[1],y[0]}function Et(v,T){if(v)typeof console<"u"&&console.error(T);else throw new Error(T)}function Er(v,T){var _=v;Cr(_,0);var y=[],F=[],C={FileIndex:y,FullPaths:F};E(C,{root:T.root});for(var z=_.length-4;(_[z]!=80||_[z+1]!=75||_[z+2]!=5||_[z+3]!=6)&&z>=0;)--z;_.l=z+4,_.l+=4;var te=_.read_shift(2);_.l+=6;var V=_.read_shift(4);for(_.l=V,z=0;z<te;++z){_.l+=20;var X=_.read_shift(4),K=_.read_shift(4),le=_.read_shift(2),ve=_.read_shift(2),Se=_.read_shift(2);_.l+=8;var de=_.read_shift(4),_e=c(_.slice(_.l+le,_.l+le+ve));_.l+=le+ve+Se;var Ue=_.l;_.l=de+4,ft(_,X,K,C,_e),_.l=Ue}return C}function ft(v,T,_,y,F){v.l+=2;var C=v.read_shift(2),z=v.read_shift(2),te=i(v);if(C&8257)throw new Error("Unsupported ZIP encryption");for(var V=v.read_shift(4),X=v.read_shift(4),K=v.read_shift(4),le=v.read_shift(2),ve=v.read_shift(2),Se="",de=0;de<le;++de)Se+=String.fromCharCode(v[v.l++]);if(ve){var _e=c(v.slice(v.l,v.l+ve));(_e[21589]||{}).mt&&(te=_e[21589].mt),((F||{})[21589]||{}).mt&&(te=F[21589].mt)}v.l+=ve;var Ue=v.slice(v.l,v.l+X);switch(z){case 8:Ue=M(v,K);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+z)}var or=!1;C&8&&(V=v.read_shift(4),V==134695760&&(V=v.read_shift(4),or=!0),X=v.read_shift(4),K=v.read_shift(4)),X!=T&&Et(or,"Bad compressed size: "+T+" != "+X),K!=_&&Et(or,"Bad uncompressed size: "+_+" != "+K),rn(y,Se,Ue,{unsafe:!0,mt:te})}function dt(v,T){var _=T||{},y=[],F=[],C=Y(1),z=_.compression?8:0,te=0,V=0,X=0,K=0,le=0,ve=v.FullPaths[0],Se=ve,de=v.FileIndex[0],_e=[],Ue=0;for(V=1;V<v.FullPaths.length;++V)if(Se=v.FullPaths[V].slice(ve.length),de=v.FileIndex[V],!(!de.size||!de.content||Se=="Sh33tJ5")){var or=K,lr=Y(Se.length);for(X=0;X<Se.length;++X)lr.write_shift(1,Se.charCodeAt(X)&127);lr=lr.slice(0,lr.l),_e[le]=jl.buf(de.content,0);var jr=de.content;z==8&&(jr=D(jr)),C=Y(30),C.write_shift(4,67324752),C.write_shift(2,20),C.write_shift(2,te),C.write_shift(2,z),de.mt?n(C,de.mt):C.write_shift(4,0),C.write_shift(-4,_e[le]),C.write_shift(4,jr.length),C.write_shift(4,de.content.length),C.write_shift(2,lr.length),C.write_shift(2,0),K+=C.length,y.push(C),K+=lr.length,y.push(lr),K+=jr.length,y.push(jr),C=Y(46),C.write_shift(4,33639248),C.write_shift(2,0),C.write_shift(2,20),C.write_shift(2,te),C.write_shift(2,z),C.write_shift(4,0),C.write_shift(-4,_e[le]),C.write_shift(4,jr.length),C.write_shift(4,de.content.length),C.write_shift(2,lr.length),C.write_shift(2,0),C.write_shift(2,0),C.write_shift(2,0),C.write_shift(2,0),C.write_shift(4,0),C.write_shift(4,or),Ue+=C.l,F.push(C),Ue+=lr.length,F.push(lr),++le}return C=Y(22),C.write_shift(4,101010256),C.write_shift(2,0),C.write_shift(2,0),C.write_shift(2,le),C.write_shift(2,le),C.write_shift(4,Ue),C.write_shift(4,K),C.write_shift(2,0),Tr([Tr(y),Tr(F),C])}var pt={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function zt(v,T){if(v.ctype)return v.ctype;var _=v.name||"",y=_.match(/\.([^\.]+)$/);return y&&pt[y[1]]||T&&(y=(_=T).match(/[\.\\]([^\.\\])+$/),y&&pt[y[1]])?pt[y[1]]:"application/octet-stream"}function Qs(v){for(var T=Xa(v),_=[],y=0;y<T.length;y+=76)_.push(T.slice(y,y+76));return _.join(`\r
`)+`\r
`}function Gt(v){var T=v.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(X){var K=X.charCodeAt(0).toString(16).toUpperCase();return"="+(K.length==1?"0"+K:K)});T=T.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),T.charAt(0)==`
`&&(T="=0D"+T.slice(1)),T=T.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var _=[],y=T.split(`\r
`),F=0;F<y.length;++F){var C=y[F];if(C.length==0){_.push("");continue}for(var z=0;z<C.length;){var te=76,V=C.slice(z,z+te);V.charAt(te-1)=="="?te--:V.charAt(te-2)=="="?te-=2:V.charAt(te-3)=="="&&(te-=3),V=C.slice(z,z+te),z+=te,z<C.length&&(V+="="),_.push(V)}}return _.join(`\r
`)}function en(v){for(var T=[],_=0;_<v.length;++_){for(var y=v[_];_<=v.length&&y.charAt(y.length-1)=="=";)y=y.slice(0,y.length-1)+v[++_];T.push(y)}for(var F=0;F<T.length;++F)T[F]=T[F].replace(/[=][0-9A-Fa-f]{2}/g,function(C){return String.fromCharCode(parseInt(C.slice(1),16))});return qr(T.join(`\r
`))}function Ne(v,T,_){for(var y="",F="",C="",z,te=0;te<10;++te){var V=T[te];if(!V||V.match(/^\s*$/))break;var X=V.match(/^(.*?):\s*([^\s].*)$/);if(X)switch(X[1].toLowerCase()){case"content-location":y=X[2].trim();break;case"content-type":C=X[2].trim();break;case"content-transfer-encoding":F=X[2].trim();break}}switch(++te,F.toLowerCase()){case"base64":z=qr(Qr(T.slice(te).join("")));break;case"quoted-printable":z=en(T.slice(te));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+F)}var K=rn(v,y.slice(_.length),z,{unsafe:!0});C&&(K.ctype=C)}function Je(v,T){if(H(v.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var _=T&&T.root||"",y=($e&&Buffer.isBuffer(v)?v.toString("binary"):H(v)).split(`\r
`),F=0,C="";for(F=0;F<y.length;++F)if(C=y[F],!!/^Content-Location:/i.test(C)&&(C=C.slice(C.indexOf("file")),_||(_=C.slice(0,C.lastIndexOf("/")+1)),C.slice(0,_.length)!=_))for(;_.length>0&&(_=_.slice(0,_.length-1),_=_.slice(0,_.lastIndexOf("/")+1),C.slice(0,_.length)!=_););var z=(y[1]||"").match(/boundary="(.*?)"/);if(!z)throw new Error("MAD cannot find boundary");var te="--"+(z[1]||""),V=[],X=[],K={FileIndex:V,FullPaths:X};E(K);var le,ve=0;for(F=0;F<y.length;++F){var Se=y[F];Se!==te&&Se!==te+"--"||(ve++&&Ne(K,y.slice(le,F),_),le=F)}return K}function ua(v,T){var _=T||{},y=_.boundary||"SheetJS";y="------="+y;for(var F=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+y.slice(2)+'"',"","",""],C=v.FullPaths[0],z=C,te=v.FileIndex[0],V=1;V<v.FullPaths.length;++V)if(z=v.FullPaths[V].slice(C.length),te=v.FileIndex[V],!(!te.size||!te.content||z=="Sh33tJ5")){z=z.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Ue){return"_x"+Ue.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Ue){return"_u"+Ue.charCodeAt(0).toString(16)+"_"});for(var X=te.content,K=$e&&Buffer.isBuffer(X)?X.toString("binary"):H(X),le=0,ve=Math.min(1024,K.length),Se=0,de=0;de<=ve;++de)(Se=K.charCodeAt(de))>=32&&Se<128&&++le;var _e=le>=ve*4/5;F.push(y),F.push("Content-Location: "+(_.root||"file:///C:/SheetJS/")+z),F.push("Content-Transfer-Encoding: "+(_e?"quoted-printable":"base64")),F.push("Content-Type: "+zt(te,z)),F.push(""),F.push(_e?Gt(K):Qs(K))}return F.push(y+`--\r
`),F.join(`\r
`)}function Xt(v){var T={};return E(T,v),T}function rn(v,T,_,y){var F=y&&y.unsafe;F||E(v);var C=!F&&Ae.find(v,T);if(!C){var z=v.FullPaths[0];T.slice(0,z.length)==z?z=T:(z.slice(-1)!="/"&&(z+="/"),z=(z+T).replace("//","/")),C={name:s(T),type:2},v.FileIndex.push(C),v.FullPaths.push(z),F||Ae.utils.cfb_gc(v)}return C.content=_,C.size=_?_.length:0,y&&(y.CLSID&&(C.clsid=y.CLSID),y.mt&&(C.mt=y.mt),y.ct&&(C.ct=y.ct)),C}function qo(v,T){E(v);var _=Ae.find(v,T);if(_){for(var y=0;y<v.FileIndex.length;++y)if(v.FileIndex[y]==_)return v.FileIndex.splice(y,1),v.FullPaths.splice(y,1),!0}return!1}function Zo(v,T,_){E(v);var y=Ae.find(v,T);if(y){for(var F=0;F<v.FileIndex.length;++F)if(v.FileIndex[F]==y)return v.FileIndex[F].name=s(_),v.FullPaths[F]=_,!0}return!1}function Qo(v){N(v,!0)}return t.find=L,t.read=I,t.parse=d,t.write=we,t.writeFile=Ve,t.utils={cfb_new:Xt,cfb_add:rn,cfb_del:qo,cfb_mov:Zo,cfb_gc:Qo,ReadShift:Pa,CheckField:vc,prep_blob:Cr,bconcat:Tr,use_zlib:A,_deflateRaw:ye,_inflateRaw:lt,consts:he},t}();function Dl(e){return typeof e=="string"?$s(e):Array.isArray(e)?sl(e):e}function ls(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=$s(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var a=r=="utf8"?_t(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(a,e);if(typeof Blob<"u"){var s=new Blob([Dl(a)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(s,e);if(typeof saveAs<"u")return saveAs(s,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var n=URL.createObjectURL(s);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(n)},6e4),chrome.downloads.download({url:n,filename:e,saveAs:!0});var i=document.createElement("a");if(i.download!=null)return i.download=e,i.href=n,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(n)},6e4),n}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var c=File(e);return c.open("w"),c.encoding="binary",Array.isArray(t)&&(t=Ht(t)),c.write(t),c.close(),t}catch(l){if(!l.message||!l.message.match(/onstruct/))throw l}throw new Error("cannot save file "+e)}function Il(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(a){if(!a.message||!a.message.match(/onstruct/))throw a}throw new Error("Cannot access file "+e)}function mr(e){for(var t=Object.keys(e),r=[],a=0;a<t.length;++a)Object.prototype.hasOwnProperty.call(e,t[a])&&r.push(t[a]);return r}function D0(e,t){for(var r=[],a=mr(e),s=0;s!==a.length;++s)r[e[a[s]][t]]==null&&(r[e[a[s]][t]]=a[s]);return r}function Gs(e){for(var t=[],r=mr(e),a=0;a!==r.length;++a)t[e[r[a]]]=r[a];return t}function Xs(e){for(var t=[],r=mr(e),a=0;a!==r.length;++a)t[e[r[a]]]=parseInt(r[a],10);return t}function Ol(e){for(var t=[],r=mr(e),a=0;a!==r.length;++a)t[e[r[a]]]==null&&(t[e[r[a]]]=[]),t[e[r[a]]].push(r[a]);return t}var Ls=new Date(1899,11,30,0,0,0);function br(e,t){var r=e.getTime(),a=Ls.getTime()+(e.getTimezoneOffset()-Ls.getTimezoneOffset())*6e4;return(r-a)/(24*60*60*1e3)}var qi=new Date,Ll=Ls.getTime()+(qi.getTimezoneOffset()-Ls.getTimezoneOffset())*6e4,I0=qi.getTimezoneOffset();function Ks(e){var t=new Date;return t.setTime(e*24*60*60*1e3+Ll),t.getTimezoneOffset()!==I0&&t.setTime(t.getTime()+(t.getTimezoneOffset()-I0)*6e4),t}function Rl(e){var t=0,r=0,a=!1,s=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!s)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var n=1;n!=s.length;++n)if(s[n]){switch(r=1,n>3&&(a=!0),s[n].slice(s[n].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+s[n].slice(s[n].length-1));case"D":r*=24;case"H":r*=60;case"M":if(a)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(s[n],10)}return t}var O0=new Date("2017-02-19T19:06:09.000Z"),Zi=isNaN(O0.getFullYear())?new Date("2/19/17"):O0,Ml=Zi.getFullYear()==2017;function nr(e,t){var r=new Date(e);if(Ml)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(Zi.getFullYear()==1917&&!isNaN(r.getFullYear())){var a=r.getFullYear();return e.indexOf(""+a)>-1||r.setFullYear(r.getFullYear()+100),r}var s=e.match(/\d+/g)||["2017","2","19","0","0","0"],n=new Date(+s[0],+s[1]-1,+s[2],+s[3]||0,+s[4]||0,+s[5]||0);return e.indexOf("Z")>-1&&(n=new Date(n.getTime()-n.getTimezoneOffset()*60*1e3)),n}function ta(e,t){if($e&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return _t(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return _t(Bi(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return _t(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return _t(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"€":"","‚":"",ƒ:"","„":"","…":"","†":"","‡":"","ˆ":"","‰":"",Š:"","‹":"",Œ:"",Ž:"","‘":"","’":"","“":"","”":"","•":"","–":"","—":"","˜":"","™":"",š:"","›":"",œ:"",ž:"",Ÿ:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(n){return r[n]||n})}catch{}for(var a=[],s=0;s!=e.length;++s)a.push(String.fromCharCode(e[s]));return a.join("")}function ir(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=ir(e[r]));return t}function ur(e,t){for(var r="";r.length<t;)r+=e;return r}function mt(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,a=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(a))||(a=a.replace(/[(](.*)[)]/,function(s,n){return r=-r,n}),!isNaN(t=Number(a)))?t/r:t}var Pl=["january","february","march","april","may","june","july","august","september","october","november","december"];function ba(e){var t=new Date(e),r=new Date(NaN),a=t.getYear(),s=t.getMonth(),n=t.getDate();if(isNaN(n))return r;var i=e.toLowerCase();if(i.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(i=i.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),i.length>3&&Pl.indexOf(i)==-1)return r}else if(i.match(/[a-z]/))return r;return a<0||a>8099?r:(s>0||n>1)&&a!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var Bl=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,a,s){if(e||typeof a=="string")return r.split(a);for(var n=r.split(a),i=[n[0]],c=1;c<n.length;++c)i.push(s),i.push(n[c]);return i}}();function Qi(e){return e?e.content&&e.type?ta(e.content,!0):e.data?La(e.data):e.asNodeBuffer&&$e?La(e.asNodeBuffer().toString("binary")):e.asBinary?La(e.asBinary()):e._data&&e._data.getContent?La(ta(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function ec(e){if(!e)return null;if(e.data)return y0(e.data);if(e.asNodeBuffer&&$e)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?y0(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function Ul(e){return e&&e.name.slice(-4)===".bin"?ec(e):Qi(e)}function st(e,t){for(var r=e.FullPaths||mr(e.files),a=t.toLowerCase().replace(/[\/]/g,"\\"),s=a.replace(/\\/g,"/"),n=0;n<r.length;++n){var i=r[n].replace(/^Root Entry[\/]/,"").toLowerCase();if(a==i||s==i)return e.files?e.files[r[n]]:e.FileIndex[n]}return null}function Wn(e,t){var r=st(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function kr(e,t,r){if(!r)return Ul(Wn(e,t));if(!t)return null;try{return kr(e,t)}catch{return null}}function Zr(e,t,r){if(!r)return Qi(Wn(e,t));if(!t)return null;try{return Zr(e,t)}catch{return null}}function Wl(e,t,r){return ec(Wn(e,t))}function L0(e){for(var t=e.FullPaths||mr(e.files),r=[],a=0;a<t.length;++a)t[a].slice(-1)!="/"&&r.push(t[a].replace(/^Root Entry[\/]/,""));return r.sort()}function He(e,t,r){if(e.FullPaths){if(typeof r=="string"){var a;return $e?a=jt(r):a=nl(r),Ae.utils.cfb_add(e,t,a)}Ae.utils.cfb_add(e,t,r)}else e.file(t,r)}function Hn(){return Ae.utils.cfb_new()}function rc(e,t){switch(t.type){case"base64":return Ae.read(e,{type:"base64"});case"binary":return Ae.read(e,{type:"binary"});case"buffer":case"array":return Ae.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function Ma(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var a=e.split("/");a.length!==0;){var s=a.shift();s===".."?r.pop():s!=="."&&r.push(s)}return r.join("/")}var vr=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,Hl=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,R0=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,Vl=/<[^>]*>/g,Br=vr.match(R0)?R0:Vl,$l=/<\w*:/,zl=/<(\/?)\w+:/;function Me(e,t,r){for(var a={},s=0,n=0;s!==e.length&&!((n=e.charCodeAt(s))===32||n===10||n===13);++s);if(t||(a[0]=e.slice(0,s)),s===e.length)return a;var i=e.match(Hl),c=0,l="",f=0,d="",u="",h=1;if(i)for(f=0;f!=i.length;++f){for(u=i[f],n=0;n!=u.length&&u.charCodeAt(n)!==61;++n);for(d=u.slice(0,n).trim();u.charCodeAt(n+1)==32;)++n;for(h=(s=u.charCodeAt(n+1))==34||s==39?1:0,l=u.slice(n+1+h,u.length-h),c=0;c!=d.length&&d.charCodeAt(c)!==58;++c);if(c===d.length)d.indexOf("_")>0&&(d=d.slice(0,d.indexOf("_"))),a[d]=l,a[d.toLowerCase()]=l;else{var m=(c===5&&d.slice(0,5)==="xmlns"?"xmlns":"")+d.slice(c+1);if(a[m]&&d.slice(c-3,c)=="ext")continue;a[m]=l,a[m.toLowerCase()]=l}}return a}function yt(e){return e.replace(zl,"<$1")}var tc={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Vn=Gs(tc),Ge=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(a){var s=a+"",n=s.indexOf("<![CDATA[");if(n==-1)return s.replace(e,function(c,l){return tc[c]||String.fromCharCode(parseInt(l,c.indexOf("x")>-1?16:10))||c}).replace(t,function(c,l){return String.fromCharCode(parseInt(l,16))});var i=s.indexOf("]]>");return r(s.slice(0,n))+s.slice(n+9,i)+r(s.slice(i+3))}}(),$n=/[&<>'"]/g,Gl=/[\u0000-\u0008\u000b-\u001f]/g;function er(e){var t=e+"";return t.replace($n,function(r){return Vn[r]}).replace(Gl,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function M0(e){return er(e).replace(/ /g,"_x0020_")}var ac=/[\u0000-\u001f]/g;function zn(e){var t=e+"";return t.replace($n,function(r){return Vn[r]}).replace(/\n/g,"<br/>").replace(ac,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function Xl(e){var t=e+"";return t.replace($n,function(r){return Vn[r]}).replace(ac,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var P0=function(){var e=/&#(\d+);/g;function t(r,a){return String.fromCharCode(parseInt(a,10))}return function(a){return a.replace(e,t)}}();function Kl(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function sr(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function sn(e){for(var t="",r=0,a=0,s=0,n=0,i=0,c=0;r<e.length;){if(a=e.charCodeAt(r++),a<128){t+=String.fromCharCode(a);continue}if(s=e.charCodeAt(r++),a>191&&a<224){i=(a&31)<<6,i|=s&63,t+=String.fromCharCode(i);continue}if(n=e.charCodeAt(r++),a<240){t+=String.fromCharCode((a&15)<<12|(s&63)<<6|n&63);continue}i=e.charCodeAt(r++),c=((a&7)<<18|(s&63)<<12|(n&63)<<6|i&63)-65536,t+=String.fromCharCode(55296+(c>>>10&1023)),t+=String.fromCharCode(56320+(c&1023))}return t}function B0(e){var t=Pt(2*e.length),r,a,s=1,n=0,i=0,c;for(a=0;a<e.length;a+=s)s=1,(c=e.charCodeAt(a))<128?r=c:c<224?(r=(c&31)*64+(e.charCodeAt(a+1)&63),s=2):c<240?(r=(c&15)*4096+(e.charCodeAt(a+1)&63)*64+(e.charCodeAt(a+2)&63),s=3):(s=4,r=(c&7)*262144+(e.charCodeAt(a+1)&63)*4096+(e.charCodeAt(a+2)&63)*64+(e.charCodeAt(a+3)&63),r-=65536,i=55296+(r>>>10&1023),r=56320+(r&1023)),i!==0&&(t[n++]=i&255,t[n++]=i>>>8,i=0),t[n++]=r%256,t[n++]=r>>>8;return t.slice(0,n).toString("ucs2")}function U0(e){return jt(e,"binary").toString("utf8")}var vs="foo bar bazâð£",rr=$e&&(U0(vs)==sn(vs)&&U0||B0(vs)==sn(vs)&&B0)||sn,_t=$e?function(e){return jt(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,a=0,s=0;r<e.length;)switch(a=e.charCodeAt(r++),!0){case a<128:t.push(String.fromCharCode(a));break;case a<2048:t.push(String.fromCharCode(192+(a>>6))),t.push(String.fromCharCode(128+(a&63)));break;case(a>=55296&&a<57344):a-=55296,s=e.charCodeAt(r++)-56320+(a<<10),t.push(String.fromCharCode(240+(s>>18&7))),t.push(String.fromCharCode(144+(s>>12&63))),t.push(String.fromCharCode(128+(s>>6&63))),t.push(String.fromCharCode(128+(s&63)));break;default:t.push(String.fromCharCode(224+(a>>12))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(a&63)))}return t.join("")},Ya=function(){var e={};return function(r,a){var s=r+"|"+(a||"");return e[s]?e[s]:e[s]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",a||"")}}(),sc=function(){var e=[["nbsp"," "],["middot","·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var a=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),s=0;s<e.length;++s)a=a.replace(e[s][0],e[s][1]);return a}}(),Yl=function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),Jl=/<\/?(?:vt:)?variant>/g,ql=/<(?:vt:)([^>]*)>([\s\S]*)</;function W0(e,t){var r=Me(e),a=e.match(Yl(r.baseType))||[],s=[];if(a.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+a.length+" != "+r.size);return s}return a.forEach(function(n){var i=n.replace(Jl,"").match(ql);i&&s.push({v:rr(i[2]),t:i[1]})}),s}var nc=/(^\s|\s$|\n)/;function Ar(e,t){return"<"+e+(t.match(nc)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function Ja(e){return mr(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function xe(e,t,r){return"<"+e+(r!=null?Ja(r):"")+(t!=null?(t.match(nc)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function En(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function Zl(e,t){switch(typeof e){case"string":var r=xe("vt:lpwstr",er(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return xe((e|0)==e?"vt:i4":"vt:r8",er(String(e)));case"boolean":return xe("vt:bool",e?"true":"false")}if(e instanceof Date)return xe("vt:filetime",En(e));throw new Error("Unable to serialize "+e)}function Gn(e){if($e&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return rr(Ht(Pn(e)));throw new Error("Bad input format: expected Buffer or string")}var qa=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,yr={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},ca=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Yr={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function Ql(e,t){for(var r=1-2*(e[t+7]>>>7),a=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),s=e[t+6]&15,n=5;n>=0;--n)s=s*256+e[t+n];return a==2047?s==0?r*(1/0):NaN:(a==0?a=-1022:(a-=1023,s+=Math.pow(2,52)),r*Math.pow(2,a-52)*s)}function ef(e,t,r){var a=(t<0||1/t==-1/0?1:0)<<7,s=0,n=0,i=a?-t:t;isFinite(i)?i==0?s=n=0:(s=Math.floor(Math.log(i)/Math.LN2),n=i*Math.pow(2,52-s),s<=-1023&&(!isFinite(n)||n<Math.pow(2,52))?s=-1022:(n-=Math.pow(2,52),s+=1023)):(s=2047,n=isNaN(t)?26985:0);for(var c=0;c<=5;++c,n/=256)e[r+c]=n&255;e[r+6]=(s&15)<<4|n&15,e[r+7]=s>>4|a}var H0=function(e){for(var t=[],r=10240,a=0;a<e[0].length;++a)if(e[0][a])for(var s=0,n=e[0][a].length;s<n;s+=r)t.push.apply(t,e[0][a].slice(s,s+r));return t},V0=$e?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:jt(t)})):H0(e)}:H0,$0=function(e,t,r){for(var a=[],s=t;s<r;s+=2)a.push(String.fromCharCode(Tt(e,s)));return a.join("").replace(Vr,"")},Xn=$e?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(Vr,""):$0(e,t,r)}:$0,z0=function(e,t,r){for(var a=[],s=t;s<t+r;++s)a.push(("0"+e[s].toString(16)).slice(-2));return a.join("")},ic=$e?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):z0(e,t,r)}:z0,G0=function(e,t,r){for(var a=[],s=t;s<r;s++)a.push(String.fromCharCode(pa(e,s)));return a.join("")},fs=$e?function(t,r,a){return Buffer.isBuffer(t)?t.toString("utf8",r,a):G0(t,r,a)}:G0,cc=function(e,t){var r=Jr(e,t);return r>0?fs(e,t+4,t+4+r-1):""},oc=cc,lc=function(e,t){var r=Jr(e,t);return r>0?fs(e,t+4,t+4+r-1):""},fc=lc,dc=function(e,t){var r=2*Jr(e,t);return r>0?fs(e,t+4,t+4+r-1):""},hc=dc,uc=function(t,r){var a=Jr(t,r);return a>0?Xn(t,r+4,r+4+a):""},xc=uc,mc=function(e,t){var r=Jr(e,t);return r>0?fs(e,t+4,t+4+r):""},gc=mc,pc=function(e,t){return Ql(e,t)},Rs=pc,Kn=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};$e&&(oc=function(t,r){if(!Buffer.isBuffer(t))return cc(t,r);var a=t.readUInt32LE(r);return a>0?t.toString("utf8",r+4,r+4+a-1):""},fc=function(t,r){if(!Buffer.isBuffer(t))return lc(t,r);var a=t.readUInt32LE(r);return a>0?t.toString("utf8",r+4,r+4+a-1):""},hc=function(t,r){if(!Buffer.isBuffer(t))return dc(t,r);var a=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+a-1)},xc=function(t,r){if(!Buffer.isBuffer(t))return uc(t,r);var a=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+a)},gc=function(t,r){if(!Buffer.isBuffer(t))return mc(t,r);var a=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+a)},Rs=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):pc(t,r)},Kn=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var pa=function(e,t){return e[t]},Tt=function(e,t){return e[t+1]*256+e[t]},rf=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},Jr=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Yt=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},tf=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Pa(e,t){var r="",a,s,n=[],i,c,l,f;switch(t){case"dbcs":if(f=this.l,$e&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(l=0;l<e;++l)r+=String.fromCharCode(Tt(this,f)),f+=2;e*=2;break;case"utf8":r=fs(this,this.l,this.l+e);break;case"utf16le":e*=2,r=Xn(this,this.l,this.l+e);break;case"wstr":return Pa.call(this,e,"dbcs");case"lpstr-ansi":r=oc(this,this.l),e=4+Jr(this,this.l);break;case"lpstr-cp":r=fc(this,this.l),e=4+Jr(this,this.l);break;case"lpwstr":r=hc(this,this.l),e=4+2*Jr(this,this.l);break;case"lpp4":e=4+Jr(this,this.l),r=xc(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+Jr(this,this.l),r=gc(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(i=pa(this,this.l+e++))!==0;)n.push(ps(i));r=n.join("");break;case"_wstr":for(e=0,r="";(i=Tt(this,this.l+e))!==0;)n.push(ps(i)),e+=2;e+=2,r=n.join("");break;case"dbcs-cont":for(r="",f=this.l,l=0;l<e;++l){if(this.lens&&this.lens.indexOf(f)!==-1)return i=pa(this,f),this.l=f+1,c=Pa.call(this,e-l,i?"dbcs-cont":"sbcs-cont"),n.join("")+c;n.push(ps(Tt(this,f))),f+=2}r=n.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",f=this.l,l=0;l!=e;++l){if(this.lens&&this.lens.indexOf(f)!==-1)return i=pa(this,f),this.l=f+1,c=Pa.call(this,e-l,i?"dbcs-cont":"sbcs-cont"),n.join("")+c;n.push(ps(pa(this,f))),f+=1}r=n.join("");break;default:switch(e){case 1:return a=pa(this,this.l),this.l++,a;case 2:return a=(t==="i"?rf:Tt)(this,this.l),this.l+=2,a;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(a=(e>0?Yt:tf)(this,this.l),this.l+=4,a):(s=Jr(this,this.l),this.l+=4,s);case 8:case-8:if(t==="f")return e==8?s=Rs(this,this.l):s=Rs([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,s;e=8;case 16:r=ic(this,this.l,e);break}}return this.l+=e,r}var af=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},sf=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},nf=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function cf(e,t,r){var a=0,s=0;if(r==="dbcs"){for(s=0;s!=t.length;++s)nf(this,t.charCodeAt(s),this.l+2*s);a=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),s=0;s!=t.length;++s)this[this.l+s]=t.charCodeAt(s)&255;a=t.length}else if(r==="hex"){for(;s<e;++s)this[this.l++]=parseInt(t.slice(2*s,2*s+2),16)||0;return this}else if(r==="utf16le"){var n=Math.min(this.l+e,this.length);for(s=0;s<Math.min(t.length,e);++s){var i=t.charCodeAt(s);this[this.l++]=i&255,this[this.l++]=i>>8}for(;this.l<n;)this[this.l++]=0;return this}else switch(e){case 1:a=1,this[this.l]=t&255;break;case 2:a=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:a=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:a=4,af(this,t,this.l);break;case 8:if(a=8,r==="f"){ef(this,t,this.l);break}case 16:break;case-4:a=4,sf(this,t,this.l);break}return this.l+=a,this}function vc(e,t){var r=ic(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function Cr(e,t){e.l=t,e.read_shift=Pa,e.chk=vc,e.write_shift=cf}function Pr(e,t){e.l+=t}function Y(e){var t=Pt(e);return Cr(t,0),t}function Dt(e,t,r){if(e){var a,s,n;Cr(e,e.l||0);for(var i=e.length,c=0,l=0;e.l<i;){c=e.read_shift(1),c&128&&(c=(c&127)+((e.read_shift(1)&127)<<7));var f=as[c]||as[65535];for(a=e.read_shift(1),n=a&127,s=1;s<4&&a&128;++s)n+=((a=e.read_shift(1))&127)<<7*s;l=e.l+n;var d=f.f&&f.f(e,n,r);if(e.l=l,t(d,f,c))return}}}function Gr(){var e=[],t=$e?256:2048,r=function(f){var d=Y(f);return Cr(d,0),d},a=r(t),s=function(){a&&(a.length>a.l&&(a=a.slice(0,a.l),a.l=a.length),a.length>0&&e.push(a),a=null)},n=function(f){return a&&f<a.length-a.l?a:(s(),a=r(Math.max(f+1,t)))},i=function(){return s(),Tr(e)},c=function(f){s(),a=f,a.l==null&&(a.l=a.length),n(t)};return{next:n,push:c,end:i,_bufs:e}}function ne(e,t,r,a){var s=+t,n;if(!isNaN(s)){a||(a=as[s].p||(r||[]).length||0),n=1+(s>=128?1:0)+1,a>=128&&++n,a>=16384&&++n,a>=2097152&&++n;var i=e.next(n);s<=127?i.write_shift(1,s):(i.write_shift(1,(s&127)+128),i.write_shift(1,s>>7));for(var c=0;c!=4;++c)if(a>=128)i.write_shift(1,(a&127)+128),a>>=7;else{i.write_shift(1,a);break}a>0&&Kn(r)&&e.push(r)}}function Ba(e,t,r){var a=ir(e);if(t.s?(a.cRel&&(a.c+=t.s.c),a.rRel&&(a.r+=t.s.r)):(a.cRel&&(a.c+=t.c),a.rRel&&(a.r+=t.r)),!r||r.biff<12){for(;a.c>=256;)a.c-=256;for(;a.r>=65536;)a.r-=65536}return a}function X0(e,t,r){var a=ir(e);return a.s=Ba(a.s,t.s,r),a.e=Ba(a.e,t.s,r),a}function Ua(e,t){if(e.cRel&&e.c<0)for(e=ir(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=ir(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=Le(e);return!e.cRel&&e.cRel!=null&&(r=ff(r)),!e.rRel&&e.rRel!=null&&(r=of(r)),r}function nn(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+fr(e.s.c)+":"+(e.e.cRel?"":"$")+fr(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+pr(e.s.r)+":"+(e.e.rRel?"":"$")+pr(e.e.r):Ua(e.s,t.biff)+":"+Ua(e.e,t.biff)}function Yn(e){return parseInt(lf(e),10)-1}function pr(e){return""+(e+1)}function of(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function lf(e){return e.replace(/\$(\d+)$/,"$1")}function Jn(e){for(var t=df(e),r=0,a=0;a!==t.length;++a)r=26*r+t.charCodeAt(a)-64;return r-1}function fr(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function ff(e){return e.replace(/^([A-Z])/,"$$$1")}function df(e){return e.replace(/^\$([A-Z])/,"$1")}function hf(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function dr(e){for(var t=0,r=0,a=0;a<e.length;++a){var s=e.charCodeAt(a);s>=48&&s<=57?t=10*t+(s-48):s>=65&&s<=90&&(r=26*r+(s-64))}return{c:r-1,r:t-1}}function Le(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function Xr(e){var t=e.indexOf(":");return t==-1?{s:dr(e),e:dr(e)}:{s:dr(e.slice(0,t)),e:dr(e.slice(t+1))}}function We(e,t){return typeof t>"u"||typeof t=="number"?We(e.s,e.e):(typeof e!="string"&&(e=Le(e)),typeof t!="string"&&(t=Le(t)),e==t?e:e+":"+t)}function Xe(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,a=0,s=0,n=e.length;for(r=0;a<n&&!((s=e.charCodeAt(a)-64)<1||s>26);++a)r=26*r+s;for(t.s.c=--r,r=0;a<n&&!((s=e.charCodeAt(a)-48)<0||s>9);++a)r=10*r+s;if(t.s.r=--r,a===n||s!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++a,r=0;a!=n&&!((s=e.charCodeAt(a)-64)<1||s>26);++a)r=26*r+s;for(t.e.c=--r,r=0;a!=n&&!((s=e.charCodeAt(a)-48)<0||s>9);++a)r=10*r+s;return t.e.r=--r,t}function K0(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=ct(e.z,r?br(t):t)}catch{}try{return e.w=ct((e.XF||{}).numFmtId||(r?14:0),r?br(t):t)}catch{return""+t}}function At(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?It[e.v]||e.v:t==null?K0(e,e.v):K0(e,t))}function Vt(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",a={};return a[r]=e,{SheetNames:[r],Sheets:a}}function wc(e,t,r){var a=r||{},s=e?Array.isArray(e):a.dense,n=e||(s?[]:{}),i=0,c=0;if(n&&a.origin!=null){if(typeof a.origin=="number")i=a.origin;else{var l=typeof a.origin=="string"?dr(a.origin):a.origin;i=l.r,c=l.c}n["!ref"]||(n["!ref"]="A1:A1")}var f={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(n["!ref"]){var d=Xe(n["!ref"]);f.s.c=d.s.c,f.s.r=d.s.r,f.e.c=Math.max(f.e.c,d.e.c),f.e.r=Math.max(f.e.r,d.e.r),i==-1&&(f.e.r=i=d.e.r+1)}for(var u=0;u!=t.length;++u)if(t[u]){if(!Array.isArray(t[u]))throw new Error("aoa_to_sheet expects an array of arrays");for(var h=0;h!=t[u].length;++h)if(!(typeof t[u][h]>"u")){var m={v:t[u][h]},g=i+u,x=c+h;if(f.s.r>g&&(f.s.r=g),f.s.c>x&&(f.s.c=x),f.e.r<g&&(f.e.r=g),f.e.c<x&&(f.e.c=x),t[u][h]&&typeof t[u][h]=="object"&&!Array.isArray(t[u][h])&&!(t[u][h]instanceof Date))m=t[u][h];else if(Array.isArray(m.v)&&(m.f=t[u][h][1],m.v=m.v[0]),m.v===null)if(m.f)m.t="n";else if(a.nullError)m.t="e",m.v=0;else if(a.sheetStubs)m.t="z";else continue;else typeof m.v=="number"?m.t="n":typeof m.v=="boolean"?m.t="b":m.v instanceof Date?(m.z=a.dateNF||Ie[14],a.cellDates?(m.t="d",m.w=ct(m.z,br(m.v))):(m.t="n",m.v=br(m.v),m.w=ct(m.z,m.v))):m.t="s";if(s)n[g]||(n[g]=[]),n[g][x]&&n[g][x].z&&(m.z=n[g][x].z),n[g][x]=m;else{var p=Le({c:x,r:g});n[p]&&n[p].z&&(m.z=n[p].z),n[p]=m}}}return f.s.c<1e7&&(n["!ref"]=We(f)),n}function Ca(e,t){return wc(null,e,t)}function uf(e){return e.read_shift(4,"i")}function gt(e,t){return t||(t=Y(4)),t.write_shift(4,e),t}function Mr(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function Nr(e,t){var r=!1;return t==null&&(r=!0,t=Y(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function xf(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function mf(e,t){return t||(t=Y(4)),t.write_shift(2,0),t.write_shift(2,0),t}function qn(e,t){var r=e.l,a=e.read_shift(1),s=Mr(e),n=[],i={t:s,h:s};if(a&1){for(var c=e.read_shift(4),l=0;l!=c;++l)n.push(xf(e));i.r=n}else i.r=[{ich:0,ifnt:0}];return e.l=r+t,i}function gf(e,t){var r=!1;return t==null&&(r=!0,t=Y(15+4*e.t.length)),t.write_shift(1,0),Nr(e.t,t),r?t.slice(0,t.l):t}var pf=qn;function vf(e,t){var r=!1;return t==null&&(r=!0,t=Y(23+4*e.t.length)),t.write_shift(1,1),Nr(e.t,t),t.write_shift(4,1),mf({},t),r?t.slice(0,t.l):t}function ot(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function oa(e,t){return t==null&&(t=Y(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function la(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function fa(e,t){return t==null&&(t=Y(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var wf=Mr,kc=Nr;function Zn(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function Ms(e,t){var r=!1;return t==null&&(r=!0,t=Y(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var kf=Mr,Sn=Zn,Qn=Ms;function e0(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,a=t[0]&2;e.l+=4;var s=a===0?Rs([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):Yt(t,0)>>2;return r?s/100:s}function _c(e,t){t==null&&(t=Y(4));var r=0,a=0,s=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?a=1:s==(s|0)&&s>=-536870912&&s<1<<29&&(a=1,r=1),a)t.write_shift(-4,((r?s:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function yc(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function _f(e,t){return t||(t=Y(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var da=yc,Aa=_f;function Rr(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function aa(e,t){return(t||Y(8)).write_shift(8,e,"f")}function yf(e){var t={},r=e.read_shift(1),a=r>>>1,s=e.read_shift(1),n=e.read_shift(2,"i"),i=e.read_shift(1),c=e.read_shift(1),l=e.read_shift(1);switch(e.l++,a){case 0:t.auto=1;break;case 1:t.index=s;var f=qt[s];f&&(t.rgb=Qa(f));break;case 2:t.rgb=Qa([i,c,l]);break;case 3:t.theme=s;break}return n!=0&&(t.tint=n>0?n/32767:n/32768),t}function Ps(e,t){if(t||(t=Y(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var a=e.rgb||"FFFFFF";typeof a=="number"&&(a=("000000"+a.toString(16)).slice(-6)),t.write_shift(1,parseInt(a.slice(0,2),16)),t.write_shift(1,parseInt(a.slice(2,4),16)),t.write_shift(1,parseInt(a.slice(4,6),16)),t.write_shift(1,255)}return t}function bf(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function Ef(e,t){t||(t=Y(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}function bc(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},a=e.read_shift(4);switch(a){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(a>400)throw new Error("Unsupported Clipboard: "+a.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function Sf(e){return bc(e,1)}function Tf(e){return bc(e,2)}var r0=2,zr=3,ws=11,Y0=12,Bs=19,ks=64,Nf=65,Ff=71,Cf=4108,Af=4126,Sr=80,Ec=81,jf=[Sr,Ec],Tn={1:{n:"CodePage",t:r0},2:{n:"Category",t:Sr},3:{n:"PresentationFormat",t:Sr},4:{n:"ByteCount",t:zr},5:{n:"LineCount",t:zr},6:{n:"ParagraphCount",t:zr},7:{n:"SlideCount",t:zr},8:{n:"NoteCount",t:zr},9:{n:"HiddenCount",t:zr},10:{n:"MultimediaClipCount",t:zr},11:{n:"ScaleCrop",t:ws},12:{n:"HeadingPairs",t:Cf},13:{n:"TitlesOfParts",t:Af},14:{n:"Manager",t:Sr},15:{n:"Company",t:Sr},16:{n:"LinksUpToDate",t:ws},17:{n:"CharacterCount",t:zr},19:{n:"SharedDoc",t:ws},22:{n:"HyperlinksChanged",t:ws},23:{n:"AppVersion",t:zr,p:"version"},24:{n:"DigSig",t:Nf},26:{n:"ContentType",t:Sr},27:{n:"ContentStatus",t:Sr},28:{n:"Language",t:Sr},29:{n:"Version",t:Sr},255:{},2147483648:{n:"Locale",t:Bs},2147483651:{n:"Behavior",t:Bs},1919054434:{}},Nn={1:{n:"CodePage",t:r0},2:{n:"Title",t:Sr},3:{n:"Subject",t:Sr},4:{n:"Author",t:Sr},5:{n:"Keywords",t:Sr},6:{n:"Comments",t:Sr},7:{n:"Template",t:Sr},8:{n:"LastAuthor",t:Sr},9:{n:"RevNumber",t:Sr},10:{n:"EditTime",t:ks},11:{n:"LastPrinted",t:ks},12:{n:"CreatedDate",t:ks},13:{n:"ModifiedDate",t:ks},14:{n:"PageCount",t:zr},15:{n:"WordCount",t:zr},16:{n:"CharCount",t:zr},17:{n:"Thumbnail",t:Ff},18:{n:"Application",t:Sr},19:{n:"DocSecurity",t:zr},255:{},2147483648:{n:"Locale",t:Bs},2147483651:{n:"Behavior",t:Bs},1919054434:{}},J0={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},Df=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function If(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var Of=If([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),qt=ir(Of),It={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},Sc={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Fn={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},_s={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function t0(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function Lf(e){var t=t0();if(!e||!e.match)return t;var r={};if((e.match(Br)||[]).forEach(function(a){var s=Me(a);switch(s[0].replace($l,"<")){case"<?xml":break;case"<Types":t.xmlns=s["xmlns"+(s[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[s.Extension]=s.ContentType;break;case"<Override":t[Fn[s.ContentType]]!==void 0&&t[Fn[s.ContentType]].push(s.PartName);break}}),t.xmlns!==yr.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}function Tc(e,t){var r=Ol(Fn),a=[],s;a[a.length]=vr,a[a.length]=xe("Types",null,{xmlns:yr.CT,"xmlns:xsd":yr.xsd,"xmlns:xsi":yr.xsi}),a=a.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(l){return xe("Default",null,{Extension:l[0],ContentType:l[1]})}));var n=function(l){e[l]&&e[l].length>0&&(s=e[l][0],a[a.length]=xe("Override",null,{PartName:(s[0]=="/"?"":"/")+s,ContentType:_s[l][t.bookType]||_s[l].xlsx}))},i=function(l){(e[l]||[]).forEach(function(f){a[a.length]=xe("Override",null,{PartName:(f[0]=="/"?"":"/")+f,ContentType:_s[l][t.bookType]||_s[l].xlsx})})},c=function(l){(e[l]||[]).forEach(function(f){a[a.length]=xe("Override",null,{PartName:(f[0]=="/"?"":"/")+f,ContentType:r[l][0]})})};return n("workbooks"),i("sheets"),i("charts"),c("themes"),["strs","styles"].forEach(n),["coreprops","extprops","custprops"].forEach(c),c("vba"),c("comments"),c("threadedcomments"),c("drawings"),i("metadata"),c("people"),a.length>2&&(a[a.length]="</Types>",a[1]=a[1].replace("/>",">")),a.join("")}var ze={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Za(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Wa(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var a={};return(e.match(Br)||[]).forEach(function(s){var n=Me(s);if(n[0]==="<Relationship"){var i={};i.Type=n.Type,i.Target=n.Target,i.Id=n.Id,n.TargetMode&&(i.TargetMode=n.TargetMode);var c=n.TargetMode==="External"?n.Target:Ma(n.Target,t);r[c]=i,a[n.Id]=i}}),r["!id"]=a,r}function ka(e){var t=[vr,xe("Relationships",null,{xmlns:yr.RELS})];return mr(e["!id"]).forEach(function(r){t[t.length]=xe("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function Qe(e,t,r,a,s,n){if(s||(s={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,s.Id="rId"+t,s.Type=a,s.Target=r,[ze.HLINK,ze.XPATH,ze.XMISS].indexOf(s.Type)>-1&&(s.TargetMode="External"),e["!id"][s.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][s.Id]=s,e[("/"+s.Target).replace("//","/")]=s,t}var Rf="application/vnd.oasis.opendocument.spreadsheet";function Mf(e,t){for(var r=Gn(e),a,s;a=qa.exec(r);)switch(a[3]){case"manifest":break;case"file-entry":if(s=Me(a[0],!1),s.path=="/"&&s.type!==Rf)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw a}}function Pf(e){var t=[vr];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function q0(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function Bf(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function Uf(e){var t=[vr];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(q0(e[r][0],e[r][1])),t.push(Bf("",e[r][0]));return t.push(q0("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function Nc(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+js.version+"</meta:generator></office:meta></office:document-meta>"}var it=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],Wf=function(){for(var e=new Array(it.length),t=0;t<it.length;++t){var r=it[t],a="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+a+"[^>]*>([\\s\\S]*?)</"+a+">")}return e}();function Fc(e){var t={};e=rr(e);for(var r=0;r<it.length;++r){var a=it[r],s=e.match(Wf[r]);s!=null&&s.length>0&&(t[a[1]]=Ge(s[1])),a[2]==="date"&&t[a[1]]&&(t[a[1]]=nr(t[a[1]]))}return t}function cn(e,t,r,a,s){s[e]!=null||t==null||t===""||(s[e]=t,t=er(t),a[a.length]=r?xe(e,t,r):Ar(e,t))}function Cc(e,t){var r=t||{},a=[vr,xe("cp:coreProperties",null,{"xmlns:cp":yr.CORE_PROPS,"xmlns:dc":yr.dc,"xmlns:dcterms":yr.dcterms,"xmlns:dcmitype":yr.dcmitype,"xmlns:xsi":yr.xsi})],s={};if(!e&&!r.Props)return a.join("");e&&(e.CreatedDate!=null&&cn("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:En(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},a,s),e.ModifiedDate!=null&&cn("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:En(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},a,s));for(var n=0;n!=it.length;++n){var i=it[n],c=r.Props&&r.Props[i[1]]!=null?r.Props[i[1]]:e?e[i[1]]:null;c===!0?c="1":c===!1?c="0":typeof c=="number"&&(c=String(c)),c!=null&&cn(i[0],c,null,a,s)}return a.length>2&&(a[a.length]="</cp:coreProperties>",a[1]=a[1].replace("/>",">")),a.join("")}var Zt=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],Ac=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function jc(e,t,r,a){var s=[];if(typeof e=="string")s=W0(e,a);else for(var n=0;n<e.length;++n)s=s.concat(e[n].map(function(d){return{v:d}}));var i=typeof t=="string"?W0(t,a).map(function(d){return d.v}):t,c=0,l=0;if(i.length>0)for(var f=0;f!==s.length;f+=2){switch(l=+s[f+1].v,s[f].v){case"Worksheets":case"工作表":case"Листы":case"أوراق العمل":case"ワークシート":case"גליונות עבודה":case"Arbeitsblätter":case"Çalışma Sayfaları":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de cálculo":case"Planilhas":case"Regneark":case"Hojas de cálculo":case"Werkbladen":r.Worksheets=l,r.SheetNames=i.slice(c,c+l);break;case"Named Ranges":case"Rangos con nombre":case"名前付き一覧":case"Benannte Bereiche":case"Navngivne områder":r.NamedRanges=l,r.DefinedNames=i.slice(c,c+l);break;case"Charts":case"Diagramme":r.Chartsheets=l,r.ChartNames=i.slice(c,c+l);break}c+=l}}function Hf(e,t,r){var a={};return t||(t={}),e=rr(e),Zt.forEach(function(s){var n=(e.match(Ya(s[0]))||[])[1];switch(s[2]){case"string":n&&(t[s[1]]=Ge(n));break;case"bool":t[s[1]]=n==="true";break;case"raw":var i=e.match(new RegExp("<"+s[0]+"[^>]*>([\\s\\S]*?)</"+s[0]+">"));i&&i.length>0&&(a[s[1]]=i[1]);break}}),a.HeadingPairs&&a.TitlesOfParts&&jc(a.HeadingPairs,a.TitlesOfParts,t,r),t}function Dc(e){var t=[],r=xe;return e||(e={}),e.Application="SheetJS",t[t.length]=vr,t[t.length]=xe("Properties",null,{xmlns:yr.EXT_PROPS,"xmlns:vt":yr.vt}),Zt.forEach(function(a){if(e[a[1]]!==void 0){var s;switch(a[2]){case"string":s=er(String(e[a[1]]));break;case"bool":s=e[a[1]]?"true":"false";break}s!==void 0&&(t[t.length]=r(a[0],s))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(a){return"<vt:lpstr>"+er(a)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var Vf=/<[^>]+>[^<]*/g;function $f(e,t){var r={},a="",s=e.match(Vf);if(s)for(var n=0;n!=s.length;++n){var i=s[n],c=Me(i);switch(c[0]){case"<?xml":break;case"<Properties":break;case"<property":a=Ge(c.name);break;case"</property>":a=null;break;default:if(i.indexOf("<vt:")===0){var l=i.split(">"),f=l[0].slice(4),d=l[1];switch(f){case"lpstr":case"bstr":case"lpwstr":r[a]=Ge(d);break;case"bool":r[a]=sr(d);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[a]=parseInt(d,10);break;case"r4":case"r8":case"decimal":r[a]=parseFloat(d);break;case"filetime":case"date":r[a]=nr(d);break;case"cy":case"error":r[a]=Ge(d);break;default:if(f.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",i,f,l)}}else if(i.slice(0,2)!=="</"){if(t.WTF)throw new Error(i)}}}return r}function Ic(e){var t=[vr,xe("Properties",null,{xmlns:yr.CUST_PROPS,"xmlns:vt":yr.vt})];if(!e)return t.join("");var r=1;return mr(e).forEach(function(s){++r,t[t.length]=xe("property",Zl(e[s]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:er(s)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var Cn={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},on;function zf(e,t,r){on||(on=Gs(Cn)),t=on[t]||t,e[t]=r}function Gf(e,t){var r=[];return mr(Cn).map(function(a){for(var s=0;s<it.length;++s)if(it[s][1]==a)return it[s];for(s=0;s<Zt.length;++s)if(Zt[s][1]==a)return Zt[s];throw a}).forEach(function(a){if(e[a[1]]!=null){var s=t&&t.Props&&t.Props[a[1]]!=null?t.Props[a[1]]:e[a[1]];switch(a[2]){case"date":s=new Date(s).toISOString().replace(/\.\d*Z/,"Z");break}typeof s=="number"?s=String(s):s===!0||s===!1?s=s?"1":"0":s instanceof Date&&(s=new Date(s).toISOString().replace(/\.\d*Z/,"")),r.push(Ar(Cn[a[1]]||a[1],s))}}),xe("DocumentProperties",r.join(""),{xmlns:Yr.o})}function Xf(e,t){var r=["Worksheets","SheetNames"],a="CustomDocumentProperties",s=[];return e&&mr(e).forEach(function(n){if(Object.prototype.hasOwnProperty.call(e,n)){for(var i=0;i<it.length;++i)if(n==it[i][1])return;for(i=0;i<Zt.length;++i)if(n==Zt[i][1])return;for(i=0;i<r.length;++i)if(n==r[i])return;var c=e[n],l="string";typeof c=="number"?(l="float",c=String(c)):c===!0||c===!1?(l="boolean",c=c?"1":"0"):c=String(c),s.push(xe(M0(n),c,{"dt:dt":l}))}}),t&&mr(t).forEach(function(n){if(Object.prototype.hasOwnProperty.call(t,n)&&!(e&&Object.prototype.hasOwnProperty.call(e,n))){var i=t[n],c="string";typeof i=="number"?(c="float",i=String(i)):i===!0||i===!1?(c="boolean",i=i?"1":"0"):i instanceof Date?(c="dateTime.tz",i=i.toISOString()):i=String(i),s.push(xe(M0(n),i,{"dt:dt":c}))}}),"<"+a+' xmlns="'+Yr.o+'">'+s.join("")+"</"+a+">"}function a0(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function Kf(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,a=r%Math.pow(2,32),s=(r-a)/Math.pow(2,32);a*=1e7,s*=1e7;var n=a/Math.pow(2,32)|0;n>0&&(a=a%Math.pow(2,32),s+=n);var i=Y(8);return i.write_shift(4,a),i.write_shift(4,s),i}function Oc(e,t,r){var a=e.l,s=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-a&3;)++e.l;return s}function Lc(e,t,r){var a=e.read_shift(0,"lpwstr");return a}function Rc(e,t,r){return t===31?Lc(e):Oc(e,t,r)}function An(e,t,r){return Rc(e,t,r===!1?0:4)}function Yf(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return Rc(e,t,0)}function Jf(e){for(var t=e.read_shift(4),r=[],a=0;a!=t;++a){var s=e.l;r[a]=e.read_shift(0,"lpwstr").replace(Vr,""),e.l-s&2&&(e.l+=2)}return r}function qf(e){for(var t=e.read_shift(4),r=[],a=0;a!=t;++a)r[a]=e.read_shift(0,"lpstr-cp").replace(Vr,"");return r}function Zf(e){var t=e.l,r=Us(e,Ec);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var a=Us(e,zr);return[r,a]}function Qf(e){for(var t=e.read_shift(4),r=[],a=0;a<t/2;++a)r.push(Zf(e));return r}function Z0(e,t){for(var r=e.read_shift(4),a={},s=0;s!=r;++s){var n=e.read_shift(4),i=e.read_shift(4);a[n]=e.read_shift(i,t===1200?"utf16le":"utf8").replace(Vr,"").replace(Ra,"!"),t===1200&&i%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),a}function Mc(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function ed(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function Us(e,t,r){var a=e.read_shift(2),s,n=r||{};if(e.l+=2,t!==Y0&&a!==t&&jf.indexOf(t)===-1&&!((t&65534)==4126&&(a&65534)==4126))throw new Error("Expected type "+t+" saw "+a);switch(t===Y0?a:t){case 2:return s=e.read_shift(2,"i"),n.raw||(e.l+=2),s;case 3:return s=e.read_shift(4,"i"),s;case 11:return e.read_shift(4)!==0;case 19:return s=e.read_shift(4),s;case 30:return Oc(e,a,4).replace(Vr,"");case 31:return Lc(e);case 64:return a0(e);case 65:return Mc(e);case 71:return ed(e);case 80:return An(e,a,!n.raw).replace(Vr,"");case 81:return Yf(e,a).replace(Vr,"");case 4108:return Qf(e);case 4126:case 4127:return a==4127?Jf(e):qf(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+a)}}function Q0(e,t){var r=Y(4),a=Y(4);switch(r.write_shift(4,e==80?31:e),e){case 3:a.write_shift(-4,t);break;case 5:a=Y(8),a.write_shift(8,t,"f");break;case 11:a.write_shift(4,t?1:0);break;case 64:a=Kf(t);break;case 31:case 80:for(a=Y(4+2*(t.length+1)+(t.length%2?0:2)),a.write_shift(4,t.length+1),a.write_shift(0,t,"dbcs");a.l!=a.length;)a.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return Tr([r,a])}function ei(e,t){var r=e.l,a=e.read_shift(4),s=e.read_shift(4),n=[],i=0,c=0,l=-1,f={};for(i=0;i!=s;++i){var d=e.read_shift(4),u=e.read_shift(4);n[i]=[d,u+r]}n.sort(function(b,w){return b[1]-w[1]});var h={};for(i=0;i!=s;++i){if(e.l!==n[i][1]){var m=!0;if(i>0&&t)switch(t[n[i-1][0]].t){case 2:e.l+2===n[i][1]&&(e.l+=2,m=!1);break;case 80:e.l<=n[i][1]&&(e.l=n[i][1],m=!1);break;case 4108:e.l<=n[i][1]&&(e.l=n[i][1],m=!1);break}if((!t||i==0)&&e.l<=n[i][1]&&(m=!1,e.l=n[i][1]),m)throw new Error("Read Error: Expected address "+n[i][1]+" at "+e.l+" :"+i)}if(t){var g=t[n[i][0]];if(h[g.n]=Us(e,g.t,{raw:!0}),g.p==="version"&&(h[g.n]=String(h[g.n]>>16)+"."+("0000"+String(h[g.n]&65535)).slice(-4)),g.n=="CodePage")switch(h[g.n]){case 0:h[g.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:ut(c=h[g.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+h[g.n])}}else if(n[i][0]===1){if(c=h.CodePage=Us(e,r0),ut(c),l!==-1){var x=e.l;e.l=n[l][1],f=Z0(e,c),e.l=x}}else if(n[i][0]===0){if(c===0){l=i,e.l=n[i+1][1];continue}f=Z0(e,c)}else{var p=f[n[i][0]],k;switch(e[e.l]){case 65:e.l+=4,k=Mc(e);break;case 30:e.l+=4,k=An(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,k=An(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,k=e.read_shift(4,"i");break;case 19:e.l+=4,k=e.read_shift(4);break;case 5:e.l+=4,k=e.read_shift(8,"f");break;case 11:e.l+=4,k=gr(e,4);break;case 64:e.l+=4,k=nr(a0(e));break;default:throw new Error("unparsed value: "+e[e.l])}h[p]=k}}return e.l=r+a,h}var Pc=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function rd(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function ri(e,t,r){var a=Y(8),s=[],n=[],i=8,c=0,l=Y(8),f=Y(8);if(l.write_shift(4,2),l.write_shift(4,1200),f.write_shift(4,1),n.push(l),s.push(f),i+=8+l.length,!t){f=Y(8),f.write_shift(4,0),s.unshift(f);var d=[Y(4)];for(d[0].write_shift(4,e.length),c=0;c<e.length;++c){var u=e[c][0];for(l=Y(8+2*(u.length+1)+(u.length%2?0:2)),l.write_shift(4,c+2),l.write_shift(4,u.length+1),l.write_shift(0,u,"dbcs");l.l!=l.length;)l.write_shift(1,0);d.push(l)}l=Tr(d),n.unshift(l),i+=8+l.length}for(c=0;c<e.length;++c)if(!(t&&!t[e[c][0]])&&!(Pc.indexOf(e[c][0])>-1||Ac.indexOf(e[c][0])>-1)&&e[c][1]!=null){var h=e[c][1],m=0;if(t){m=+t[e[c][0]];var g=r[m];if(g.p=="version"&&typeof h=="string"){var x=h.split(".");h=(+x[0]<<16)+(+x[1]||0)}l=Q0(g.t,h)}else{var p=rd(h);p==-1&&(p=31,h=String(h)),l=Q0(p,h)}n.push(l),f=Y(8),f.write_shift(4,t?m:2+c),s.push(f),i+=8+l.length}var k=8*(n.length+1);for(c=0;c<n.length;++c)s[c].write_shift(4,k),k+=n[c].length;return a.write_shift(4,i),a.write_shift(4,n.length),Tr([a].concat(s).concat(n))}function ti(e,t,r){var a=e.content;if(!a)return{};Cr(a,0);var s,n,i,c,l=0;a.chk("feff","Byte Order: "),a.read_shift(2);var f=a.read_shift(4),d=a.read_shift(16);if(d!==Ae.utils.consts.HEADER_CLSID&&d!==r)throw new Error("Bad PropertySet CLSID "+d);if(s=a.read_shift(4),s!==1&&s!==2)throw new Error("Unrecognized #Sets: "+s);if(n=a.read_shift(16),c=a.read_shift(4),s===1&&c!==a.l)throw new Error("Length mismatch: "+c+" !== "+a.l);s===2&&(i=a.read_shift(16),l=a.read_shift(4));var u=ei(a,t),h={SystemIdentifier:f};for(var m in u)h[m]=u[m];if(h.FMTID=n,s===1)return h;if(l-a.l==2&&(a.l+=2),a.l!==l)throw new Error("Length mismatch 2: "+a.l+" !== "+l);var g;try{g=ei(a,null)}catch{}for(m in g)h[m]=g[m];return h.FMTID=[n,i],h}function ai(e,t,r,a,s,n){var i=Y(s?68:48),c=[i];i.write_shift(2,65534),i.write_shift(2,0),i.write_shift(4,842412599),i.write_shift(16,Ae.utils.consts.HEADER_CLSID,"hex"),i.write_shift(4,s?2:1),i.write_shift(16,t,"hex"),i.write_shift(4,s?68:48);var l=ri(e,r,a);if(c.push(l),s){var f=ri(s,null,null);i.write_shift(16,n,"hex"),i.write_shift(4,68+l.length),c.push(f)}return Tr(c)}function Ot(e,t){return e.read_shift(t),null}function td(e,t){t||(t=Y(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function ad(e,t,r){for(var a=[],s=e.l+t;e.l<s;)a.push(r(e,s-e.l));if(s!==e.l)throw new Error("Slurp error");return a}function gr(e,t){return e.read_shift(t)===1}function Hr(e,t){return t||(t=Y(2)),t.write_shift(2,+!!e),t}function _r(e){return e.read_shift(2,"u")}function nt(e,t){return t||(t=Y(2)),t.write_shift(2,e),t}function Bc(e,t){return ad(e,t,_r)}function sd(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function Uc(e,t,r){return r||(r=Y(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function ds(e,t,r){var a=e.read_shift(r&&r.biff>=12?2:1),s="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var n=e.read_shift(1);n&&(s="dbcs-cont")}else r.biff==12&&(s="wstr");r.biff>=2&&r.biff<=5&&(s="cpstr");var i=a?e.read_shift(a,s):"";return i}function nd(e){var t=e.read_shift(2),r=e.read_shift(1),a=r&4,s=r&8,n=1+(r&1),i=0,c,l={};s&&(i=e.read_shift(2)),a&&(c=e.read_shift(4));var f=n==2?"dbcs-cont":"sbcs-cont",d=t===0?"":e.read_shift(t,f);return s&&(e.l+=4*i),a&&(e.l+=c),l.t=d,s||(l.raw="<t>"+l.t+"</t>",l.r=l.t),l}function id(e){var t=e.t||"",r=Y(3);r.write_shift(2,t.length),r.write_shift(1,1);var a=Y(2*t.length);a.write_shift(2*t.length,t,"utf16le");var s=[r,a];return Tr(s)}function sa(e,t,r){var a;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var s=e.read_shift(1);return s===0?a=e.read_shift(t,"sbcs-cont"):a=e.read_shift(t,"dbcs-cont"),a}function hs(e,t,r){var a=e.read_shift(r&&r.biff==2?1:2);return a===0?(e.l++,""):sa(e,a,r)}function ha(e,t,r){if(r.biff>5)return hs(e,t,r);var a=e.read_shift(1);return a===0?(e.l++,""):e.read_shift(a,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function Wc(e,t,r){return r||(r=Y(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function cd(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function od(e){var t=e.read_shift(4),r=e.l,a=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(a=!0),e.l=r);var s=e.read_shift((a?t-24:t)>>1,"utf16le").replace(Vr,"");return a&&(e.l+=24),s}function ld(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var a=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var s=e.read_shift(4);if(s===0)return r+a.replace(/\\/g,"/");var n=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var i=e.read_shift(n>>1,"utf16le").replace(Vr,"");return r+i}function fd(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return od(e);case"0303000000000000c000000000000046":return ld(e);default:throw new Error("Unsupported Moniker "+r)}}function ys(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(Vr,""):"";return r}function si(e,t){t||(t=Y(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function dd(e,t){var r=e.l+t,a=e.read_shift(4);if(a!==2)throw new Error("Unrecognized streamVersion: "+a);var s=e.read_shift(2);e.l+=2;var n,i,c,l,f="",d,u;s&16&&(n=ys(e,r-e.l)),s&128&&(i=ys(e,r-e.l)),(s&257)===257&&(c=ys(e,r-e.l)),(s&257)===1&&(l=fd(e,r-e.l)),s&8&&(f=ys(e,r-e.l)),s&32&&(d=e.read_shift(16)),s&64&&(u=a0(e)),e.l=r;var h=i||c||l||"";h&&f&&(h+="#"+f),h||(h="#"+f),s&2&&h.charAt(0)=="/"&&h.charAt(1)!="/"&&(h="file://"+h);var m={Target:h};return d&&(m.guid=d),u&&(m.time=u),n&&(m.Tooltip=n),m}function hd(e){var t=Y(512),r=0,a=e.Target;a.slice(0,7)=="file://"&&(a=a.slice(7));var s=a.indexOf("#"),n=s>-1?31:23;switch(a.charAt(0)){case"#":n=28;break;case".":n&=-3;break}t.write_shift(4,2),t.write_shift(4,n);var i=[8,6815827,6619237,4849780,83];for(r=0;r<i.length;++r)t.write_shift(4,i[r]);if(n==28)a=a.slice(1),si(a,t);else if(n&2){for(i="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<i.length;++r)t.write_shift(1,parseInt(i[r],16));var c=s>-1?a.slice(0,s):a;for(t.write_shift(4,2*(c.length+1)),r=0;r<c.length;++r)t.write_shift(2,c.charCodeAt(r));t.write_shift(2,0),n&8&&si(s>-1?a.slice(s+1):"",t)}else{for(i="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<i.length;++r)t.write_shift(1,parseInt(i[r],16));for(var l=0;a.slice(l*3,l*3+3)=="../"||a.slice(l*3,l*3+3)=="..\\";)++l;for(t.write_shift(2,l),t.write_shift(4,a.length-3*l+1),r=0;r<a.length-3*l;++r)t.write_shift(1,a.charCodeAt(r+3*l)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function Hc(e){var t=e.read_shift(1),r=e.read_shift(1),a=e.read_shift(1),s=e.read_shift(1);return[t,r,a,s]}function Vc(e,t){var r=Hc(e);return r[3]=0,r}function bt(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2);return{r:t,c:r,ixfe:a}}function na(e,t,r,a){return a||(a=Y(6)),a.write_shift(2,e),a.write_shift(2,t),a.write_shift(2,r||0),a}function ud(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function xd(e,t,r){return t===0?"":ha(e,t,r)}function md(e,t,r){var a=r.biff>8?4:2,s=e.read_shift(a),n=e.read_shift(a,"i"),i=e.read_shift(a,"i");return[s,n,i]}function $c(e){var t=e.read_shift(2),r=e0(e);return[t,r]}function gd(e,t,r){e.l+=4,t-=4;var a=e.l+t,s=ds(e,t,r),n=e.read_shift(2);if(a-=e.l,n!==a)throw new Error("Malformed AddinUdf: padding = "+a+" != "+n);return e.l+=n,s}function Ys(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2);return{s:{c:a,r:t},e:{c:s,r}}}function zc(e,t){return t||(t=Y(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function Gc(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(1),s=e.read_shift(1);return{s:{c:a,r:t},e:{c:s,r}}}var pd=Gc;function Xc(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2);return e.l+=12,[r,t,a]}function vd(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function wd(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function Dr(e){e.l+=2,e.l+=e.read_shift(2)}var kd={0:Dr,4:Dr,5:Dr,6:Dr,7:wd,8:Dr,9:Dr,10:Dr,11:Dr,12:Dr,13:vd,14:Dr,15:Dr,16:Dr,17:Dr,18:Dr,19:Dr,20:Dr,21:Xc};function _d(e,t){for(var r=e.l+t,a=[];e.l<r;){var s=e.read_shift(2);e.l-=2;try{a.push(kd[s](e,r-e.l))}catch{return e.l=r,a}}return e.l!=r&&(e.l=r),a}function bs(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function s0(e,t,r){var a=1536,s=16;switch(r.bookType){case"biff8":break;case"biff5":a=1280,s=8;break;case"biff4":a=4,s=6;break;case"biff3":a=3,s=6;break;case"biff2":a=2,s=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var n=Y(s);return n.write_shift(2,a),n.write_shift(2,t),s>4&&n.write_shift(2,29282),s>6&&n.write_shift(2,1997),s>8&&(n.write_shift(2,49161),n.write_shift(2,1),n.write_shift(2,1798),n.write_shift(2,0)),n}function yd(e,t){return t===0||e.read_shift(2),1200}function bd(e,t,r){if(r.enc)return e.l+=t,"";var a=e.l,s=ha(e,0,r);return e.read_shift(t+a-e.l),s}function Ed(e,t){var r=!t||t.biff==8,a=Y(r?112:54);for(a.write_shift(t.biff==8?2:1,7),r&&a.write_shift(1,0),a.write_shift(4,859007059),a.write_shift(4,5458548|(r?0:536870912));a.l<a.length;)a.write_shift(1,r?0:32);return a}function Sd(e,t,r){var a=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:a&16,fBelow:a&64,fRight:a&128}}function Td(e,t,r){var a=e.read_shift(4),s=e.read_shift(1)&3,n=e.read_shift(1);switch(n){case 0:n="Worksheet";break;case 1:n="Macrosheet";break;case 2:n="Chartsheet";break;case 6:n="VBAModule";break}var i=ds(e,0,r);return i.length===0&&(i="Sheet1"),{pos:a,hs:s,dt:n,name:i}}function Nd(e,t){var r=!t||t.biff>=8?2:1,a=Y(8+r*e.name.length);a.write_shift(4,e.pos),a.write_shift(1,e.hs||0),a.write_shift(1,e.dt),a.write_shift(1,e.name.length),t.biff>=8&&a.write_shift(1,1),a.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var s=a.slice(0,a.l);return s.l=a.l,s}function Fd(e,t){for(var r=e.l+t,a=e.read_shift(4),s=e.read_shift(4),n=[],i=0;i!=s&&e.l<r;++i)n.push(nd(e));return n.Count=a,n.Unique=s,n}function Cd(e,t){var r=Y(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var a=[],s=0;s<e.length;++s)a[s]=id(e[s]);var n=Tr([r].concat(a));return n.parts=[r.length].concat(a.map(function(i){return i.length})),n}function Ad(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function jd(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var a=e.read_shift(1);return e.l+=3,a&7&&(t.level=a&7),a&32&&(t.hidden=!0),a&64&&(t.hpt=r/20),t}function Dd(e){var t=ud(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function Id(e){return e.read_shift(2),e.read_shift(4)}function ni(e,t,r){var a=0;r&&r.biff==2||(a=e.read_shift(2));var s=e.read_shift(2);r&&r.biff==2&&(a=1-(s>>15),s&=32767);var n={Unsynced:a&1,DyZero:(a&2)>>1,ExAsc:(a&4)>>2,ExDsc:(a&8)>>3};return[n,s]}function Od(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2),c=e.read_shift(2),l=e.read_shift(2),f=e.read_shift(2);return{Pos:[t,r],Dim:[a,s],Flags:n,CurTab:i,FirstTab:c,Selected:l,TabRatio:f}}function Ld(){var e=Y(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function Rd(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var a=e.read_shift(2);return{RTL:a&64}}function Md(e){var t=Y(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function Pd(){}function Bd(e,t,r){var a={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return a.name=ds(e,0,r),a}function Ud(e,t){var r=e.name||"Arial",a=t&&t.biff==5,s=a?15+r.length:16+2*r.length,n=Y(s);return n.write_shift(2,e.sz*20),n.write_shift(4,0),n.write_shift(2,400),n.write_shift(4,0),n.write_shift(2,0),n.write_shift(1,r.length),a||n.write_shift(1,1),n.write_shift((a?1:2)*r.length,r,a?"sbcs":"utf16le"),n}function Wd(e){var t=bt(e);return t.isst=e.read_shift(4),t}function Hd(e,t,r,a){var s=Y(10);return na(e,t,a,s),s.write_shift(4,r),s}function Vd(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var a=e.l+t,s=bt(e);r.biff==2&&e.l++;var n=hs(e,a-e.l,r);return s.val=n,s}function $d(e,t,r,a,s){var n=!s||s.biff==8,i=Y(8+ +n+(1+n)*r.length);return na(e,t,a,i),i.write_shift(2,r.length),n&&i.write_shift(1,1),i.write_shift((1+n)*r.length,r,n?"utf16le":"sbcs"),i}function zd(e,t,r){var a=e.read_shift(2),s=ha(e,0,r);return[a,s]}function Gd(e,t,r,a){var s=r&&r.biff==5;a||(a=Y(s?3+t.length:5+2*t.length)),a.write_shift(2,e),a.write_shift(s?1:2,t.length),s||a.write_shift(1,1),a.write_shift((s?1:2)*t.length,t,s?"sbcs":"utf16le");var n=a.length>a.l?a.slice(0,a.l):a;return n.l==null&&(n.l=n.length),n}var Xd=ha;function ii(e,t,r){var a=e.l+t,s=r.biff==8||!r.biff?4:2,n=e.read_shift(s),i=e.read_shift(s),c=e.read_shift(2),l=e.read_shift(2);return e.l=a,{s:{r:n,c},e:{r:i,c:l}}}function Kd(e,t){var r=t.biff==8||!t.biff?4:2,a=Y(2*r+6);return a.write_shift(r,e.s.r),a.write_shift(r,e.e.r+1),a.write_shift(2,e.s.c),a.write_shift(2,e.e.c+1),a.write_shift(2,0),a}function Yd(e){var t=e.read_shift(2),r=e.read_shift(2),a=$c(e);return{r:t,c:r,ixfe:a[0],rknum:a[1]}}function Jd(e,t){for(var r=e.l+t-2,a=e.read_shift(2),s=e.read_shift(2),n=[];e.l<r;)n.push($c(e));if(e.l!==r)throw new Error("MulRK read error");var i=e.read_shift(2);if(n.length!=i-s+1)throw new Error("MulRK length mismatch");return{r:a,c:s,C:i,rkrec:n}}function qd(e,t){for(var r=e.l+t-2,a=e.read_shift(2),s=e.read_shift(2),n=[];e.l<r;)n.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var i=e.read_shift(2);if(n.length!=i-s+1)throw new Error("MulBlank length mismatch");return{r:a,c:s,C:i,ixfe:n}}function Zd(e,t,r,a){var s={},n=e.read_shift(4),i=e.read_shift(4),c=e.read_shift(4),l=e.read_shift(2);return s.patternType=Df[c>>26],a.cellStyles&&(s.alc=n&7,s.fWrap=n>>3&1,s.alcV=n>>4&7,s.fJustLast=n>>7&1,s.trot=n>>8&255,s.cIndent=n>>16&15,s.fShrinkToFit=n>>20&1,s.iReadOrder=n>>22&2,s.fAtrNum=n>>26&1,s.fAtrFnt=n>>27&1,s.fAtrAlc=n>>28&1,s.fAtrBdr=n>>29&1,s.fAtrPat=n>>30&1,s.fAtrProt=n>>31&1,s.dgLeft=i&15,s.dgRight=i>>4&15,s.dgTop=i>>8&15,s.dgBottom=i>>12&15,s.icvLeft=i>>16&127,s.icvRight=i>>23&127,s.grbitDiag=i>>30&3,s.icvTop=c&127,s.icvBottom=c>>7&127,s.icvDiag=c>>14&127,s.dgDiag=c>>21&15,s.icvFore=l&127,s.icvBack=l>>7&127,s.fsxButton=l>>14&1),s}function Qd(e,t,r){var a={};return a.ifnt=e.read_shift(2),a.numFmtId=e.read_shift(2),a.flags=e.read_shift(2),a.fStyle=a.flags>>2&1,t-=6,a.data=Zd(e,t,a.fStyle,r),a}function ci(e,t,r,a){var s=r&&r.biff==5;a||(a=Y(s?16:20)),a.write_shift(2,0),e.style?(a.write_shift(2,e.numFmtId||0),a.write_shift(2,65524)):(a.write_shift(2,e.numFmtId||0),a.write_shift(2,t<<4));var n=0;return e.numFmtId>0&&s&&(n|=1024),a.write_shift(4,n),a.write_shift(4,0),s||a.write_shift(4,0),a.write_shift(2,0),a}function eh(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function rh(e){var t=Y(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function oi(e,t,r){var a=bt(e);(r.biff==2||t==9)&&++e.l;var s=sd(e);return a.val=s,a.t=s===!0||s===!1?"b":"e",a}function th(e,t,r,a,s,n){var i=Y(8);return na(e,t,a,i),Uc(r,n,i),i}function ah(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var a=bt(e),s=Rr(e);return a.val=s,a}function sh(e,t,r,a){var s=Y(14);return na(e,t,a,s),aa(r,s),s}var li=xd;function nh(e,t,r){var a=e.l+t,s=e.read_shift(2),n=e.read_shift(2);if(r.sbcch=n,n==1025||n==14849)return[n,s];if(n<1||n>255)throw new Error("Unexpected SupBook type: "+n);for(var i=sa(e,n),c=[];a>e.l;)c.push(hs(e));return[n,s,i,c]}function fi(e,t,r){var a=e.read_shift(2),s,n={fBuiltIn:a&1,fWantAdvise:a>>>1&1,fWantPict:a>>>2&1,fOle:a>>>3&1,fOleLink:a>>>4&1,cf:a>>>5&1023,fIcon:a>>>15&1};return r.sbcch===14849&&(s=gd(e,t-2,r)),n.body=s||e.read_shift(t-2),typeof s=="string"&&(n.Name=s),n}var ih=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function di(e,t,r){var a=e.l+t,s=e.read_shift(2),n=e.read_shift(1),i=e.read_shift(1),c=e.read_shift(r&&r.biff==2?1:2),l=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),l=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var f=sa(e,i,r);s&32&&(f=ih[f.charCodeAt(0)]);var d=a-e.l;r&&r.biff==2&&--d;var u=a==e.l||c===0||!(d>0)?[]:_m(e,d,r,c);return{chKey:n,Name:f,itab:l,rgce:u}}function Kc(e,t,r){if(r.biff<8)return ch(e,t,r);for(var a=[],s=e.l+t,n=e.read_shift(r.biff>8?4:2);n--!==0;)a.push(md(e,r.biff>8?12:6,r));if(e.l!=s)throw new Error("Bad ExternSheet: "+e.l+" != "+s);return a}function ch(e,t,r){e[e.l+1]==3&&e[e.l]++;var a=ds(e,t,r);return a.charCodeAt(0)==3?a.slice(1):a}function oh(e,t,r){if(r.biff<8){e.l+=t;return}var a=e.read_shift(2),s=e.read_shift(2),n=sa(e,a,r),i=sa(e,s,r);return[n,i]}function lh(e,t,r){var a=Gc(e);e.l++;var s=e.read_shift(1);return t-=8,[ym(e,t,r),s,a]}function hi(e,t,r){var a=pd(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[a,wm(e,t,r)]}function fh(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,a=e.read_shift(4);return[t,r,a]}function dh(e,t,r){if(!(r.biff<8)){var a=e.read_shift(2),s=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2),c=ha(e,0,r);return r.biff<8&&e.read_shift(1),[{r:a,c:s},c,i,n]}}function hh(e,t,r){return dh(e,t,r)}function uh(e,t){for(var r=[],a=e.read_shift(2);a--;)r.push(Ys(e));return r}function xh(e){var t=Y(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)zc(e[r],t);return t}function mh(e,t,r){if(r&&r.biff<8)return ph(e,t,r);var a=Xc(e),s=_d(e,t-22,a[1]);return{cmo:a,ft:s}}var gh={8:function(e,t){var r=e.l+t;e.l+=10;var a=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var s=e.read_shift(1);return e.l+=s,e.l=r,{fmt:a}}};function ph(e,t,r){e.l+=4;var a=e.read_shift(2),s=e.read_shift(2),n=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var i=[];return i.push((gh[a]||Pr)(e,t,r)),{cmo:[s,a,n],ft:i}}function vh(e,t,r){var a=e.l,s="";try{e.l+=4;var n=(r.lastobj||{cmo:[0,0]}).cmo[1],i;[0,5,7,11,12,14].indexOf(n)==-1?e.l+=6:i=cd(e,6,r);var c=e.read_shift(2);e.read_shift(2),_r(e,2);var l=e.read_shift(2);e.l+=l;for(var f=1;f<e.lens.length-1;++f){if(e.l-a!=e.lens[f])throw new Error("TxO: bad continue record");var d=e[e.l],u=sa(e,e.lens[f+1]-e.lens[f]-1);if(s+=u,s.length>=(d?c:2*c))break}if(s.length!==c&&s.length!==c*2)throw new Error("cchText: "+c+" != "+s.length);return e.l=a+t,{t:s}}catch{return e.l=a+t,{t:s}}}function wh(e,t){var r=Ys(e);e.l+=16;var a=dd(e,t-24);return[r,a]}function kh(e){var t=Y(24),r=dr(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var a="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),s=0;s<16;++s)t.write_shift(1,parseInt(a[s],16));return Tr([t,hd(e[1])])}function _h(e,t){e.read_shift(2);var r=Ys(e),a=e.read_shift((t-10)/2,"dbcs-cont");return a=a.replace(Vr,""),[r,a]}function yh(e){var t=e[1].Tooltip,r=Y(10+2*(t.length+1));r.write_shift(2,2048);var a=dr(e[0]);r.write_shift(2,a.r),r.write_shift(2,a.r),r.write_shift(2,a.c),r.write_shift(2,a.c);for(var s=0;s<t.length;++s)r.write_shift(2,t.charCodeAt(s));return r.write_shift(2,0),r}function bh(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=J0[r]||r,r=e.read_shift(2),t[1]=J0[r]||r,t}function Eh(e){return e||(e=Y(4)),e.write_shift(2,1),e.write_shift(2,1),e}function Sh(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(Vc(e));return r}function Th(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(Vc(e));return r}function Nh(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function Yc(e,t,r){if(!r.cellStyles)return Pr(e,t);var a=r&&r.biff>=12?4:2,s=e.read_shift(a),n=e.read_shift(a),i=e.read_shift(a),c=e.read_shift(a),l=e.read_shift(2);a==2&&(e.l+=2);var f={s,e:n,w:i,ixfe:c,flags:l};return(r.biff>=5||!r.biff)&&(f.level=l>>8&7),f}function Fh(e,t){var r=Y(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var a=0;return e.hidden&&(a|=1),r.write_shift(1,a),a=e.level||0,r.write_shift(1,a),r.write_shift(2,0),r}function Ch(e,t){var r={};return t<32||(e.l+=16,r.header=Rr(e),r.footer=Rr(e),e.l+=2),r}function Ah(e,t,r){var a={area:!1};if(r.biff!=5)return e.l+=t,a;var s=e.read_shift(1);return e.l+=3,s&16&&(a.area=!0),a}function jh(e){for(var t=Y(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}var Dh=bt,Ih=Bc,Oh=hs;function Lh(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(4),s={fmt:t,env:r,len:a,data:e.slice(e.l,e.l+a)};return e.l+=a,s}function Rh(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var a=bt(e);++e.l;var s=ha(e,t-7,r);return a.t="str",a.val=s,a}function Mh(e){var t=bt(e);++e.l;var r=Rr(e);return t.t="n",t.val=r,t}function Ph(e,t,r){var a=Y(15);return gs(a,e,t),a.write_shift(8,r,"f"),a}function Bh(e){var t=bt(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function Uh(e,t,r){var a=Y(9);return gs(a,e,t),a.write_shift(2,r),a}function Wh(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function Hh(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function Vh(e,t,r){var a=e.l+t,s=bt(e),n=e.read_shift(2),i=sa(e,n,r);return e.l=a,s.t="str",s.val=i,s}var $h=[2,3,48,49,131,139,140,245],jn=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=Gs({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(c,l){var f=[],d=Pt(1);switch(l.type){case"base64":d=qr(Qr(c));break;case"binary":d=qr(c);break;case"buffer":case"array":d=c;break}Cr(d,0);var u=d.read_shift(1),h=!!(u&136),m=!1,g=!1;switch(u){case 2:break;case 3:break;case 48:m=!0,h=!0;break;case 49:m=!0,h=!0;break;case 131:break;case 139:break;case 140:g=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+u.toString(16))}var x=0,p=521;u==2&&(x=d.read_shift(2)),d.l+=3,u!=2&&(x=d.read_shift(4)),x>1048576&&(x=1e6),u!=2&&(p=d.read_shift(2));var k=d.read_shift(2),b=l.codepage||1252;u!=2&&(d.l+=16,d.read_shift(1),d[d.l]!==0&&(b=e[d[d.l]]),d.l+=1,d.l+=2),g&&(d.l+=36);for(var w=[],j={},R=Math.min(d.length,u==2?521:p-10-(m?264:0)),I=g?32:11;d.l<R&&d[d.l]!=13;)switch(j={},j.name=Ga.utils.decode(b,d.slice(d.l,d.l+I)).replace(/[\u0000\r\n].*$/g,""),d.l+=I,j.type=String.fromCharCode(d.read_shift(1)),u!=2&&!g&&(j.offset=d.read_shift(4)),j.len=d.read_shift(1),u==2&&(j.offset=d.read_shift(2)),j.dec=d.read_shift(1),j.name.length&&w.push(j),u!=2&&(d.l+=g?13:14),j.type){case"B":(!m||j.len!=8)&&l.WTF&&console.log("Skipping "+j.name+":"+j.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+j.name+":"+j.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+j.type)}if(d[d.l]!==13&&(d.l=p-1),d.read_shift(1)!==13)throw new Error("DBF Terminator not found "+d.l+" "+d[d.l]);d.l=p;var E=0,U=0;for(f[0]=[],U=0;U!=w.length;++U)f[0][U]=w[U].name;for(;x-- >0;){if(d[d.l]===42){d.l+=k;continue}for(++d.l,f[++E]=[],U=0,U=0;U!=w.length;++U){var N=d.slice(d.l,d.l+w[U].len);d.l+=w[U].len,Cr(N,0);var B=Ga.utils.decode(b,N);switch(w[U].type){case"C":B.trim().length&&(f[E][U]=B.replace(/\s+$/,""));break;case"D":B.length===8?f[E][U]=new Date(+B.slice(0,4),+B.slice(4,6)-1,+B.slice(6,8)):f[E][U]=B;break;case"F":f[E][U]=parseFloat(B.trim());break;case"+":case"I":f[E][U]=g?N.read_shift(-4,"i")^2147483648:N.read_shift(4,"i");break;case"L":switch(B.trim().toUpperCase()){case"Y":case"T":f[E][U]=!0;break;case"N":case"F":f[E][U]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+B+"|")}break;case"M":if(!h)throw new Error("DBF Unexpected MEMO for type "+u.toString(16));f[E][U]="##MEMO##"+(g?parseInt(B.trim(),10):N.read_shift(4));break;case"N":B=B.replace(/\u0000/g,"").trim(),B&&B!="."&&(f[E][U]=+B||0);break;case"@":f[E][U]=new Date(N.read_shift(-8,"f")-621356832e5);break;case"T":f[E][U]=new Date((N.read_shift(4)-2440588)*864e5+N.read_shift(4));break;case"Y":f[E][U]=N.read_shift(4,"i")/1e4+N.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":f[E][U]=-N.read_shift(-8,"f");break;case"B":if(m&&w[U].len==8){f[E][U]=N.read_shift(8,"f");break}case"G":case"P":N.l+=w[U].len;break;case"0":if(w[U].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+w[U].type)}}}if(u!=2&&d.l<d.length&&d[d.l++]!=26)throw new Error("DBF EOF Marker missing "+(d.l-1)+" of "+d.length+" "+d[d.l-1].toString(16));return l&&l.sheetRows&&(f=f.slice(0,l.sheetRows)),l.DBF=w,f}function a(c,l){var f=l||{};f.dateNF||(f.dateNF="yyyymmdd");var d=Ca(r(c,f),f);return d["!cols"]=f.DBF.map(function(u){return{wch:u.len,DBF:u}}),delete f.DBF,d}function s(c,l){try{return Vt(a(c,l),l)}catch(f){if(l&&l.WTF)throw f}return{SheetNames:[],Sheets:{}}}var n={B:8,C:250,L:1,D:8,"?":0,"":0};function i(c,l){var f=l||{};if(+f.codepage>=0&&ut(+f.codepage),f.type=="string")throw new Error("Cannot write DBF to JS string");var d=Gr(),u=Vs(c,{header:1,raw:!0,cellDates:!0}),h=u[0],m=u.slice(1),g=c["!cols"]||[],x=0,p=0,k=0,b=1;for(x=0;x<h.length;++x){if(((g[x]||{}).DBF||{}).name){h[x]=g[x].DBF.name,++k;continue}if(h[x]!=null){if(++k,typeof h[x]=="number"&&(h[x]=h[x].toString(10)),typeof h[x]!="string")throw new Error("DBF Invalid column name "+h[x]+" |"+typeof h[x]+"|");if(h.indexOf(h[x])!==x){for(p=0;p<1024;++p)if(h.indexOf(h[x]+"_"+p)==-1){h[x]+="_"+p;break}}}}var w=Xe(c["!ref"]),j=[],R=[],I=[];for(x=0;x<=w.e.c-w.s.c;++x){var E="",U="",N=0,B=[];for(p=0;p<m.length;++p)m[p][x]!=null&&B.push(m[p][x]);if(B.length==0||h[x]==null){j[x]="?";continue}for(p=0;p<B.length;++p){switch(typeof B[p]){case"number":U="B";break;case"string":U="C";break;case"boolean":U="L";break;case"object":U=B[p]instanceof Date?"D":"C";break;default:U="C"}N=Math.max(N,String(B[p]).length),E=E&&E!=U?"C":U}N>250&&(N=250),U=((g[x]||{}).DBF||{}).type,U=="C"&&g[x].DBF.len>N&&(N=g[x].DBF.len),E=="B"&&U=="N"&&(E="N",I[x]=g[x].DBF.dec,N=g[x].DBF.len),R[x]=E=="C"||U=="N"?N:n[E]||0,b+=R[x],j[x]=E}var L=d.next(32);for(L.write_shift(4,318902576),L.write_shift(4,m.length),L.write_shift(2,296+32*k),L.write_shift(2,b),x=0;x<4;++x)L.write_shift(4,0);for(L.write_shift(4,0|(+t[Pi]||3)<<8),x=0,p=0;x<h.length;++x)if(h[x]!=null){var P=d.next(32),Q=(h[x].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);P.write_shift(1,Q,"sbcs"),P.write_shift(1,j[x]=="?"?"C":j[x],"sbcs"),P.write_shift(4,p),P.write_shift(1,R[x]||n[j[x]]||0),P.write_shift(1,I[x]||0),P.write_shift(1,2),P.write_shift(4,0),P.write_shift(1,0),P.write_shift(4,0),P.write_shift(4,0),p+=R[x]||n[j[x]]||0}var fe=d.next(264);for(fe.write_shift(4,13),x=0;x<65;++x)fe.write_shift(4,0);for(x=0;x<m.length;++x){var ie=d.next(b);for(ie.write_shift(1,0),p=0;p<h.length;++p)if(h[p]!=null)switch(j[p]){case"L":ie.write_shift(1,m[x][p]==null?63:m[x][p]?84:70);break;case"B":ie.write_shift(8,m[x][p]||0,"f");break;case"N":var pe="0";for(typeof m[x][p]=="number"&&(pe=m[x][p].toFixed(I[p]||0)),k=0;k<R[p]-pe.length;++k)ie.write_shift(1,32);ie.write_shift(1,pe,"sbcs");break;case"D":m[x][p]?(ie.write_shift(4,("0000"+m[x][p].getFullYear()).slice(-4),"sbcs"),ie.write_shift(2,("00"+(m[x][p].getMonth()+1)).slice(-2),"sbcs"),ie.write_shift(2,("00"+m[x][p].getDate()).slice(-2),"sbcs")):ie.write_shift(8,"00000000","sbcs");break;case"C":var he=String(m[x][p]!=null?m[x][p]:"").slice(0,R[p]);for(ie.write_shift(1,he,"sbcs"),k=0;k<R[p]-he.length;++k)ie.write_shift(1,32);break}}return d.next(1).write_shift(1,26),d.end()}return{to_workbook:s,to_sheet:a,from_sheet:i}}(),Jc=function(){var e={AA:"À",BA:"Á",CA:"Â",DA:195,HA:"Ä",JA:197,AE:"È",BE:"É",CE:"Ê",HE:"Ë",AI:"Ì",BI:"Í",CI:"Î",HI:"Ï",AO:"Ò",BO:"Ó",CO:"Ô",DO:213,HO:"Ö",AU:"Ù",BU:"Ú",CU:"Û",HU:"Ü",Aa:"à",Ba:"á",Ca:"â",Da:227,Ha:"ä",Ja:229,Ae:"è",Be:"é",Ce:"ê",He:"ë",Ai:"ì",Bi:"í",Ci:"î",Hi:"ï",Ao:"ò",Bo:"ó",Co:"ô",Do:245,Ho:"ö",Au:"ù",Bu:"ú",Cu:"û",Hu:"ü",KC:"Ç",Kc:"ç",q:"æ",z:"œ",a:"Æ",j:"Œ",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+mr(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(h,m){var g=e[m];return typeof g=="number"?b0(g):g},a=function(h,m,g){var x=m.charCodeAt(0)-32<<4|g.charCodeAt(0)-48;return x==59?h:b0(x)};e["|"]=254;function s(h,m){switch(m.type){case"base64":return n(Qr(h),m);case"binary":return n(h,m);case"buffer":return n($e&&Buffer.isBuffer(h)?h.toString("binary"):Ht(h),m);case"array":return n(ta(h),m)}throw new Error("Unrecognized type "+m.type)}function n(h,m){var g=h.split(/[\n\r]+/),x=-1,p=-1,k=0,b=0,w=[],j=[],R=null,I={},E=[],U=[],N=[],B=0,L;for(+m.codepage>=0&&ut(+m.codepage);k!==g.length;++k){B=0;var P=g[k].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,a).replace(t,r),Q=P.replace(/;;/g,"\0").split(";").map(function(O){return O.replace(/\u0000/g,";")}),fe=Q[0],ie;if(P.length>0)switch(fe){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":Q[1].charAt(0)=="P"&&j.push(P.slice(3).replace(/;;/g,";"));break;case"C":var pe=!1,he=!1,Ve=!1,H=!1,we=-1,Ee=-1;for(b=1;b<Q.length;++b)switch(Q[b].charAt(0)){case"A":break;case"X":p=parseInt(Q[b].slice(1))-1,he=!0;break;case"Y":for(x=parseInt(Q[b].slice(1))-1,he||(p=0),L=w.length;L<=x;++L)w[L]=[];break;case"K":ie=Q[b].slice(1),ie.charAt(0)==='"'?ie=ie.slice(1,ie.length-1):ie==="TRUE"?ie=!0:ie==="FALSE"?ie=!1:isNaN(mt(ie))?isNaN(ba(ie).getDate())||(ie=nr(ie)):(ie=mt(ie),R!==null&&Na(R)&&(ie=Ks(ie))),pe=!0;break;case"E":H=!0;var A=_a(Q[b].slice(1),{r:x,c:p});w[x][p]=[w[x][p],A];break;case"S":Ve=!0,w[x][p]=[w[x][p],"S5S"];break;case"G":break;case"R":we=parseInt(Q[b].slice(1))-1;break;case"C":Ee=parseInt(Q[b].slice(1))-1;break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+P)}if(pe&&(w[x][p]&&w[x][p].length==2?w[x][p][0]=ie:w[x][p]=ie,R=null),Ve){if(H)throw new Error("SYLK shared formula cannot have own formula");var M=we>-1&&w[we][Ee];if(!M||!M[1])throw new Error("SYLK shared formula cannot find base");w[x][p][1]=mo(M[1],{r:x-we,c:p-Ee})}break;case"F":var D=0;for(b=1;b<Q.length;++b)switch(Q[b].charAt(0)){case"X":p=parseInt(Q[b].slice(1))-1,++D;break;case"Y":for(x=parseInt(Q[b].slice(1))-1,L=w.length;L<=x;++L)w[L]=[];break;case"M":B=parseInt(Q[b].slice(1))/20;break;case"F":break;case"G":break;case"P":R=j[parseInt(Q[b].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(N=Q[b].slice(1).split(" "),L=parseInt(N[0],10);L<=parseInt(N[1],10);++L)B=parseInt(N[2],10),U[L-1]=B===0?{hidden:!0}:{wch:B},Bt(U[L-1]);break;case"C":p=parseInt(Q[b].slice(1))-1,U[p]||(U[p]={});break;case"R":x=parseInt(Q[b].slice(1))-1,E[x]||(E[x]={}),B>0?(E[x].hpt=B,E[x].hpx=Sa(B)):B===0&&(E[x].hidden=!0);break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+P)}D<1&&(R=null);break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+P)}}return E.length>0&&(I["!rows"]=E),U.length>0&&(I["!cols"]=U),m&&m.sheetRows&&(w=w.slice(0,m.sheetRows)),[w,I]}function i(h,m){var g=s(h,m),x=g[0],p=g[1],k=Ca(x,m);return mr(p).forEach(function(b){k[b]=p[b]}),k}function c(h,m){return Vt(i(h,m),m)}function l(h,m,g,x){var p="C;Y"+(g+1)+";X"+(x+1)+";K";switch(h.t){case"n":p+=h.v||0,h.f&&!h.F&&(p+=";E"+f0(h.f,{r:g,c:x}));break;case"b":p+=h.v?"TRUE":"FALSE";break;case"e":p+=h.w||h.v;break;case"d":p+='"'+(h.w||h.v)+'"';break;case"s":p+='"'+h.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return p}function f(h,m){m.forEach(function(g,x){var p="F;W"+(x+1)+" "+(x+1)+" ";g.hidden?p+="0":(typeof g.width=="number"&&!g.wpx&&(g.wpx=es(g.width)),typeof g.wpx=="number"&&!g.wch&&(g.wch=rs(g.wpx)),typeof g.wch=="number"&&(p+=Math.round(g.wch))),p.charAt(p.length-1)!=" "&&h.push(p)})}function d(h,m){m.forEach(function(g,x){var p="F;";g.hidden?p+="M0;":g.hpt?p+="M"+20*g.hpt+";":g.hpx&&(p+="M"+20*ts(g.hpx)+";"),p.length>2&&h.push(p+"R"+(x+1))})}function u(h,m){var g=["ID;PWXL;N;E"],x=[],p=Xe(h["!ref"]),k,b=Array.isArray(h),w=`\r
`;g.push("P;PGeneral"),g.push("F;P0;DG0G8;M255"),h["!cols"]&&f(g,h["!cols"]),h["!rows"]&&d(g,h["!rows"]),g.push("B;Y"+(p.e.r-p.s.r+1)+";X"+(p.e.c-p.s.c+1)+";D"+[p.s.c,p.s.r,p.e.c,p.e.r].join(" "));for(var j=p.s.r;j<=p.e.r;++j)for(var R=p.s.c;R<=p.e.c;++R){var I=Le({r:j,c:R});k=b?(h[j]||[])[R]:h[I],!(!k||k.v==null&&(!k.f||k.F))&&x.push(l(k,h,j,R))}return g.join(w)+w+x.join(w)+w+"E"+w}return{to_workbook:c,to_sheet:i,from_sheet:u}}(),qc=function(){function e(n,i){switch(i.type){case"base64":return t(Qr(n),i);case"binary":return t(n,i);case"buffer":return t($e&&Buffer.isBuffer(n)?n.toString("binary"):Ht(n),i);case"array":return t(ta(n),i)}throw new Error("Unrecognized type "+i.type)}function t(n,i){for(var c=n.split(`
`),l=-1,f=-1,d=0,u=[];d!==c.length;++d){if(c[d].trim()==="BOT"){u[++l]=[],f=0;continue}if(!(l<0)){var h=c[d].trim().split(","),m=h[0],g=h[1];++d;for(var x=c[d]||"";(x.match(/["]/g)||[]).length&1&&d<c.length-1;)x+=`
`+c[++d];switch(x=x.trim(),+m){case-1:if(x==="BOT"){u[++l]=[],f=0;continue}else if(x!=="EOD")throw new Error("Unrecognized DIF special command "+x);break;case 0:x==="TRUE"?u[l][f]=!0:x==="FALSE"?u[l][f]=!1:isNaN(mt(g))?isNaN(ba(g).getDate())?u[l][f]=g:u[l][f]=nr(g):u[l][f]=mt(g),++f;break;case 1:x=x.slice(1,x.length-1),x=x.replace(/""/g,'"'),x&&x.match(/^=".*"$/)&&(x=x.slice(2,-1)),u[l][f++]=x!==""?x:null;break}if(x==="EOD")break}}return i&&i.sheetRows&&(u=u.slice(0,i.sheetRows)),u}function r(n,i){return Ca(e(n,i),i)}function a(n,i){return Vt(r(n,i),i)}var s=function(){var n=function(l,f,d,u,h){l.push(f),l.push(d+","+u),l.push('"'+h.replace(/"/g,'""')+'"')},i=function(l,f,d,u){l.push(f+","+d),l.push(f==1?'"'+u.replace(/"/g,'""')+'"':u)};return function(l){var f=[],d=Xe(l["!ref"]),u,h=Array.isArray(l);n(f,"TABLE",0,1,"sheetjs"),n(f,"VECTORS",0,d.e.r-d.s.r+1,""),n(f,"TUPLES",0,d.e.c-d.s.c+1,""),n(f,"DATA",0,0,"");for(var m=d.s.r;m<=d.e.r;++m){i(f,-1,0,"BOT");for(var g=d.s.c;g<=d.e.c;++g){var x=Le({r:m,c:g});if(u=h?(l[m]||[])[g]:l[x],!u){i(f,1,0,"");continue}switch(u.t){case"n":var p=u.w;!p&&u.v!=null&&(p=u.v),p==null?u.f&&!u.F?i(f,1,0,"="+u.f):i(f,1,0,""):i(f,0,p,"V");break;case"b":i(f,0,u.v?1:0,u.v?"TRUE":"FALSE");break;case"s":i(f,1,0,isNaN(u.v)?u.v:'="'+u.v+'"');break;case"d":u.w||(u.w=ct(u.z||Ie[14],br(nr(u.v)))),i(f,0,u.w,"V");break;default:i(f,1,0,"")}}}i(f,-1,0,"EOD");var k=`\r
`,b=f.join(k);return b}}();return{to_workbook:a,to_sheet:r,from_sheet:s}}(),Zc=function(){function e(u){return u.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(u){return u.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(u,h){for(var m=u.split(`
`),g=-1,x=-1,p=0,k=[];p!==m.length;++p){var b=m[p].trim().split(":");if(b[0]==="cell"){var w=dr(b[1]);if(k.length<=w.r)for(g=k.length;g<=w.r;++g)k[g]||(k[g]=[]);switch(g=w.r,x=w.c,b[2]){case"t":k[g][x]=e(b[3]);break;case"v":k[g][x]=+b[3];break;case"vtf":var j=b[b.length-1];case"vtc":switch(b[3]){case"nl":k[g][x]=!!+b[4];break;default:k[g][x]=+b[4];break}b[2]=="vtf"&&(k[g][x]=[k[g][x],j])}}}return h&&h.sheetRows&&(k=k.slice(0,h.sheetRows)),k}function a(u,h){return Ca(r(u,h),h)}function s(u,h){return Vt(a(u,h),h)}var n=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),i=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,c=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function f(u){if(!u||!u["!ref"])return"";for(var h=[],m=[],g,x="",p=Xr(u["!ref"]),k=Array.isArray(u),b=p.s.r;b<=p.e.r;++b)for(var w=p.s.c;w<=p.e.c;++w)if(x=Le({r:b,c:w}),g=k?(u[b]||[])[w]:u[x],!(!g||g.v==null||g.t==="z")){switch(m=["cell",x,"t"],g.t){case"s":case"str":m.push(t(g.v));break;case"n":g.f?(m[2]="vtf",m[3]="n",m[4]=g.v,m[5]=t(g.f)):(m[2]="v",m[3]=g.v);break;case"b":m[2]="vt"+(g.f?"f":"c"),m[3]="nl",m[4]=g.v?"1":"0",m[5]=t(g.f||(g.v?"TRUE":"FALSE"));break;case"d":var j=br(nr(g.v));m[2]="vtc",m[3]="nd",m[4]=""+j,m[5]=g.w||ct(g.z||Ie[14],j);break;case"e":continue}h.push(m.join(":"))}return h.push("sheet:c:"+(p.e.c-p.s.c+1)+":r:"+(p.e.r-p.s.r+1)+":tvf:1"),h.push("valueformat:1:text-wiki"),h.join(`
`)}function d(u){return[n,i,c,i,f(u),l].join(`
`)}return{to_workbook:s,to_sheet:a,from_sheet:d}}(),Ea=function(){function e(d,u,h,m,g){g.raw?u[h][m]=d:d===""||(d==="TRUE"?u[h][m]=!0:d==="FALSE"?u[h][m]=!1:isNaN(mt(d))?isNaN(ba(d).getDate())?u[h][m]=d:u[h][m]=nr(d):u[h][m]=mt(d))}function t(d,u){var h=u||{},m=[];if(!d||d.length===0)return m;for(var g=d.split(/[\r\n]/),x=g.length-1;x>=0&&g[x].length===0;)--x;for(var p=10,k=0,b=0;b<=x;++b)k=g[b].indexOf(" "),k==-1?k=g[b].length:k++,p=Math.max(p,k);for(b=0;b<=x;++b){m[b]=[];var w=0;for(e(g[b].slice(0,p).trim(),m,b,w,h),w=1;w<=(g[b].length-p)/10+1;++w)e(g[b].slice(p+(w-1)*10,p+w*10).trim(),m,b,w,h)}return h.sheetRows&&(m=m.slice(0,h.sheetRows)),m}var r={44:",",9:"	",59:";",124:"|"},a={44:3,9:2,59:1,124:0};function s(d){for(var u={},h=!1,m=0,g=0;m<d.length;++m)(g=d.charCodeAt(m))==34?h=!h:!h&&g in r&&(u[g]=(u[g]||0)+1);g=[];for(m in u)Object.prototype.hasOwnProperty.call(u,m)&&g.push([u[m],m]);if(!g.length){u=a;for(m in u)Object.prototype.hasOwnProperty.call(u,m)&&g.push([u[m],m])}return g.sort(function(x,p){return x[0]-p[0]||a[x[1]]-a[p[1]]}),r[g.pop()[1]]||44}function n(d,u){var h=u||{},m="",g=h.dense?[]:{},x={s:{c:0,r:0},e:{c:0,r:0}};d.slice(0,4)=="sep="?d.charCodeAt(5)==13&&d.charCodeAt(6)==10?(m=d.charAt(4),d=d.slice(7)):d.charCodeAt(5)==13||d.charCodeAt(5)==10?(m=d.charAt(4),d=d.slice(6)):m=s(d.slice(0,1024)):h&&h.FS?m=h.FS:m=s(d.slice(0,1024));var p=0,k=0,b=0,w=0,j=0,R=m.charCodeAt(0),I=!1,E=0,U=d.charCodeAt(0);d=d.replace(/\r\n/mg,`
`);var N=h.dateNF!=null?Cl(h.dateNF):null;function B(){var L=d.slice(w,j),P={};if(L.charAt(0)=='"'&&L.charAt(L.length-1)=='"'&&(L=L.slice(1,-1).replace(/""/g,'"')),L.length===0)P.t="z";else if(h.raw)P.t="s",P.v=L;else if(L.trim().length===0)P.t="s",P.v=L;else if(L.charCodeAt(0)==61)L.charCodeAt(1)==34&&L.charCodeAt(L.length-1)==34?(P.t="s",P.v=L.slice(2,-1).replace(/""/g,'"')):n1(L)?(P.t="n",P.f=L.slice(1)):(P.t="s",P.v=L);else if(L=="TRUE")P.t="b",P.v=!0;else if(L=="FALSE")P.t="b",P.v=!1;else if(!isNaN(b=mt(L)))P.t="n",h.cellText!==!1&&(P.w=L),P.v=b;else if(!isNaN(ba(L).getDate())||N&&L.match(N)){P.z=h.dateNF||Ie[14];var Q=0;N&&L.match(N)&&(L=Al(L,h.dateNF,L.match(N)||[]),Q=1),h.cellDates?(P.t="d",P.v=nr(L,Q)):(P.t="n",P.v=br(nr(L,Q))),h.cellText!==!1&&(P.w=ct(P.z,P.v instanceof Date?br(P.v):P.v)),h.cellNF||delete P.z}else P.t="s",P.v=L;if(P.t=="z"||(h.dense?(g[p]||(g[p]=[]),g[p][k]=P):g[Le({c:k,r:p})]=P),w=j+1,U=d.charCodeAt(w),x.e.c<k&&(x.e.c=k),x.e.r<p&&(x.e.r=p),E==R)++k;else if(k=0,++p,h.sheetRows&&h.sheetRows<=p)return!0}e:for(;j<d.length;++j)switch(E=d.charCodeAt(j)){case 34:U===34&&(I=!I);break;case R:case 10:case 13:if(!I&&B())break e;break}return j-w>0&&B(),g["!ref"]=We(x),g}function i(d,u){return!(u&&u.PRN)||u.FS||d.slice(0,4)=="sep="||d.indexOf("	")>=0||d.indexOf(",")>=0||d.indexOf(";")>=0?n(d,u):Ca(t(d,u),u)}function c(d,u){var h="",m=u.type=="string"?[0,0,0,0]:v0(d,u);switch(u.type){case"base64":h=Qr(d);break;case"binary":h=d;break;case"buffer":u.codepage==65001?h=d.toString("utf8"):u.codepage&&typeof Ga<"u"||(h=$e&&Buffer.isBuffer(d)?d.toString("binary"):Ht(d));break;case"array":h=ta(d);break;case"string":h=d;break;default:throw new Error("Unrecognized type "+u.type)}return m[0]==239&&m[1]==187&&m[2]==191?h=rr(h.slice(3)):u.type!="string"&&u.type!="buffer"&&u.codepage==65001?h=rr(h):u.type=="binary"&&typeof Ga<"u",h.slice(0,19)=="socialcalc:version:"?Zc.to_sheet(u.type=="string"?h:rr(h),u):i(h,u)}function l(d,u){return Vt(c(d,u),u)}function f(d){for(var u=[],h=Xe(d["!ref"]),m,g=Array.isArray(d),x=h.s.r;x<=h.e.r;++x){for(var p=[],k=h.s.c;k<=h.e.c;++k){var b=Le({r:x,c:k});if(m=g?(d[x]||[])[k]:d[b],!m||m.v==null){p.push("          ");continue}for(var w=(m.w||(At(m),m.w)||"").slice(0,10);w.length<10;)w+=" ";p.push(w+(k===0?" ":""))}u.push(p.join(""))}return u.join(`
`)}return{to_workbook:l,to_sheet:c,from_sheet:f}}();function zh(e,t){var r=t||{},a=!!r.WTF;r.WTF=!0;try{var s=Jc.to_workbook(e,r);return r.WTF=a,s}catch(n){if(r.WTF=a,!n.message.match(/SYLK bad record ID/)&&a)throw n;return Ea.to_workbook(e,t)}}var Qt=function(){function e(A,M,D){if(A){Cr(A,A.l||0);for(var O=D.Enum||we;A.l<A.length;){var W=A.read_shift(2),ee=O[W]||O[65535],se=A.read_shift(2),J=A.l+se,q=ee.f&&ee.f(A,se,D);if(A.l=J,M(q,ee,W))return}}}function t(A,M){switch(M.type){case"base64":return r(qr(Qr(A)),M);case"binary":return r(qr(A),M);case"buffer":case"array":return r(A,M)}throw"Unsupported type "+M.type}function r(A,M){if(!A)return A;var D=M||{},O=D.dense?[]:{},W="Sheet1",ee="",se=0,J={},q=[],ke=[],S={s:{r:0,c:0},e:{r:0,c:0}},je=D.sheetRows||0;if(A[2]==0&&(A[3]==8||A[3]==9)&&A.length>=16&&A[14]==5&&A[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(A[2]==2)D.Enum=we,e(A,function(ce,Ye,hr){switch(hr){case 0:D.vers=ce,ce>=4096&&(D.qpro=!0);break;case 6:S=ce;break;case 204:ce&&(ee=ce);break;case 222:ee=ce;break;case 15:case 51:D.qpro||(ce[1].v=ce[1].v.slice(1));case 13:case 14:case 16:hr==14&&(ce[2]&112)==112&&(ce[2]&15)>1&&(ce[2]&15)<15&&(ce[1].z=D.dateNF||Ie[14],D.cellDates&&(ce[1].t="d",ce[1].v=Ks(ce[1].v))),D.qpro&&ce[3]>se&&(O["!ref"]=We(S),J[W]=O,q.push(W),O=D.dense?[]:{},S={s:{r:0,c:0},e:{r:0,c:0}},se=ce[3],W=ee||"Sheet"+(se+1),ee="");var Re=D.dense?(O[ce[0].r]||[])[ce[0].c]:O[Le(ce[0])];if(Re){Re.t=ce[1].t,Re.v=ce[1].v,ce[1].z!=null&&(Re.z=ce[1].z),ce[1].f!=null&&(Re.f=ce[1].f);break}D.dense?(O[ce[0].r]||(O[ce[0].r]=[]),O[ce[0].r][ce[0].c]=ce[1]):O[Le(ce[0])]=ce[1];break}},D);else if(A[2]==26||A[2]==14)D.Enum=Ee,A[2]==14&&(D.qpro=!0,A.l=0),e(A,function(ce,Ye,hr){switch(hr){case 204:W=ce;break;case 22:ce[1].v=ce[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(ce[3]>se&&(O["!ref"]=We(S),J[W]=O,q.push(W),O=D.dense?[]:{},S={s:{r:0,c:0},e:{r:0,c:0}},se=ce[3],W="Sheet"+(se+1)),je>0&&ce[0].r>=je)break;D.dense?(O[ce[0].r]||(O[ce[0].r]=[]),O[ce[0].r][ce[0].c]=ce[1]):O[Le(ce[0])]=ce[1],S.e.c<ce[0].c&&(S.e.c=ce[0].c),S.e.r<ce[0].r&&(S.e.r=ce[0].r);break;case 27:ce[14e3]&&(ke[ce[14e3][0]]=ce[14e3][1]);break;case 1537:ke[ce[0]]=ce[1],ce[0]==se&&(W=ce[1]);break}},D);else throw new Error("Unrecognized LOTUS BOF "+A[2]);if(O["!ref"]=We(S),J[ee||W]=O,q.push(ee||W),!ke.length)return{SheetNames:q,Sheets:J};for(var Ce={},Be=[],Fe=0;Fe<ke.length;++Fe)J[q[Fe]]?(Be.push(ke[Fe]||q[Fe]),Ce[ke[Fe]]=J[ke[Fe]]||J[q[Fe]]):(Be.push(ke[Fe]),Ce[ke[Fe]]={"!ref":"A1"});return{SheetNames:Be,Sheets:Ce}}function a(A,M){var D=M||{};if(+D.codepage>=0&&ut(+D.codepage),D.type=="string")throw new Error("Cannot write WK1 to JS string");var O=Gr(),W=Xe(A["!ref"]),ee=Array.isArray(A),se=[];me(O,0,n(1030)),me(O,6,l(W));for(var J=Math.min(W.e.r,8191),q=W.s.r;q<=J;++q)for(var ke=pr(q),S=W.s.c;S<=W.e.c;++S){q===W.s.r&&(se[S]=fr(S));var je=se[S]+ke,Ce=ee?(A[q]||[])[S]:A[je];if(!(!Ce||Ce.t=="z"))if(Ce.t=="n")(Ce.v|0)==Ce.v&&Ce.v>=-32768&&Ce.v<=32767?me(O,13,m(q,S,Ce.v)):me(O,14,x(q,S,Ce.v));else{var Be=At(Ce);me(O,15,u(q,S,Be.slice(0,239)))}}return me(O,1),O.end()}function s(A,M){var D=M||{};if(+D.codepage>=0&&ut(+D.codepage),D.type=="string")throw new Error("Cannot write WK3 to JS string");var O=Gr();me(O,0,i(A));for(var W=0,ee=0;W<A.SheetNames.length;++W)(A.Sheets[A.SheetNames[W]]||{})["!ref"]&&me(O,27,H(A.SheetNames[W],ee++));var se=0;for(W=0;W<A.SheetNames.length;++W){var J=A.Sheets[A.SheetNames[W]];if(!(!J||!J["!ref"])){for(var q=Xe(J["!ref"]),ke=Array.isArray(J),S=[],je=Math.min(q.e.r,8191),Ce=q.s.r;Ce<=je;++Ce)for(var Be=pr(Ce),Fe=q.s.c;Fe<=q.e.c;++Fe){Ce===q.s.r&&(S[Fe]=fr(Fe));var ce=S[Fe]+Be,Ye=ke?(J[Ce]||[])[Fe]:J[ce];if(!(!Ye||Ye.t=="z"))if(Ye.t=="n")me(O,23,B(Ce,Fe,se,Ye.v));else{var hr=At(Ye);me(O,22,E(Ce,Fe,se,hr.slice(0,239)))}}++se}}return me(O,1),O.end()}function n(A){var M=Y(2);return M.write_shift(2,A),M}function i(A){var M=Y(26);M.write_shift(2,4096),M.write_shift(2,4),M.write_shift(4,0);for(var D=0,O=0,W=0,ee=0;ee<A.SheetNames.length;++ee){var se=A.SheetNames[ee],J=A.Sheets[se];if(!(!J||!J["!ref"])){++W;var q=Xr(J["!ref"]);D<q.e.r&&(D=q.e.r),O<q.e.c&&(O=q.e.c)}}return D>8191&&(D=8191),M.write_shift(2,D),M.write_shift(1,W),M.write_shift(1,O),M.write_shift(2,0),M.write_shift(2,0),M.write_shift(1,1),M.write_shift(1,2),M.write_shift(4,0),M.write_shift(4,0),M}function c(A,M,D){var O={s:{c:0,r:0},e:{c:0,r:0}};return M==8&&D.qpro?(O.s.c=A.read_shift(1),A.l++,O.s.r=A.read_shift(2),O.e.c=A.read_shift(1),A.l++,O.e.r=A.read_shift(2),O):(O.s.c=A.read_shift(2),O.s.r=A.read_shift(2),M==12&&D.qpro&&(A.l+=2),O.e.c=A.read_shift(2),O.e.r=A.read_shift(2),M==12&&D.qpro&&(A.l+=2),O.s.c==65535&&(O.s.c=O.e.c=O.s.r=O.e.r=0),O)}function l(A){var M=Y(8);return M.write_shift(2,A.s.c),M.write_shift(2,A.s.r),M.write_shift(2,A.e.c),M.write_shift(2,A.e.r),M}function f(A,M,D){var O=[{c:0,r:0},{t:"n",v:0},0,0];return D.qpro&&D.vers!=20768?(O[0].c=A.read_shift(1),O[3]=A.read_shift(1),O[0].r=A.read_shift(2),A.l+=2):(O[2]=A.read_shift(1),O[0].c=A.read_shift(2),O[0].r=A.read_shift(2)),O}function d(A,M,D){var O=A.l+M,W=f(A,M,D);if(W[1].t="s",D.vers==20768){A.l++;var ee=A.read_shift(1);return W[1].v=A.read_shift(ee,"utf8"),W}return D.qpro&&A.l++,W[1].v=A.read_shift(O-A.l,"cstr"),W}function u(A,M,D){var O=Y(7+D.length);O.write_shift(1,255),O.write_shift(2,M),O.write_shift(2,A),O.write_shift(1,39);for(var W=0;W<O.length;++W){var ee=D.charCodeAt(W);O.write_shift(1,ee>=128?95:ee)}return O.write_shift(1,0),O}function h(A,M,D){var O=f(A,M,D);return O[1].v=A.read_shift(2,"i"),O}function m(A,M,D){var O=Y(7);return O.write_shift(1,255),O.write_shift(2,M),O.write_shift(2,A),O.write_shift(2,D,"i"),O}function g(A,M,D){var O=f(A,M,D);return O[1].v=A.read_shift(8,"f"),O}function x(A,M,D){var O=Y(13);return O.write_shift(1,255),O.write_shift(2,M),O.write_shift(2,A),O.write_shift(8,D,"f"),O}function p(A,M,D){var O=A.l+M,W=f(A,M,D);if(W[1].v=A.read_shift(8,"f"),D.qpro)A.l=O;else{var ee=A.read_shift(2);j(A.slice(A.l,A.l+ee),W),A.l+=ee}return W}function k(A,M,D){var O=M&32768;return M&=-32769,M=(O?A:0)+(M>=8192?M-16384:M),(O?"":"$")+(D?fr(M):pr(M))}var b={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},w=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function j(A,M){Cr(A,0);for(var D=[],O=0,W="",ee="",se="",J="";A.l<A.length;){var q=A[A.l++];switch(q){case 0:D.push(A.read_shift(8,"f"));break;case 1:ee=k(M[0].c,A.read_shift(2),!0),W=k(M[0].r,A.read_shift(2),!1),D.push(ee+W);break;case 2:{var ke=k(M[0].c,A.read_shift(2),!0),S=k(M[0].r,A.read_shift(2),!1);ee=k(M[0].c,A.read_shift(2),!0),W=k(M[0].r,A.read_shift(2),!1),D.push(ke+S+":"+ee+W)}break;case 3:if(A.l<A.length){console.error("WK1 premature formula end");return}break;case 4:D.push("("+D.pop()+")");break;case 5:D.push(A.read_shift(2));break;case 6:{for(var je="";q=A[A.l++];)je+=String.fromCharCode(q);D.push('"'+je.replace(/"/g,'""')+'"')}break;case 8:D.push("-"+D.pop());break;case 23:D.push("+"+D.pop());break;case 22:D.push("NOT("+D.pop()+")");break;case 20:case 21:J=D.pop(),se=D.pop(),D.push(["AND","OR"][q-20]+"("+se+","+J+")");break;default:if(q<32&&w[q])J=D.pop(),se=D.pop(),D.push(se+w[q]+J);else if(b[q]){if(O=b[q][1],O==69&&(O=A[A.l++]),O>D.length){console.error("WK1 bad formula parse 0x"+q.toString(16)+":|"+D.join("|")+"|");return}var Ce=D.slice(-O);D.length-=O,D.push(b[q][0]+"("+Ce.join(",")+")")}else return q<=7?console.error("WK1 invalid opcode "+q.toString(16)):q<=24?console.error("WK1 unsupported op "+q.toString(16)):q<=30?console.error("WK1 invalid opcode "+q.toString(16)):q<=115?console.error("WK1 unsupported function opcode "+q.toString(16)):console.error("WK1 unrecognized opcode "+q.toString(16))}}D.length==1?M[1].f=""+D[0]:console.error("WK1 bad formula parse |"+D.join("|")+"|")}function R(A){var M=[{c:0,r:0},{t:"n",v:0},0];return M[0].r=A.read_shift(2),M[3]=A[A.l++],M[0].c=A[A.l++],M}function I(A,M){var D=R(A);return D[1].t="s",D[1].v=A.read_shift(M-4,"cstr"),D}function E(A,M,D,O){var W=Y(6+O.length);W.write_shift(2,A),W.write_shift(1,D),W.write_shift(1,M),W.write_shift(1,39);for(var ee=0;ee<O.length;++ee){var se=O.charCodeAt(ee);W.write_shift(1,se>=128?95:se)}return W.write_shift(1,0),W}function U(A,M){var D=R(A);D[1].v=A.read_shift(2);var O=D[1].v>>1;if(D[1].v&1)switch(O&7){case 0:O=(O>>3)*5e3;break;case 1:O=(O>>3)*500;break;case 2:O=(O>>3)/20;break;case 3:O=(O>>3)/200;break;case 4:O=(O>>3)/2e3;break;case 5:O=(O>>3)/2e4;break;case 6:O=(O>>3)/16;break;case 7:O=(O>>3)/64;break}return D[1].v=O,D}function N(A,M){var D=R(A),O=A.read_shift(4),W=A.read_shift(4),ee=A.read_shift(2);if(ee==65535)return O===0&&W===3221225472?(D[1].t="e",D[1].v=15):O===0&&W===3489660928?(D[1].t="e",D[1].v=42):D[1].v=0,D;var se=ee&32768;return ee=(ee&32767)-16446,D[1].v=(1-se*2)*(W*Math.pow(2,ee+32)+O*Math.pow(2,ee)),D}function B(A,M,D,O){var W=Y(14);if(W.write_shift(2,A),W.write_shift(1,D),W.write_shift(1,M),O==0)return W.write_shift(4,0),W.write_shift(4,0),W.write_shift(2,65535),W;var ee=0,se=0,J=0,q=0;return O<0&&(ee=1,O=-O),se=Math.log2(O)|0,O/=Math.pow(2,se-31),q=O>>>0,q&2147483648||(O/=2,++se,q=O>>>0),O-=q,q|=2147483648,q>>>=0,O*=Math.pow(2,32),J=O>>>0,W.write_shift(4,J),W.write_shift(4,q),se+=16383+(ee?32768:0),W.write_shift(2,se),W}function L(A,M){var D=N(A);return A.l+=M-14,D}function P(A,M){var D=R(A),O=A.read_shift(4);return D[1].v=O>>6,D}function Q(A,M){var D=R(A),O=A.read_shift(8,"f");return D[1].v=O,D}function fe(A,M){var D=Q(A);return A.l+=M-10,D}function ie(A,M){return A[A.l+M-1]==0?A.read_shift(M,"cstr"):""}function pe(A,M){var D=A[A.l++];D>M-1&&(D=M-1);for(var O="";O.length<D;)O+=String.fromCharCode(A[A.l++]);return O}function he(A,M,D){if(!(!D.qpro||M<21)){var O=A.read_shift(1);A.l+=17,A.l+=1,A.l+=2;var W=A.read_shift(M-21,"cstr");return[O,W]}}function Ve(A,M){for(var D={},O=A.l+M;A.l<O;){var W=A.read_shift(2);if(W==14e3){for(D[W]=[0,""],D[W][0]=A.read_shift(2);A[A.l];)D[W][1]+=String.fromCharCode(A[A.l]),A.l++;A.l++}}return D}function H(A,M){var D=Y(5+A.length);D.write_shift(2,14e3),D.write_shift(2,M);for(var O=0;O<A.length;++O){var W=A.charCodeAt(O);D[D.l++]=W>127?95:W}return D[D.l++]=0,D}var we={0:{n:"BOF",f:_r},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:c},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:h},14:{n:"NUMBER",f:g},15:{n:"LABEL",f:d},16:{n:"FORMULA",f:p},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:d},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:ie},222:{n:"SHEETNAMELP",f:pe},65535:{n:""}},Ee={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:I},23:{n:"NUMBER17",f:N},24:{n:"NUMBER18",f:U},25:{n:"FORMULA19",f:L},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:Ve},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:P},38:{n:"??"},39:{n:"NUMBER27",f:Q},40:{n:"FORMULA28",f:fe},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:ie},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:he},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:a,book_to_wk3:s,to_workbook:t}}();function Gh(e){var t={},r=e.match(Br),a=0,s=!1;if(r)for(;a!=r.length;++a){var n=Me(r[a]);switch(n[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!n.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(n.val=="1")break;t.cp=Ln[parseInt(n.val,10)];break;case"<outline":if(!n.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=n.val;break;case"<sz":t.sz=n.val;break;case"<strike":if(!n.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!n.val)break;switch(n.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(n.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(n.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":n.rgb&&(t.color=n.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=n.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=n.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n[0].charCodeAt(1)!==47&&!s)throw new Error("Unrecognized rich format "+n[0])}}return t}var Xh=function(){var e=Ya("t"),t=Ya("rPr");function r(n){var i=n.match(e);if(!i)return{t:"s",v:""};var c={t:"s",v:Ge(i[1])},l=n.match(t);return l&&(c.s=Gh(l[1])),c}var a=/<(?:\w+:)?r>/g,s=/<\/(?:\w+:)?r>/;return function(i){return i.replace(a,"").split(s).map(r).filter(function(c){return c.v})}}(),Kh=function(){var t=/(\r\n|\n)/g;function r(s,n,i){var c=[];s.u&&c.push("text-decoration: underline;"),s.uval&&c.push("text-underline-style:"+s.uval+";"),s.sz&&c.push("font-size:"+s.sz+"pt;"),s.outline&&c.push("text-effect: outline;"),s.shadow&&c.push("text-shadow: auto;"),n.push('<span style="'+c.join("")+'">'),s.b&&(n.push("<b>"),i.push("</b>")),s.i&&(n.push("<i>"),i.push("</i>")),s.strike&&(n.push("<s>"),i.push("</s>"));var l=s.valign||"";return l=="superscript"||l=="super"?l="sup":l=="subscript"&&(l="sub"),l!=""&&(n.push("<"+l+">"),i.push("</"+l+">")),i.push("</span>"),s}function a(s){var n=[[],s.v,[]];return s.v?(s.s&&r(s.s,n[0],n[2]),n[0].join("")+n[1].replace(t,"<br/>")+n[2].join("")):""}return function(n){return n.map(a).join("")}}(),Yh=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,Jh=/<(?:\w+:)?r>/,qh=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function n0(e,t){var r=t?t.cellHTML:!0,a={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(a.t=Ge(rr(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),a.r=rr(e),r&&(a.h=zn(a.t))):e.match(Jh)&&(a.r=rr(e),a.t=Ge(rr((e.replace(qh,"").match(Yh)||[]).join("").replace(Br,""))),r&&(a.h=Kh(Xh(a.r)))),a):{t:""}}var Zh=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,Qh=/<(?:\w+:)?(?:si|sstItem)>/g,eu=/<\/(?:\w+:)?(?:si|sstItem)>/;function ru(e,t){var r=[],a="";if(!e)return r;var s=e.match(Zh);if(s){a=s[2].replace(Qh,"").split(eu);for(var n=0;n!=a.length;++n){var i=n0(a[n].trim(),t);i!=null&&(r[r.length]=i)}s=Me(s[1]),r.Count=s.count,r.Unique=s.uniqueCount}return r}var tu=/^\s|\s$|[\t\n\r]/;function Qc(e,t){if(!t.bookSST)return"";var r=[vr];r[r.length]=xe("sst",null,{xmlns:ca[0],count:e.Count,uniqueCount:e.Unique});for(var a=0;a!=e.length;++a)if(e[a]!=null){var s=e[a],n="<si>";s.r?n+=s.r:(n+="<t",s.t||(s.t=""),s.t.match(tu)&&(n+=' xml:space="preserve"'),n+=">"+er(s.t)+"</t>"),n+="</si>",r[r.length]=n}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function au(e){return[e.read_shift(4),e.read_shift(4)]}function su(e,t){var r=[],a=!1;return Dt(e,function(n,i,c){switch(c){case 159:r.Count=n[0],r.Unique=n[1];break;case 19:r.push(n);break;case 160:return!0;case 35:a=!0;break;case 36:a=!1;break;default:if(i.T,!a||t.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}),r}function nu(e,t){return t||(t=Y(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var iu=gf;function cu(e){var t=Gr();ne(t,159,nu(e));for(var r=0;r<e.length;++r)ne(t,19,iu(e[r]));return ne(t,160),t.end()}function eo(e){for(var t=[],r=e.split(""),a=0;a<r.length;++a)t[a]=r[a].charCodeAt(0);return t}function Ct(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function ou(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=Ct(e,4),t.U=Ct(e,4),t.W=Ct(e,4),t}function lu(e){for(var t=e.read_shift(4),r=e.l+t-4,a={},s=e.read_shift(4),n=[];s-- >0;)n.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(a.name=e.read_shift(0,"lpp4"),a.comps=n,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return a}function fu(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(lu(e));return t}function du(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function hu(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=Ct(e,4),t.U=Ct(e,4),t.W=Ct(e,4),t}function uu(e){var t=hu(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function ro(e,t){var r=e.l+t,a={};a.Flags=e.read_shift(4)&63,e.l+=4,a.AlgID=e.read_shift(4);var s=!1;switch(a.AlgID){case 26126:case 26127:case 26128:s=a.Flags==36;break;case 26625:s=a.Flags==4;break;case 0:s=a.Flags==16||a.Flags==4||a.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+a.AlgID}if(!s)throw new Error("Encryption Flags/AlgID mismatch");return a.AlgIDHash=e.read_shift(4),a.KeySize=e.read_shift(4),a.ProviderType=e.read_shift(4),e.l+=8,a.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,a}function to(e,t){var r={},a=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,a),e.l=a,r}function xu(e){var t=Ct(e);switch(t.Minor){case 2:return[t.Minor,mu(e)];case 3:return[t.Minor,gu()];case 4:return[t.Minor,pu(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function mu(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),a=ro(e,r),s=to(e,e.length-e.l);return{t:"Std",h:a,v:s}}function gu(){throw new Error("File is password-protected: ECMA-376 Extensible")}function pu(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),a={};return r.replace(Br,function(n){var i=Me(n);switch(yt(i[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(c){a[c]=i[c]});break;case"<dataIntegrity":a.encryptedHmacKey=i.encryptedHmacKey,a.encryptedHmacValue=i.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":a.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":a.uri=i.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":a.encs.push(i);break;default:throw i[0]}}),a}function vu(e,t){var r={},a=r.EncryptionVersionInfo=Ct(e,4);if(t-=4,a.Minor!=2)throw new Error("unrecognized minor version code: "+a.Minor);if(a.Major>4||a.Major<2)throw new Error("unrecognized major version code: "+a.Major);r.Flags=e.read_shift(4),t-=4;var s=e.read_shift(4);return t-=4,r.EncryptionHeader=ro(e,s),t-=s,r.EncryptionVerifier=to(e,t),r}function wu(e){var t={},r=t.EncryptionVersionInfo=Ct(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function i0(e){var t=0,r,a=eo(e),s=a.length+1,n,i,c,l,f;for(r=Pt(s),r[0]=a.length,n=1;n!=s;++n)r[n]=a[n-1];for(n=s-1;n>=0;--n)i=r[n],c=t&16384?1:0,l=t<<1&32767,f=c|l,t=f^i;return t^52811}var ao=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],a=function(i){return(i/2|i*128)&255},s=function(i,c){return a(i^c)},n=function(i){for(var c=t[i.length-1],l=104,f=i.length-1;f>=0;--f)for(var d=i[f],u=0;u!=7;++u)d&64&&(c^=r[l]),d*=2,--l;return c};return function(i){for(var c=eo(i),l=n(c),f=c.length,d=Pt(16),u=0;u!=16;++u)d[u]=0;var h,m,g;for((f&1)===1&&(h=l>>8,d[f]=s(e[0],h),--f,h=l&255,m=c[c.length-1],d[f]=s(m,h));f>0;)--f,h=l>>8,d[f]=s(c[f],h),--f,h=l&255,d[f]=s(c[f],h);for(f=15,g=15-c.length;g>0;)h=l>>8,d[f]=s(e[g],h),--f,--g,h=l&255,d[f]=s(c[f],h),--f,--g;return d}}(),ku=function(e,t,r,a,s){s||(s=t),a||(a=ao(e));var n,i;for(n=0;n!=t.length;++n)i=t[n],i^=a[r],i=(i>>5|i<<3)&255,s[n]=i,++r;return[s,r,a]},_u=function(e){var t=0,r=ao(e);return function(a){var s=ku("",a,t,r);return t=s[1],s[0]}};function yu(e,t,r,a){var s={key:_r(e),verificationBytes:_r(e)};return r.password&&(s.verifier=i0(r.password)),a.valid=s.verificationBytes===s.verifier,a.valid&&(a.insitu=_u(r.password)),s}function bu(e,t,r){var a=r||{};return a.Info=e.read_shift(2),e.l-=2,a.Info===1?a.Data=wu(e):a.Data=vu(e,t),a}function Eu(e,t,r){var a={Type:r.biff>=8?e.read_shift(2):0};return a.Type?bu(e,t-2,a):yu(e,r.biff>=8?t:t-2,r,a),a}var so=function(){function e(s,n){switch(n.type){case"base64":return t(Qr(s),n);case"binary":return t(s,n);case"buffer":return t($e&&Buffer.isBuffer(s)?s.toString("binary"):Ht(s),n);case"array":return t(ta(s),n)}throw new Error("Unrecognized type "+n.type)}function t(s,n){var i=n||{},c=i.dense?[]:{},l=s.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var f={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(d,u){Array.isArray(c)&&(c[u]=[]);for(var h=/\\\w+\b/g,m=0,g,x=-1;g=h.exec(d);){switch(g[0]){case"\\cell":var p=d.slice(m,h.lastIndex-g[0].length);if(p[0]==" "&&(p=p.slice(1)),++x,p.length){var k={v:p,t:"s"};Array.isArray(c)?c[u][x]=k:c[Le({r:u,c:x})]=k}break}m=h.lastIndex}x>f.e.c&&(f.e.c=x)}),c["!ref"]=We(f),c}function r(s,n){return Vt(e(s,n),n)}function a(s){for(var n=["{\\rtf1\\ansi"],i=Xe(s["!ref"]),c,l=Array.isArray(s),f=i.s.r;f<=i.e.r;++f){n.push("\\trowd\\trautofit1");for(var d=i.s.c;d<=i.e.c;++d)n.push("\\cellx"+(d+1));for(n.push("\\pard\\intbl"),d=i.s.c;d<=i.e.c;++d){var u=Le({r:f,c:d});c=l?(s[f]||[])[d]:s[u],!(!c||c.v==null&&(!c.f||c.F))&&(n.push(" "+(c.w||(At(c),c.w))),n.push("\\cell"))}n.push("\\pard\\intbl\\row")}return n.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:a}}();function Su(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function Qa(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function Tu(e){var t=e[0]/255,r=e[1]/255,a=e[2]/255,s=Math.max(t,r,a),n=Math.min(t,r,a),i=s-n;if(i===0)return[0,0,t];var c=0,l=0,f=s+n;switch(l=i/(f>1?2-f:f),s){case t:c=((r-a)/i+6)%6;break;case r:c=(a-t)/i+2;break;case a:c=(t-r)/i+4;break}return[c/6,l,f/2]}function Nu(e){var t=e[0],r=e[1],a=e[2],s=r*2*(a<.5?a:1-a),n=a-s/2,i=[n,n,n],c=6*t,l;if(r!==0)switch(c|0){case 0:case 6:l=s*c,i[0]+=s,i[1]+=l;break;case 1:l=s*(2-c),i[0]+=l,i[1]+=s;break;case 2:l=s*(c-2),i[1]+=s,i[2]+=l;break;case 3:l=s*(4-c),i[1]+=l,i[2]+=s;break;case 4:l=s*(c-4),i[2]+=s,i[0]+=l;break;case 5:l=s*(6-c),i[2]+=l,i[0]+=s;break}for(var f=0;f!=3;++f)i[f]=Math.round(i[f]*255);return i}function Ws(e,t){if(t===0)return e;var r=Tu(Su(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),Qa(Nu(r))}var no=6,Fu=15,Cu=1,Lr=no;function es(e){return Math.floor((e+Math.round(128/Lr)/256)*Lr)}function rs(e){return Math.floor((e-5)/Lr*100+.5)/100}function Hs(e){return Math.round((e*Lr+5)/Lr*256)/256}function ln(e){return Hs(rs(es(e)))}function c0(e){var t=Math.abs(e-ln(e)),r=Lr;if(t>.005)for(Lr=Cu;Lr<Fu;++Lr)Math.abs(e-ln(e))<=t&&(t=Math.abs(e-ln(e)),r=Lr);Lr=r}function Bt(e){e.width?(e.wpx=es(e.width),e.wch=rs(e.wpx),e.MDW=Lr):e.wpx?(e.wch=rs(e.wpx),e.width=Hs(e.wch),e.MDW=Lr):typeof e.wch=="number"&&(e.width=Hs(e.wch),e.wpx=es(e.width),e.MDW=Lr),e.customWidth&&delete e.customWidth}var Au=96,io=Au;function ts(e){return e*96/io}function Sa(e){return e*io/96}var ju={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function Du(e,t,r,a){t.Borders=[];var s={},n=!1;(e[0].match(Br)||[]).forEach(function(i){var c=Me(i);switch(yt(c[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":s={},c.diagonalUp&&(s.diagonalUp=sr(c.diagonalUp)),c.diagonalDown&&(s.diagonalDown=sr(c.diagonalDown)),t.Borders.push(s);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(a&&a.WTF&&!n)throw new Error("unrecognized "+c[0]+" in borders")}})}function Iu(e,t,r,a){t.Fills=[];var s={},n=!1;(e[0].match(Br)||[]).forEach(function(i){var c=Me(i);switch(yt(c[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":s={},t.Fills.push(s);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(s),s={};break;case"<patternFill":case"<patternFill>":c.patternType&&(s.patternType=c.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":s.bgColor||(s.bgColor={}),c.indexed&&(s.bgColor.indexed=parseInt(c.indexed,10)),c.theme&&(s.bgColor.theme=parseInt(c.theme,10)),c.tint&&(s.bgColor.tint=parseFloat(c.tint)),c.rgb&&(s.bgColor.rgb=c.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":s.fgColor||(s.fgColor={}),c.theme&&(s.fgColor.theme=parseInt(c.theme,10)),c.tint&&(s.fgColor.tint=parseFloat(c.tint)),c.rgb!=null&&(s.fgColor.rgb=c.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(a&&a.WTF&&!n)throw new Error("unrecognized "+c[0]+" in fills")}})}function Ou(e,t,r,a){t.Fonts=[];var s={},n=!1;(e[0].match(Br)||[]).forEach(function(i){var c=Me(i);switch(yt(c[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(s),s={};break;case"<name":c.val&&(s.name=rr(c.val));break;case"<name/>":case"</name>":break;case"<b":s.bold=c.val?sr(c.val):1;break;case"<b/>":s.bold=1;break;case"<i":s.italic=c.val?sr(c.val):1;break;case"<i/>":s.italic=1;break;case"<u":switch(c.val){case"none":s.underline=0;break;case"single":s.underline=1;break;case"double":s.underline=2;break;case"singleAccounting":s.underline=33;break;case"doubleAccounting":s.underline=34;break}break;case"<u/>":s.underline=1;break;case"<strike":s.strike=c.val?sr(c.val):1;break;case"<strike/>":s.strike=1;break;case"<outline":s.outline=c.val?sr(c.val):1;break;case"<outline/>":s.outline=1;break;case"<shadow":s.shadow=c.val?sr(c.val):1;break;case"<shadow/>":s.shadow=1;break;case"<condense":s.condense=c.val?sr(c.val):1;break;case"<condense/>":s.condense=1;break;case"<extend":s.extend=c.val?sr(c.val):1;break;case"<extend/>":s.extend=1;break;case"<sz":c.val&&(s.sz=+c.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":c.val&&(s.vertAlign=c.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":c.val&&(s.family=parseInt(c.val,10));break;case"<family/>":case"</family>":break;case"<scheme":c.val&&(s.scheme=c.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(c.val=="1")break;c.codepage=Ln[parseInt(c.val,10)];break;case"<color":if(s.color||(s.color={}),c.auto&&(s.color.auto=sr(c.auto)),c.rgb)s.color.rgb=c.rgb.slice(-6);else if(c.indexed){s.color.index=parseInt(c.indexed,10);var l=qt[s.color.index];s.color.index==81&&(l=qt[1]),l||(l=qt[1]),s.color.rgb=l[0].toString(16)+l[1].toString(16)+l[2].toString(16)}else c.theme&&(s.color.theme=parseInt(c.theme,10),c.tint&&(s.color.tint=parseFloat(c.tint)),c.theme&&r.themeElements&&r.themeElements.clrScheme&&(s.color.rgb=Ws(r.themeElements.clrScheme[s.color.theme].rgb,s.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":n=!0;break;case"</AlternateContent>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(a&&a.WTF&&!n)throw new Error("unrecognized "+c[0]+" in fonts")}})}function Lu(e,t,r){t.NumberFmt=[];for(var a=mr(Ie),s=0;s<a.length;++s)t.NumberFmt[a[s]]=Ie[a[s]];var n=e[0].match(Br);if(n)for(s=0;s<n.length;++s){var i=Me(n[s]);switch(yt(i[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var c=Ge(rr(i.formatCode)),l=parseInt(i.numFmtId,10);if(t.NumberFmt[l]=c,l>0){if(l>392){for(l=392;l>60&&t.NumberFmt[l]!=null;--l);t.NumberFmt[l]=c}Ft(c,l)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+i[0]+" in numFmts")}}}function Ru(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var a=r[0];a<=r[1];++a)e[a]!=null&&(t[t.length]=xe("numFmt",null,{numFmtId:a,formatCode:er(e[a])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=xe("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var Es=["numFmtId","fillId","fontId","borderId","xfId"],Ss=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function Mu(e,t,r){t.CellXf=[];var a,s=!1;(e[0].match(Br)||[]).forEach(function(n){var i=Me(n),c=0;switch(yt(i[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(a=i,delete a[0],c=0;c<Es.length;++c)a[Es[c]]&&(a[Es[c]]=parseInt(a[Es[c]],10));for(c=0;c<Ss.length;++c)a[Ss[c]]&&(a[Ss[c]]=sr(a[Ss[c]]));if(t.NumberFmt&&a.numFmtId>392){for(c=392;c>60;--c)if(t.NumberFmt[a.numFmtId]==t.NumberFmt[c]){a.numFmtId=c;break}}t.CellXf.push(a);break;case"</xf>":break;case"<alignment":case"<alignment/>":var l={};i.vertical&&(l.vertical=i.vertical),i.horizontal&&(l.horizontal=i.horizontal),i.textRotation!=null&&(l.textRotation=i.textRotation),i.indent&&(l.indent=i.indent),i.wrapText&&(l.wrapText=sr(i.wrapText)),a.alignment=l;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(r&&r.WTF&&!s)throw new Error("unrecognized "+i[0]+" in cellXfs")}})}function Pu(e){var t=[];return t[t.length]=xe("cellXfs",null),e.forEach(function(r){t[t.length]=xe("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=xe("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var Bu=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,a=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,s=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,n=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(c,l,f){var d={};if(!c)return d;c=c.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var u;return(u=c.match(t))&&Lu(u,d,f),(u=c.match(s))&&Ou(u,d,l,f),(u=c.match(a))&&Iu(u,d,l,f),(u=c.match(n))&&Du(u,d,l,f),(u=c.match(r))&&Mu(u,d,f),d}}();function co(e,t){var r=[vr,xe("styleSheet",null,{xmlns:ca[0],"xmlns:vt":yr.vt})],a;return e.SSF&&(a=Ru(e.SSF))!=null&&(r[r.length]=a),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(a=Pu(t.cellXfs))&&(r[r.length]=a),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function Uu(e,t){var r=e.read_shift(2),a=Mr(e);return[r,a]}function Wu(e,t,r){r||(r=Y(6+4*t.length)),r.write_shift(2,e),Nr(t,r);var a=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),a}function Hu(e,t,r){var a={};a.sz=e.read_shift(2)/20;var s=bf(e);s.fItalic&&(a.italic=1),s.fCondense&&(a.condense=1),s.fExtend&&(a.extend=1),s.fShadow&&(a.shadow=1),s.fOutline&&(a.outline=1),s.fStrikeout&&(a.strike=1);var n=e.read_shift(2);switch(n===700&&(a.bold=1),e.read_shift(2)){case 1:a.vertAlign="superscript";break;case 2:a.vertAlign="subscript";break}var i=e.read_shift(1);i!=0&&(a.underline=i);var c=e.read_shift(1);c>0&&(a.family=c);var l=e.read_shift(1);switch(l>0&&(a.charset=l),e.l++,a.color=yf(e),e.read_shift(1)){case 1:a.scheme="major";break;case 2:a.scheme="minor";break}return a.name=Mr(e),a}function Vu(e,t){t||(t=Y(25+4*32)),t.write_shift(2,e.sz*20),Ef(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),Ps(e.color,t);var a=0;return a=2,t.write_shift(1,a),Nr(e.name,t),t.length>t.l?t.slice(0,t.l):t}var $u=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],fn,zu=Pr;function ui(e,t){t||(t=Y(4*3+8*7+16*1)),fn||(fn=Gs($u));var r=fn[e.patternType];r==null&&(r=40),t.write_shift(4,r);var a=0;if(r!=40)for(Ps({auto:1},t),Ps({auto:1},t);a<12;++a)t.write_shift(4,0);else{for(;a<4;++a)t.write_shift(4,0);for(;a<12;++a)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function Gu(e,t){var r=e.l+t,a=e.read_shift(2),s=e.read_shift(2);return e.l=r,{ixfe:a,numFmtId:s}}function oo(e,t,r){r||(r=Y(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var a=0;return r.write_shift(1,a),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function Oa(e,t){return t||(t=Y(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var Xu=Pr;function Ku(e,t){return t||(t=Y(51)),t.write_shift(1,0),Oa(null,t),Oa(null,t),Oa(null,t),Oa(null,t),Oa(null,t),t.length>t.l?t.slice(0,t.l):t}function Yu(e,t){return t||(t=Y(12+4*10)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),Ms(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function Ju(e,t,r){var a=Y(2052);return a.write_shift(4,e),Ms(t,a),Ms(r,a),a.length>a.l?a.slice(0,a.l):a}function qu(e,t,r){var a={};a.NumberFmt=[];for(var s in Ie)a.NumberFmt[s]=Ie[s];a.CellXf=[],a.Fonts=[];var n=[],i=!1;return Dt(e,function(l,f,d){switch(d){case 44:a.NumberFmt[l[0]]=l[1],Ft(l[1],l[0]);break;case 43:a.Fonts.push(l),l.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(l.color.rgb=Ws(t.themeElements.clrScheme[l.color.theme].rgb,l.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:n[n.length-1]==617&&a.CellXf.push(l);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:n.push(d),i=!0;break;case 38:n.pop(),i=!1;break;default:if(f.T>0)n.push(d);else if(f.T<0)n.pop();else if(!i||r.WTF&&n[n.length-1]!=37)throw new Error("Unexpected record 0x"+d.toString(16))}}),a}function Zu(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var s=a[0];s<=a[1];++s)t[s]!=null&&++r}),r!=0&&(ne(e,615,gt(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var s=a[0];s<=a[1];++s)t[s]!=null&&ne(e,44,Wu(s,t[s]))}),ne(e,616))}}function Qu(e){var t=1;ne(e,611,gt(t)),ne(e,43,Vu({sz:12,color:{theme:1},name:"Calibri",family:2})),ne(e,612)}function ex(e){var t=2;ne(e,603,gt(t)),ne(e,45,ui({patternType:"none"})),ne(e,45,ui({patternType:"gray125"})),ne(e,604)}function rx(e){var t=1;ne(e,613,gt(t)),ne(e,46,Ku()),ne(e,614)}function tx(e){var t=1;ne(e,626,gt(t)),ne(e,47,oo({numFmtId:0},65535)),ne(e,627)}function ax(e,t){ne(e,617,gt(t.length)),t.forEach(function(r){ne(e,47,oo(r,0))}),ne(e,618)}function sx(e){var t=1;ne(e,619,gt(t)),ne(e,48,Yu({xfId:0,name:"Normal"})),ne(e,620)}function nx(e){var t=0;ne(e,505,gt(t)),ne(e,506)}function ix(e){var t=0;ne(e,508,Ju(t,"TableStyleMedium9","PivotStyleMedium4")),ne(e,509)}function cx(e,t){var r=Gr();return ne(r,278),Zu(r,e.SSF),Qu(r),ex(r),rx(r),tx(r),ax(r,t.cellXfs),sx(r),nx(r),ix(r),ne(r,279),r.end()}var ox=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function lx(e,t,r){t.themeElements.clrScheme=[];var a={};(e[0].match(Br)||[]).forEach(function(s){var n=Me(s);switch(n[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":a.rgb=n.val;break;case"<a:sysClr":a.rgb=n.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":n[0].charAt(1)==="/"?(t.themeElements.clrScheme[ox.indexOf(n[0])]=a,a={}):a.name=n[0].slice(3,n[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+n[0]+" in clrScheme")}})}function fx(){}function dx(){}var hx=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,ux=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,xx=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function mx(e,t,r){t.themeElements={};var a;[["clrScheme",hx,lx],["fontScheme",ux,fx],["fmtScheme",xx,dx]].forEach(function(s){if(!(a=e.match(s[1])))throw new Error(s[0]+" not found in themeElements");s[2](a,t,r)})}var gx=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function lo(e,t){(!e||e.length===0)&&(e=o0());var r,a={};if(!(r=e.match(gx)))throw new Error("themeElements not found in theme");return mx(r[0],a,t),a.raw=e,a}function o0(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[vr];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function px(e,t,r){var a=e.l+t,s=e.read_shift(4);if(s!==124226){if(!r.cellStyles){e.l=a;return}var n=e.slice(e.l);e.l=a;var i;try{i=rc(n,{type:"array"})}catch{return}var c=Zr(i,"theme/theme/theme1.xml",!0);if(c)return lo(c,r)}}function vx(e){return e.read_shift(4)}function wx(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=kx(e,4);break;case 2:t.xclrValue=Hc(e);break;case 3:t.xclrValue=vx(e);break;case 4:e.l+=4;break}return e.l+=8,t}function kx(e,t){return Pr(e,t)}function _x(e,t){return Pr(e,t)}function yx(e){var t=e.read_shift(2),r=e.read_shift(2)-4,a=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:a[1]=wx(e);break;case 6:a[1]=_x(e,r);break;case 14:case 15:a[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return a}function bx(e,t){var r=e.l+t;e.l+=2;var a=e.read_shift(2);e.l+=2;for(var s=e.read_shift(2),n=[];s-- >0;)n.push(yx(e,r-e.l));return{ixfe:a,ext:n}}function Ex(e,t){t.forEach(function(r){switch(r[0]){}})}function Sx(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Mr(e)}}function Tx(e){var t=Y(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),Nr(e.name,t),t.slice(0,t.l)}function Nx(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function Fx(e){var t=Y(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function Cx(e,t){var r=Y(8+2*t.length);return r.write_shift(4,e),Nr(t,r),r.slice(0,r.l)}function Ax(e){return e.l+=4,e.read_shift(4)!=0}function jx(e,t){var r=Y(8);return r.write_shift(4,e),r.write_shift(4,1),r}function Dx(e,t,r){var a={Types:[],Cell:[],Value:[]},s=r||{},n=[],i=!1,c=2;return Dt(e,function(l,f,d){switch(d){case 335:a.Types.push({name:l.name});break;case 51:l.forEach(function(u){c==1?a.Cell.push({type:a.Types[u[0]-1].name,index:u[1]}):c==0&&a.Value.push({type:a.Types[u[0]-1].name,index:u[1]})});break;case 337:c=l?1:0;break;case 338:c=2;break;case 35:n.push(d),i=!0;break;case 36:n.pop(),i=!1;break;default:if(!f.T){if(!i||s.WTF&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}}),a}function Ix(){var e=Gr();return ne(e,332),ne(e,334,gt(1)),ne(e,335,Tx({name:"XLDAPR",version:12e4,flags:3496657072})),ne(e,336),ne(e,339,Cx(1,"XLDAPR")),ne(e,52),ne(e,35,gt(514)),ne(e,4096,gt(0)),ne(e,4097,nt(1)),ne(e,36),ne(e,53),ne(e,340),ne(e,337,jx(1)),ne(e,51,Fx([[1,0]])),ne(e,338),ne(e,333),e.end()}function Ox(e,t,r){var a={Types:[],Cell:[],Value:[]};if(!e)return a;var s=!1,n=2,i;return e.replace(Br,function(c){var l=Me(c);switch(yt(l[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":a.Types.push({name:l.name});break;case"</metadataType>":break;case"<futureMetadata":for(var f=0;f<a.Types.length;++f)a.Types[f].name==l.name&&(i=a.Types[f]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":n==1?a.Cell.push({type:a.Types[l.t-1].name,index:+l.v}):n==0&&a.Value.push({type:a.Types[l.t-1].name,index:+l.v});break;case"</rc>":break;case"<cellMetadata":n=1;break;case"</cellMetadata>":n=2;break;case"<valueMetadata":n=0;break;case"</valueMetadata>":n=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<rvb":if(!i)break;i.offsets||(i.offsets=[]),i.offsets.push(+l.i);break;default:if(!s&&r.WTF)throw new Error("unrecognized "+l[0]+" in metadata")}return c}),a}function fo(){var e=[vr];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function Lx(e){var t=[];if(!e)return t;var r=1;return(e.match(Br)||[]).forEach(function(a){var s=Me(a);switch(s[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete s[0],s.i?r=s.i:s.i=r,t.push(s);break}}),t}function Rx(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=Le(r);var a=e.read_shift(1);return a&2&&(t.l="1"),a&8&&(t.a="1"),t}function Mx(e,t,r){var a=[];return Dt(e,function(n,i,c){switch(c){case 63:a.push(n);break;default:if(!i.T)throw new Error("Unexpected record 0x"+c.toString(16))}}),a}function Px(e,t,r,a){if(!e)return e;var s=a||{},n=!1;Dt(e,function(c,l,f){switch(f){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:n=!0;break;case 36:n=!1;break;default:if(!l.T){if(!n||s.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}},s)}function Bx(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}var va=1024;function ho(e,t){for(var r=[21600,21600],a=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),s=[xe("xml",null,{"xmlns:v":Yr.v,"xmlns:o":Yr.o,"xmlns:x":Yr.x,"xmlns:mv":Yr.mv}).replace(/\/>/,">"),xe("o:shapelayout",xe("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),xe("v:shapetype",[xe("v:stroke",null,{joinstyle:"miter"}),xe("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:a})];va<e*1e3;)va+=1e3;return t.forEach(function(n){var i=dr(n[0]),c={color2:"#BEFF82",type:"gradient"};c.type=="gradient"&&(c.angle="-180");var l=c.type=="gradient"?xe("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,f=xe("v:fill",l,c),d={on:"t",obscured:"t"};++va,s=s.concat(["<v:shape"+Ja({id:"_x0000_s"+va,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(n[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",f,xe("v:shadow",null,d),xe("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Ar("x:Anchor",[i.c+1,0,i.r+1,0,i.c+3,20,i.r+5,20].join(",")),Ar("x:AutoFill","False"),Ar("x:Row",String(i.r)),Ar("x:Column",String(i.c)),n[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),s.push("</xml>"),s.join("")}function xi(e,t,r,a){var s=Array.isArray(e),n;t.forEach(function(i){var c=dr(i.ref);if(s?(e[c.r]||(e[c.r]=[]),n=e[c.r][c.c]):n=e[i.ref],!n){n={t:"z"},s?e[c.r][c.c]=n:e[i.ref]=n;var l=Xe(e["!ref"]||"BDWGO1000001:A1");l.s.r>c.r&&(l.s.r=c.r),l.e.r<c.r&&(l.e.r=c.r),l.s.c>c.c&&(l.s.c=c.c),l.e.c<c.c&&(l.e.c=c.c);var f=We(l);f!==e["!ref"]&&(e["!ref"]=f)}n.c||(n.c=[]);var d={a:i.author,t:i.t,r:i.r,T:r};i.h&&(d.h=i.h);for(var u=n.c.length-1;u>=0;--u){if(!r&&n.c[u].T)return;r&&!n.c[u].T&&n.c.splice(u,1)}if(r&&a){for(u=0;u<a.length;++u)if(d.a==a[u].id){d.a=a[u].name||d.a;break}}n.c.push(d)})}function Ux(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],a=[],s=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);s&&s[1]&&s[1].split(/<\/\w*:?author>/).forEach(function(i){if(!(i===""||i.trim()==="")){var c=i.match(/<(?:\w+:)?author[^>]*>(.*)/);c&&r.push(c[1])}});var n=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return n&&n[1]&&n[1].split(/<\/\w*:?comment>/).forEach(function(i){if(!(i===""||i.trim()==="")){var c=i.match(/<(?:\w+:)?comment[^>]*>/);if(c){var l=Me(c[0]),f={author:l.authorId&&r[l.authorId]||"sheetjsghost",ref:l.ref,guid:l.guid},d=dr(l.ref);if(!(t.sheetRows&&t.sheetRows<=d.r)){var u=i.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),h=!!u&&!!u[1]&&n0(u[1])||{r:"",t:"",h:""};f.r=h.r,h.r=="<t></t>"&&(h.t=h.h=""),f.t=(h.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(f.h=h.h),a.push(f)}}}}),a}function uo(e){var t=[vr,xe("comments",null,{xmlns:ca[0]})],r=[];return t.push("<authors>"),e.forEach(function(a){a[1].forEach(function(s){var n=er(s.a);r.indexOf(n)==-1&&(r.push(n),t.push("<author>"+n+"</author>")),s.T&&s.ID&&r.indexOf("tc="+s.ID)==-1&&(r.push("tc="+s.ID),t.push("<author>tc="+s.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(a){var s=0,n=[];if(a[1][0]&&a[1][0].T&&a[1][0].ID?s=r.indexOf("tc="+a[1][0].ID):a[1].forEach(function(l){l.a&&(s=r.indexOf(er(l.a))),n.push(l.t||"")}),t.push('<comment ref="'+a[0]+'" authorId="'+s+'"><text>'),n.length<=1)t.push(Ar("t",er(n[0]||"")));else{for(var i=`Comment:
    `+n[0]+`
`,c=1;c<n.length;++c)i+=`Reply:
    `+n[c]+`
`;t.push(Ar("t",er(i)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function Wx(e,t){var r=[],a=!1,s={},n=0;return e.replace(Br,function(c,l){var f=Me(c);switch(yt(f[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":s={author:f.personId,guid:f.id,ref:f.ref,T:1};break;case"</threadedComment>":s.t!=null&&r.push(s);break;case"<text>":case"<text":n=l+c.length;break;case"</text>":s.t=e.slice(n,l).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":a=!0;break;case"</mentions>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(!a&&t.WTF)throw new Error("unrecognized "+f[0]+" in threaded comments")}return c}),r}function Hx(e,t,r){var a=[vr,xe("ThreadedComments",null,{xmlns:yr.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(s){var n="";(s[1]||[]).forEach(function(i,c){if(!i.T){delete i.ID;return}i.a&&t.indexOf(i.a)==-1&&t.push(i.a);var l={ref:s[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};c==0?n=l.id:l.parentId=n,i.ID=l.id,i.a&&(l.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(i.a)).slice(-12)+"}"),a.push(xe("threadedComment",Ar("text",i.t||""),l))})}),a.push("</ThreadedComments>"),a.join("")}function Vx(e,t){var r=[],a=!1;return e.replace(Br,function(n){var i=Me(n);switch(yt(i[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:i.displayname,id:i.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(!a&&t.WTF)throw new Error("unrecognized "+i[0]+" in threaded comments")}return n}),r}function $x(e){var t=[vr,xe("personList",null,{xmlns:yr.TCMNT,"xmlns:x":ca[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,a){t.push(xe("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+a).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function zx(e){var t={};t.iauthor=e.read_shift(4);var r=da(e);return t.rfx=r.s,t.ref=Le(r.s),e.l+=16,t}function Gx(e,t){return t==null&&(t=Y(36)),t.write_shift(4,e[1].iauthor),Aa(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var Xx=Mr;function Kx(e){return Nr(e.slice(0,54))}function Yx(e,t){var r=[],a=[],s={},n=!1;return Dt(e,function(c,l,f){switch(f){case 632:a.push(c);break;case 635:s=c;break;case 637:s.t=c.t,s.h=c.h,s.r=c.r;break;case 636:if(s.author=a[s.iauthor],delete s.iauthor,t.sheetRows&&s.rfx&&t.sheetRows<=s.rfx.r)break;s.t||(s.t=""),delete s.rfx,r.push(s);break;case 3072:break;case 35:n=!0;break;case 36:n=!1;break;case 37:break;case 38:break;default:if(!l.T){if(!n||t.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}}),r}function Jx(e){var t=Gr(),r=[];return ne(t,628),ne(t,630),e.forEach(function(a){a[1].forEach(function(s){r.indexOf(s.a)>-1||(r.push(s.a.slice(0,54)),ne(t,632,Kx(s.a)))})}),ne(t,631),ne(t,633),e.forEach(function(a){a[1].forEach(function(s){s.iauthor=r.indexOf(s.a);var n={s:dr(a[0]),e:dr(a[0])};ne(t,635,Gx([n,s])),s.t&&s.t.length>0&&ne(t,637,vf(s)),ne(t,636),delete s.iauthor})}),ne(t,634),ne(t,629),t.end()}var qx="application/vnd.ms-office.vbaProject";function Zx(e){var t=Ae.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,a){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var s=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Ae.utils.cfb_add(t,s,e.FileIndex[a].content)}}),Ae.write(t)}function Qx(e,t){t.FullPaths.forEach(function(r,a){if(a!=0){var s=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");s.slice(-1)!=="/"&&Ae.utils.cfb_add(e,s,t.FileIndex[a].content)}})}var xo=["xlsb","xlsm","xlam","biff8","xla"];function e1(){return{"!type":"dialog"}}function r1(){return{"!type":"dialog"}}function t1(){return{"!type":"macro"}}function a1(){return{"!type":"macro"}}var _a=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(a,s,n,i){var c=!1,l=!1;n.length==0?l=!0:n.charAt(0)=="["&&(l=!0,n=n.slice(1,-1)),i.length==0?c=!0:i.charAt(0)=="["&&(c=!0,i=i.slice(1,-1));var f=n.length>0?parseInt(n,10)|0:0,d=i.length>0?parseInt(i,10)|0:0;return c?d+=t.c:--d,l?f+=t.r:--f,s+(c?"":"$")+fr(d)+(l?"":"$")+pr(f)}return function(s,n){return t=n,s.replace(e,r)}}(),l0=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,f0=function(){return function(t,r){return t.replace(l0,function(a,s,n,i,c,l){var f=Jn(i)-(n?0:r.c),d=Yn(l)-(c?0:r.r),u=d==0?"":c?d+1:"["+d+"]",h=f==0?"":n?f+1:"["+f+"]";return s+"R"+u+"C"+h})}}();function mo(e,t){return e.replace(l0,function(r,a,s,n,i,c){return a+(s=="$"?s+n:fr(Jn(n)+t.c))+(i=="$"?i+c:pr(Yn(c)+t.r))})}function s1(e,t,r){var a=Xr(t),s=a.s,n=dr(r),i={r:n.r-s.r,c:n.c-s.c};return mo(e,i)}function n1(e){return e.length!=1}function mi(e){return e.replace(/_xlfn\./g,"")}function wr(e){e.l+=1}function Ut(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function go(e,t,r){var a=2;if(r){if(r.biff>=2&&r.biff<=5)return po(e);r.biff==12&&(a=4)}var s=e.read_shift(a),n=e.read_shift(a),i=Ut(e),c=Ut(e);return{s:{r:s,c:i[0],cRel:i[1],rRel:i[2]},e:{r:n,c:c[0],cRel:c[1],rRel:c[2]}}}function po(e){var t=Ut(e),r=Ut(e),a=e.read_shift(1),s=e.read_shift(1);return{s:{r:t[0],c:a,cRel:t[1],rRel:t[2]},e:{r:r[0],c:s,cRel:r[1],rRel:r[2]}}}function i1(e,t,r){if(r.biff<8)return po(e);var a=e.read_shift(r.biff==12?4:2),s=e.read_shift(r.biff==12?4:2),n=Ut(e),i=Ut(e);return{s:{r:a,c:n[0],cRel:n[1],rRel:n[2]},e:{r:s,c:i[0],cRel:i[1],rRel:i[2]}}}function vo(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return c1(e);var a=e.read_shift(r&&r.biff==12?4:2),s=Ut(e);return{r:a,c:s[0],cRel:s[1],rRel:s[2]}}function c1(e){var t=Ut(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function o1(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function l1(e,t,r){var a=r&&r.biff?r.biff:8;if(a>=2&&a<=5)return f1(e);var s=e.read_shift(a>=12?4:2),n=e.read_shift(2),i=(n&16384)>>14,c=(n&32768)>>15;if(n&=16383,c==1)for(;s>524287;)s-=1048576;if(i==1)for(;n>8191;)n=n-16384;return{r:s,c:n,cRel:i,rRel:c}}function f1(e){var t=e.read_shift(2),r=e.read_shift(1),a=(t&32768)>>15,s=(t&16384)>>14;return t&=16383,a==1&&t>=8192&&(t=t-16384),s==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:s,rRel:a}}function d1(e,t,r){var a=(e[e.l++]&96)>>5,s=go(e,r.biff>=2&&r.biff<=5?6:8,r);return[a,s]}function h1(e,t,r){var a=(e[e.l++]&96)>>5,s=e.read_shift(2,"i"),n=8;if(r)switch(r.biff){case 5:e.l+=12,n=6;break;case 12:n=12;break}var i=go(e,n,r);return[a,s,i]}function u1(e,t,r){var a=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[a]}function x1(e,t,r){var a=(e[e.l++]&96)>>5,s=e.read_shift(2),n=8;if(r)switch(r.biff){case 5:e.l+=12,n=6;break;case 12:n=12;break}return e.l+=n,[a,s]}function m1(e,t,r){var a=(e[e.l++]&96)>>5,s=i1(e,t-1,r);return[a,s]}function g1(e,t,r){var a=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[a]}function gi(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function p1(e,t,r){e.l+=2;for(var a=e.read_shift(r&&r.biff==2?1:2),s=[],n=0;n<=a;++n)s.push(e.read_shift(r&&r.biff==2?1:2));return s}function v1(e,t,r){var a=e[e.l+1]&255?1:0;return e.l+=2,[a,e.read_shift(r&&r.biff==2?1:2)]}function w1(e,t,r){var a=e[e.l+1]&255?1:0;return e.l+=2,[a,e.read_shift(r&&r.biff==2?1:2)]}function k1(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function _1(e,t,r){var a=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[a]}function wo(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function y1(e){return e.read_shift(2),wo(e)}function b1(e){return e.read_shift(2),wo(e)}function E1(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var s=vo(e,0,r);return[a,s]}function S1(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var s=l1(e,0,r);return[a,s]}function T1(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var n=vo(e,0,r);return[a,s,n]}function N1(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(r&&r.biff<=3?1:2);return[Am[s],yo[s],a]}function F1(e,t,r){var a=e[e.l++],s=e.read_shift(1),n=r&&r.biff<=3?[a==88?-1:0,e.read_shift(1)]:C1(e);return[s,(n[0]===0?yo:Cm)[n[1]]]}function C1(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function A1(e,t,r){e.l+=r&&r.biff==2?3:4}function j1(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var a=e.read_shift(2),s=e.read_shift(r&&r.biff==2?1:2);return[a,s]}function D1(e){return e.l++,It[e.read_shift(1)]}function I1(e){return e.l++,e.read_shift(2)}function O1(e){return e.l++,e.read_shift(1)!==0}function L1(e){return e.l++,Rr(e)}function R1(e,t,r){return e.l++,ds(e,t-1,r)}function M1(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=gr(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=It[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=Rr(e);break;case 2:r[1]=ha(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function P1(e,t,r){for(var a=e.read_shift(r.biff==12?4:2),s=[],n=0;n!=a;++n)s.push((r.biff==12?da:Ys)(e));return s}function B1(e,t,r){var a=0,s=0;r.biff==12?(a=e.read_shift(4),s=e.read_shift(4)):(s=1+e.read_shift(1),a=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--a,--s==0&&(s=256));for(var n=0,i=[];n!=a&&(i[n]=[]);++n)for(var c=0;c!=s;++c)i[n][c]=M1(e,r.biff);return i}function U1(e,t,r){var a=e.read_shift(1)>>>5&3,s=!r||r.biff>=8?4:2,n=e.read_shift(s);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[a,0,n]}function W1(e,t,r){if(r.biff==5)return H1(e);var a=e.read_shift(1)>>>5&3,s=e.read_shift(2),n=e.read_shift(4);return[a,s,n]}function H1(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var a=e.read_shift(2);return e.l+=12,[t,r,a]}function V1(e,t,r){var a=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var s=e.read_shift(r&&r.biff==2?1:2);return[a,s]}function $1(e,t,r){var a=e.read_shift(1)>>>5&3,s=e.read_shift(r&&r.biff==2?1:2);return[a,s]}function z1(e,t,r){var a=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[a]}function G1(e,t,r){var a=(e[e.l++]&96)>>5,s=e.read_shift(2),n=4;if(r)switch(r.biff){case 5:n=15;break;case 12:n=6;break}return e.l+=n,[a,s]}var X1=Pr,K1=Pr,Y1=Pr;function us(e,t,r){return e.l+=2,[o1(e)]}function d0(e){return e.l+=6,[]}var J1=us,q1=d0,Z1=d0,Q1=us;function ko(e){return e.l+=2,[_r(e),e.read_shift(2)&1]}var em=us,rm=ko,tm=d0,am=us,sm=us,nm=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function im(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(4),s=e.read_shift(2),n=e.read_shift(2),i=nm[r>>2&31];return{ixti:t,coltype:r&3,rt:i,idx:a,c:s,C:n}}function cm(e){return e.l+=2,[e.read_shift(4)]}function om(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function lm(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function fm(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function dm(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function hm(e){return e.l+=4,[0,0]}var pi={1:{n:"PtgExp",f:j1},2:{n:"PtgTbl",f:Y1},3:{n:"PtgAdd",f:wr},4:{n:"PtgSub",f:wr},5:{n:"PtgMul",f:wr},6:{n:"PtgDiv",f:wr},7:{n:"PtgPower",f:wr},8:{n:"PtgConcat",f:wr},9:{n:"PtgLt",f:wr},10:{n:"PtgLe",f:wr},11:{n:"PtgEq",f:wr},12:{n:"PtgGe",f:wr},13:{n:"PtgGt",f:wr},14:{n:"PtgNe",f:wr},15:{n:"PtgIsect",f:wr},16:{n:"PtgUnion",f:wr},17:{n:"PtgRange",f:wr},18:{n:"PtgUplus",f:wr},19:{n:"PtgUminus",f:wr},20:{n:"PtgPercent",f:wr},21:{n:"PtgParen",f:wr},22:{n:"PtgMissArg",f:wr},23:{n:"PtgStr",f:R1},26:{n:"PtgSheet",f:om},27:{n:"PtgEndSheet",f:lm},28:{n:"PtgErr",f:D1},29:{n:"PtgBool",f:O1},30:{n:"PtgInt",f:I1},31:{n:"PtgNum",f:L1},32:{n:"PtgArray",f:g1},33:{n:"PtgFunc",f:N1},34:{n:"PtgFuncVar",f:F1},35:{n:"PtgName",f:U1},36:{n:"PtgRef",f:E1},37:{n:"PtgArea",f:d1},38:{n:"PtgMemArea",f:V1},39:{n:"PtgMemErr",f:X1},40:{n:"PtgMemNoMem",f:K1},41:{n:"PtgMemFunc",f:$1},42:{n:"PtgRefErr",f:z1},43:{n:"PtgAreaErr",f:u1},44:{n:"PtgRefN",f:S1},45:{n:"PtgAreaN",f:m1},46:{n:"PtgMemAreaN",f:fm},47:{n:"PtgMemNoMemN",f:dm},57:{n:"PtgNameX",f:W1},58:{n:"PtgRef3d",f:T1},59:{n:"PtgArea3d",f:h1},60:{n:"PtgRefErr3d",f:G1},61:{n:"PtgAreaErr3d",f:x1},255:{}},um={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},xm={1:{n:"PtgElfLel",f:ko},2:{n:"PtgElfRw",f:am},3:{n:"PtgElfCol",f:J1},6:{n:"PtgElfRwV",f:sm},7:{n:"PtgElfColV",f:Q1},10:{n:"PtgElfRadical",f:em},11:{n:"PtgElfRadicalS",f:tm},13:{n:"PtgElfColS",f:q1},15:{n:"PtgElfColSV",f:Z1},16:{n:"PtgElfRadicalLel",f:rm},25:{n:"PtgList",f:im},29:{n:"PtgSxName",f:cm},255:{}},mm={0:{n:"PtgAttrNoop",f:hm},1:{n:"PtgAttrSemi",f:_1},2:{n:"PtgAttrIf",f:w1},4:{n:"PtgAttrChoose",f:p1},8:{n:"PtgAttrGoto",f:v1},16:{n:"PtgAttrSum",f:A1},32:{n:"PtgAttrBaxcel",f:gi},33:{n:"PtgAttrBaxcel",f:gi},64:{n:"PtgAttrSpace",f:y1},65:{n:"PtgAttrSpaceSemi",f:b1},128:{n:"PtgAttrIfError",f:k1},255:{}};function xs(e,t,r,a){if(a.biff<8)return Pr(e,t);for(var s=e.l+t,n=[],i=0;i!==r.length;++i)switch(r[i][0]){case"PtgArray":r[i][1]=B1(e,0,a),n.push(r[i][1]);break;case"PtgMemArea":r[i][2]=P1(e,r[i][1],a),n.push(r[i][2]);break;case"PtgExp":a&&a.biff==12&&(r[i][1][1]=e.read_shift(4),n.push(r[i][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[i][0]}return t=s-e.l,t!==0&&n.push(Pr(e,t)),n}function ms(e,t,r){for(var a=e.l+t,s,n,i=[];a!=e.l;)t=a-e.l,n=e[e.l],s=pi[n]||pi[um[n]],(n===24||n===25)&&(s=(n===24?xm:mm)[e[e.l+1]]),!s||!s.f?Pr(e,t):i.push([s.n,s.f(e,t,r)]);return i}function gm(e){for(var t=[],r=0;r<e.length;++r){for(var a=e[r],s=[],n=0;n<a.length;++n){var i=a[n];if(i)switch(i[0]){case 2:s.push('"'+i[1].replace(/"/g,'""')+'"');break;default:s.push(i[1])}else s.push("")}t.push(s.join(","))}return t.join(";")}var pm={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function vm(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function _o(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var a=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!a)return"SH33TJSERR1";var s="";if(r.biff>8)switch(e[a[0]][0]){case 357:return s=a[1]==-1?"#REF":e.SheetNames[a[1]],a[1]==a[2]?s:s+":"+e.SheetNames[a[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[a[0]][0];case 355:default:return"SH33TJSSRC"+e[a[0]][0]}switch(e[a[0]][0][0]){case 1025:return s=a[1]==-1?"#REF":e.SheetNames[a[1]]||"SH33TJSERR3",a[1]==a[2]?s:s+":"+e.SheetNames[a[2]];case 14849:return e[a[0]].slice(1).map(function(n){return n.Name}).join(";;");default:return e[a[0]][0][3]?(s=a[1]==-1?"#REF":e[a[0]][0][3][a[1]]||"SH33TJSERR4",a[1]==a[2]?s:s+":"+e[a[0]][0][3][a[2]]):"SH33TJSERR2"}}function vi(e,t,r){var a=_o(e,t,r);return a=="#REF"?a:vm(a,r)}function Or(e,t,r,a,s){var n=s&&s.biff||8,i={s:{c:0,r:0}},c=[],l,f,d,u=0,h=0,m,g="";if(!e[0]||!e[0][0])return"";for(var x=-1,p="",k=0,b=e[0].length;k<b;++k){var w=e[0][k];switch(w[0]){case"PtgUminus":c.push("-"+c.pop());break;case"PtgUplus":c.push("+"+c.pop());break;case"PtgPercent":c.push(c.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=c.pop(),f=c.pop(),x>=0){switch(e[0][x][1][0]){case 0:p=ur(" ",e[0][x][1][1]);break;case 1:p=ur("\r",e[0][x][1][1]);break;default:if(p="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][x][1][0])}f=f+p,x=-1}c.push(f+pm[w[0]]+l);break;case"PtgIsect":l=c.pop(),f=c.pop(),c.push(f+" "+l);break;case"PtgUnion":l=c.pop(),f=c.pop(),c.push(f+","+l);break;case"PtgRange":l=c.pop(),f=c.pop(),c.push(f+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":d=Ba(w[1][1],i,s),c.push(Ua(d,n));break;case"PtgRefN":d=r?Ba(w[1][1],r,s):w[1][1],c.push(Ua(d,n));break;case"PtgRef3d":u=w[1][1],d=Ba(w[1][2],i,s),g=vi(a,u,s),c.push(g+"!"+Ua(d,n));break;case"PtgFunc":case"PtgFuncVar":var j=w[1][0],R=w[1][1];j||(j=0),j&=127;var I=j==0?[]:c.slice(-j);c.length-=j,R==="User"&&(R=I.shift()),c.push(R+"("+I.join(",")+")");break;case"PtgBool":c.push(w[1]?"TRUE":"FALSE");break;case"PtgInt":c.push(w[1]);break;case"PtgNum":c.push(String(w[1]));break;case"PtgStr":c.push('"'+w[1].replace(/"/g,'""')+'"');break;case"PtgErr":c.push(w[1]);break;case"PtgAreaN":m=X0(w[1][1],r?{s:r}:i,s),c.push(nn(m,s));break;case"PtgArea":m=X0(w[1][1],i,s),c.push(nn(m,s));break;case"PtgArea3d":u=w[1][1],m=w[1][2],g=vi(a,u,s),c.push(g+"!"+nn(m,s));break;case"PtgAttrSum":c.push("SUM("+c.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":h=w[1][2];var E=(a.names||[])[h-1]||(a[0]||[])[h],U=E?E.Name:"SH33TJSNAME"+String(h);U&&U.slice(0,6)=="_xlfn."&&!s.xlfn&&(U=U.slice(6)),c.push(U);break;case"PtgNameX":var N=w[1][1];h=w[1][2];var B;if(s.biff<=5)N<0&&(N=-N),a[N]&&(B=a[N][h]);else{var L="";if(((a[N]||[])[0]||[])[0]==14849||(((a[N]||[])[0]||[])[0]==1025?a[N][h]&&a[N][h].itab>0&&(L=a.SheetNames[a[N][h].itab-1]+"!"):L=a.SheetNames[h-1]+"!"),a[N]&&a[N][h])L+=a[N][h].Name;else if(a[0]&&a[0][h])L+=a[0][h].Name;else{var P=(_o(a,N,s)||"").split(";;");P[h-1]?L=P[h-1]:L+="SH33TJSERRX"}c.push(L);break}B||(B={Name:"SH33TJSERRY"}),c.push(B.Name);break;case"PtgParen":var Q="(",fe=")";if(x>=0){switch(p="",e[0][x][1][0]){case 2:Q=ur(" ",e[0][x][1][1])+Q;break;case 3:Q=ur("\r",e[0][x][1][1])+Q;break;case 4:fe=ur(" ",e[0][x][1][1])+fe;break;case 5:fe=ur("\r",e[0][x][1][1])+fe;break;default:if(s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][x][1][0])}x=-1}c.push(Q+c.pop()+fe);break;case"PtgRefErr":c.push("#REF!");break;case"PtgRefErr3d":c.push("#REF!");break;case"PtgExp":d={c:w[1][1],r:w[1][0]};var ie={c:r.c,r:r.r};if(a.sharedf[Le(d)]){var pe=a.sharedf[Le(d)];c.push(Or(pe,i,ie,a,s))}else{var he=!1;for(l=0;l!=a.arrayf.length;++l)if(f=a.arrayf[l],!(d.c<f[0].s.c||d.c>f[0].e.c)&&!(d.r<f[0].s.r||d.r>f[0].e.r)){c.push(Or(f[1],i,ie,a,s)),he=!0;break}he||c.push(w[1])}break;case"PtgArray":c.push("{"+gm(w[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":x=k;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":c.push("");break;case"PtgAreaErr":c.push("#REF!");break;case"PtgAreaErr3d":c.push("#REF!");break;case"PtgList":c.push("Table"+w[1].idx+"[#"+w[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(w));default:throw new Error("Unrecognized Formula Token: "+String(w))}var Ve=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(s.biff!=3&&x>=0&&Ve.indexOf(e[0][k][0])==-1){w=e[0][x];var H=!0;switch(w[1][0]){case 4:H=!1;case 0:p=ur(" ",w[1][1]);break;case 5:H=!1;case 1:p=ur("\r",w[1][1]);break;default:if(p="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+w[1][0])}c.push((H?p:"")+c.pop()+(H?"":p)),x=-1}}if(c.length>1&&s.WTF)throw new Error("bad formula stack");return c[0]}function wm(e,t,r){var a=e.l+t,s=r.biff==2?1:2,n,i=e.read_shift(s);if(i==65535)return[[],Pr(e,t-2)];var c=ms(e,i,r);return t!==i+s&&(n=xs(e,t-i-s,c,r)),e.l=a,[c,n]}function km(e,t,r){var a=e.l+t,s=r.biff==2?1:2,n,i=e.read_shift(s);if(i==65535)return[[],Pr(e,t-2)];var c=ms(e,i,r);return t!==i+s&&(n=xs(e,t-i-s,c,r)),e.l=a,[c,n]}function _m(e,t,r,a){var s=e.l+t,n=ms(e,a,r),i;return s!==e.l&&(i=xs(e,s-e.l,n,r)),[n,i]}function ym(e,t,r){var a=e.l+t,s,n=e.read_shift(2),i=ms(e,n,r);return n==65535?[[],Pr(e,t-2)]:(t!==n+2&&(s=xs(e,a-n-2,i,r)),[i,s])}function bm(e){var t;if(Tt(e,e.l+6)!==65535)return[Rr(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function Em(e){if(e==null){var t=Y(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return aa(e);return aa(0)}function dn(e,t,r){var a=e.l+t,s=bt(e);r.biff==2&&++e.l;var n=bm(e),i=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var c=km(e,a-e.l,r);return{cell:s,val:n[0],formula:c,shared:i>>3&1,tt:n[1]}}function Sm(e,t,r,a,s){var n=na(t,r,s),i=Em(e.v),c=Y(6),l=33;c.write_shift(2,l),c.write_shift(4,0);for(var f=Y(e.bf.length),d=0;d<e.bf.length;++d)f[d]=e.bf[d];var u=Tr([n,i,c,f]);return u}function Js(e,t,r){var a=e.read_shift(4),s=ms(e,a,r),n=e.read_shift(4),i=n>0?xs(e,n,s,r):null;return[s,i]}var Tm=Js,qs=Js,Nm=Js,Fm=Js,Cm={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},yo={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},Am={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function wi(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function jm(e){var t="of:="+e.replace(l0,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function hn(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function Dm(e){return e.replace(/\./,"!")}var Ha={},ya={},Va=typeof Map<"u";function h0(e,t,r){var a=0,s=e.length;if(r){if(Va?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var n=Va?r.get(t):r[t];a<n.length;++a)if(e[n[a]].t===t)return e.Count++,n[a]}}else for(;a<s;++a)if(e[a].t===t)return e.Count++,a;return e[s]={t},e.Count++,e.Unique++,r&&(Va?(r.has(t)||r.set(t,[]),r.get(t).push(s)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(s))),s}function Zs(e,t){var r={min:e+1,max:e+1},a=-1;return t.MDW&&(Lr=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?a=rs(t.wpx):t.wch!=null&&(a=t.wch),a>-1?(r.width=Hs(a),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function ea(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function $t(e,t,r){var a=r.revssf[t.z!=null?t.z:"General"],s=60,n=e.length;if(a==null&&r.ssf){for(;s<392;++s)if(r.ssf[s]==null){Ft(t.z,s),r.ssf[s]=t.z,r.revssf[t.z]=a=s;break}}for(s=0;s!=n;++s)if(e[s].numFmtId===a)return s;return e[n]={numFmtId:a,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},n}function bo(e,t,r,a,s,n){try{a.cellNF&&(e.z=Ie[t])}catch(c){if(a.WTF)throw c}if(!(e.t==="z"&&!a.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=nr(e.v)),(!a||a.cellText!==!1)&&e.t!=="z")try{if(Ie[t]==null&&Ft(Fl[t]||"General",t),e.t==="e")e.w=e.w||It[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Ka(e.v);else if(e.t==="d"){var i=br(e.v);(i|0)===i?e.w=i.toString(10):e.w=Ka(i)}else{if(e.v===void 0)return"";e.w=ra(e.v,ya)}else e.t==="d"?e.w=ct(t,br(e.v),ya):e.w=ct(t,e.v,ya)}catch(c){if(a.WTF)throw c}if(a.cellStyles&&r!=null)try{e.s=n.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=Ws(s.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),a.WTF&&(e.s.fgColor.raw_rgb=s.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=Ws(s.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),a.WTF&&(e.s.bgColor.raw_rgb=s.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(c){if(a.WTF&&n.Fills)throw c}}}function Im(e,t,r){if(e&&e["!ref"]){var a=Xe(e["!ref"]);if(a.e.c<a.s.c||a.e.r<a.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function Om(e,t){var r=Xe(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=We(r))}var Lm=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,Rm=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,Mm=/<(?:\w:)?hyperlink [^>]*>/mg,Pm=/"(\w*:\w*)"/,Bm=/<(?:\w:)?col\b[^>]*[\/]?>/g,Um=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,Wm=/<(?:\w:)?pageMargins[^>]*\/>/g,Eo=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,Hm=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,Vm=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function $m(e,t,r,a,s,n,i){if(!e)return e;a||(a={"!id":{}});var c=t.dense?[]:{},l={s:{r:2e6,c:2e6},e:{r:0,c:0}},f="",d="",u=e.match(Rm);u?(f=e.slice(0,u.index),d=e.slice(u.index+u[0].length)):f=d=e;var h=f.match(Eo);h?u0(h[0],c,s,r):(h=f.match(Hm))&&Gm(h[0],h[1]||"",c,s,r);var m=(f.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(m>0){var g=f.slice(m,m+50).match(Pm);g&&Om(c,g[1])}var x=f.match(Vm);x&&x[1]&&ng(x[1],s);var p=[];if(t.cellStyles){var k=f.match(Bm);k&&eg(p,k)}u&&og(u[1],c,t,l,n,i);var b=d.match(Um);b&&(c["!autofilter"]=tg(b[0]));var w=[],j=d.match(Lm);if(j)for(m=0;m!=j.length;++m)w[m]=Xe(j[m].slice(j[m].indexOf('"')+1));var R=d.match(Mm);R&&qm(c,R,a);var I=d.match(Wm);if(I&&(c["!margins"]=Zm(Me(I[0]))),!c["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(c["!ref"]=We(l)),t.sheetRows>0&&c["!ref"]){var E=Xe(c["!ref"]);t.sheetRows<=+E.e.r&&(E.e.r=t.sheetRows-1,E.e.r>l.e.r&&(E.e.r=l.e.r),E.e.r<E.s.r&&(E.s.r=E.e.r),E.e.c>l.e.c&&(E.e.c=l.e.c),E.e.c<E.s.c&&(E.s.c=E.e.c),c["!fullref"]=c["!ref"],c["!ref"]=We(E))}return p.length>0&&(c["!cols"]=p),w.length>0&&(c["!merges"]=w),c}function zm(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+We(e[r])+'"/>';return t+"</mergeCells>"}function u0(e,t,r,a){var s=Me(e);r.Sheets[a]||(r.Sheets[a]={}),s.codeName&&(r.Sheets[a].CodeName=Ge(rr(s.codeName)))}function Gm(e,t,r,a,s){u0(e.slice(0,e.indexOf(">")),r,a,s)}function Xm(e,t,r,a,s){var n=!1,i={},c=null;if(a.bookType!=="xlsx"&&t.vbaraw){var l=t.SheetNames[r];try{t.Workbook&&(l=t.Workbook.Sheets[r].CodeName||l)}catch{}n=!0,i.codeName=_t(er(l))}if(e&&e["!outline"]){var f={summaryBelow:1,summaryRight:1};e["!outline"].above&&(f.summaryBelow=0),e["!outline"].left&&(f.summaryRight=0),c=(c||"")+xe("outlinePr",null,f)}!n&&!c||(s[s.length]=xe("sheetPr",c,i))}var Km=["objects","scenarios","selectLockedCells","selectUnlockedCells"],Ym=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function Jm(e){var t={sheet:1};return Km.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),Ym.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=i0(e.password).toString(16).toUpperCase()),xe("sheetProtection",null,t)}function qm(e,t,r){for(var a=Array.isArray(e),s=0;s!=t.length;++s){var n=Me(rr(t[s]),!0);if(!n.ref)return;var i=((r||{})["!id"]||[])[n.id];i?(n.Target=i.Target,n.location&&(n.Target+="#"+Ge(n.location))):(n.Target="#"+Ge(n.location),i={Target:n.Target,TargetMode:"Internal"}),n.Rel=i,n.tooltip&&(n.Tooltip=n.tooltip,delete n.tooltip);for(var c=Xe(n.ref),l=c.s.r;l<=c.e.r;++l)for(var f=c.s.c;f<=c.e.c;++f){var d=Le({c:f,r:l});a?(e[l]||(e[l]=[]),e[l][f]||(e[l][f]={t:"z",v:void 0}),e[l][f].l=n):(e[d]||(e[d]={t:"z",v:void 0}),e[d].l=n)}}}function Zm(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function Qm(e){return ea(e),xe("pageMargins",null,e)}function eg(e,t){for(var r=!1,a=0;a!=t.length;++a){var s=Me(t[a],!0);s.hidden&&(s.hidden=sr(s.hidden));var n=parseInt(s.min,10)-1,i=parseInt(s.max,10)-1;for(s.outlineLevel&&(s.level=+s.outlineLevel||0),delete s.min,delete s.max,s.width=+s.width,!r&&s.width&&(r=!0,c0(s.width)),Bt(s);n<=i;)e[n++]=ir(s)}}function rg(e,t){for(var r=["<cols>"],a,s=0;s!=t.length;++s)(a=t[s])&&(r[r.length]=xe("col",null,Zs(s,a)));return r[r.length]="</cols>",r.join("")}function tg(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}function ag(e,t,r,a){var s=typeof e.ref=="string"?e.ref:We(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var n=r.Workbook.Names,i=Xr(s);i.s.r==i.e.r&&(i.e.r=Xr(t["!ref"]).e.r,s=We(i));for(var c=0;c<n.length;++c){var l=n[c];if(l.Name=="_xlnm._FilterDatabase"&&l.Sheet==a){l.Ref="'"+r.SheetNames[a]+"'!"+s;break}}return c==n.length&&n.push({Name:"_xlnm._FilterDatabase",Sheet:a,Ref:"'"+r.SheetNames[a]+"'!"+s}),xe("autoFilter",null,{ref:s})}var sg=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function ng(e,t){t.Views||(t.Views=[{}]),(e.match(sg)||[]).forEach(function(r,a){var s=Me(r);t.Views[a]||(t.Views[a]={}),+s.zoomScale&&(t.Views[a].zoom=+s.zoomScale),sr(s.rightToLeft)&&(t.Views[a].RTL=!0)})}function ig(e,t,r,a){var s={workbookViewId:"0"};return(((a||{}).Workbook||{}).Views||[])[0]&&(s.rightToLeft=a.Workbook.Views[0].RTL?"1":"0"),xe("sheetViews",xe("sheetView",null,s),{})}function cg(e,t,r,a){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var s="",n=e.t,i=e.v;if(e.t!=="z")switch(e.t){case"b":s=e.v?"1":"0";break;case"n":s=""+e.v;break;case"e":s=It[e.v];break;case"d":a&&a.cellDates?s=nr(e.v,-1).toISOString():(e=ir(e),e.t="n",s=""+(e.v=br(nr(e.v)))),typeof e.z>"u"&&(e.z=Ie[14]);break;default:s=e.v;break}var c=Ar("v",er(s)),l={r:t},f=$t(a.cellXfs,e,a);switch(f!==0&&(l.s=f),e.t){case"n":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(a&&a.bookSST){c=Ar("v",""+h0(a.Strings,e.v,a.revStrings)),l.t="s";break}l.t="str";break}if(e.t!=n&&(e.t=n,e.v=i),typeof e.f=="string"&&e.f){var d=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;c=xe("f",er(e.f),d)+(e.v!=null?c:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(l.cm=1),xe("c",c,l)}var og=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,a=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,s=/ref=["']([^"']*)["']/,n=Ya("v"),i=Ya("f");return function(l,f,d,u,h,m){for(var g=0,x="",p=[],k=[],b=0,w=0,j=0,R="",I,E,U=0,N=0,B,L,P=0,Q=0,fe=Array.isArray(m.CellXf),ie,pe=[],he=[],Ve=Array.isArray(f),H=[],we={},Ee=!1,A=!!d.sheetStubs,M=l.split(t),D=0,O=M.length;D!=O;++D){x=M[D].trim();var W=x.length;if(W!==0){var ee=0;e:for(g=0;g<W;++g)switch(x[g]){case">":if(x[g-1]!="/"){++g;break e}if(d&&d.cellStyles){if(E=Me(x.slice(ee,g),!0),U=E.r!=null?parseInt(E.r,10):U+1,N=-1,d.sheetRows&&d.sheetRows<U)continue;we={},Ee=!1,E.ht&&(Ee=!0,we.hpt=parseFloat(E.ht),we.hpx=Sa(we.hpt)),E.hidden=="1"&&(Ee=!0,we.hidden=!0),E.outlineLevel!=null&&(Ee=!0,we.level=+E.outlineLevel),Ee&&(H[U-1]=we)}break;case"<":ee=g;break}if(ee>=g)break;if(E=Me(x.slice(ee,g),!0),U=E.r!=null?parseInt(E.r,10):U+1,N=-1,!(d.sheetRows&&d.sheetRows<U)){u.s.r>U-1&&(u.s.r=U-1),u.e.r<U-1&&(u.e.r=U-1),d&&d.cellStyles&&(we={},Ee=!1,E.ht&&(Ee=!0,we.hpt=parseFloat(E.ht),we.hpx=Sa(we.hpt)),E.hidden=="1"&&(Ee=!0,we.hidden=!0),E.outlineLevel!=null&&(Ee=!0,we.level=+E.outlineLevel),Ee&&(H[U-1]=we)),p=x.slice(g).split(e);for(var se=0;se!=p.length&&p[se].trim().charAt(0)=="<";++se);for(p=p.slice(se),g=0;g!=p.length;++g)if(x=p[g].trim(),x.length!==0){if(k=x.match(r),b=g,w=0,j=0,x="<c "+(x.slice(0,1)=="<"?">":"")+x,k!=null&&k.length===2){for(b=0,R=k[1],w=0;w!=R.length&&!((j=R.charCodeAt(w)-64)<1||j>26);++w)b=26*b+j;--b,N=b}else++N;for(w=0;w!=x.length&&x.charCodeAt(w)!==62;++w);if(++w,E=Me(x.slice(0,w),!0),E.r||(E.r=Le({r:U-1,c:N})),R=x.slice(w),I={t:""},(k=R.match(n))!=null&&k[1]!==""&&(I.v=Ge(k[1])),d.cellFormula){if((k=R.match(i))!=null&&k[1]!==""){if(I.f=Ge(rr(k[1])).replace(/\r\n/g,`
`),d.xlfn||(I.f=mi(I.f)),k[0].indexOf('t="array"')>-1)I.F=(R.match(s)||[])[1],I.F.indexOf(":")>-1&&pe.push([Xe(I.F),I.F]);else if(k[0].indexOf('t="shared"')>-1){L=Me(k[0]);var J=Ge(rr(k[1]));d.xlfn||(J=mi(J)),he[parseInt(L.si,10)]=[L,J,E.r]}}else(k=R.match(/<f[^>]*\/>/))&&(L=Me(k[0]),he[L.si]&&(I.f=s1(he[L.si][1],he[L.si][2],E.r)));var q=dr(E.r);for(w=0;w<pe.length;++w)q.r>=pe[w][0].s.r&&q.r<=pe[w][0].e.r&&q.c>=pe[w][0].s.c&&q.c<=pe[w][0].e.c&&(I.F=pe[w][1])}if(E.t==null&&I.v===void 0)if(I.f||I.F)I.v=0,I.t="n";else if(A)I.t="z";else continue;else I.t=E.t||"n";switch(u.s.c>N&&(u.s.c=N),u.e.c<N&&(u.e.c=N),I.t){case"n":if(I.v==""||I.v==null){if(!A)continue;I.t="z"}else I.v=parseFloat(I.v);break;case"s":if(typeof I.v>"u"){if(!A)continue;I.t="z"}else B=Ha[parseInt(I.v,10)],I.v=B.t,I.r=B.r,d.cellHTML&&(I.h=B.h);break;case"str":I.t="s",I.v=I.v!=null?rr(I.v):"",d.cellHTML&&(I.h=zn(I.v));break;case"inlineStr":k=R.match(a),I.t="s",k!=null&&(B=n0(k[1]))?(I.v=B.t,d.cellHTML&&(I.h=B.h)):I.v="";break;case"b":I.v=sr(I.v);break;case"d":d.cellDates?I.v=nr(I.v,1):(I.v=br(nr(I.v,1)),I.t="n");break;case"e":(!d||d.cellText!==!1)&&(I.w=I.v),I.v=Sc[I.v];break}if(P=Q=0,ie=null,fe&&E.s!==void 0&&(ie=m.CellXf[E.s],ie!=null&&(ie.numFmtId!=null&&(P=ie.numFmtId),d.cellStyles&&ie.fillId!=null&&(Q=ie.fillId))),bo(I,P,Q,d,h,m),d.cellDates&&fe&&I.t=="n"&&Na(Ie[P])&&(I.t="d",I.v=Ks(I.v)),E.cm&&d.xlmeta){var ke=(d.xlmeta.Cell||[])[+E.cm-1];ke&&ke.type=="XLDAPR"&&(I.D=!0)}if(Ve){var S=dr(E.r);f[S.r]||(f[S.r]=[]),f[S.r][S.c]=I}else f[E.r]=I}}}}H.length>0&&(f["!rows"]=H)}}();function lg(e,t,r,a){var s=[],n=[],i=Xe(e["!ref"]),c="",l,f="",d=[],u=0,h=0,m=e["!rows"],g=Array.isArray(e),x={r:f},p,k=-1;for(h=i.s.c;h<=i.e.c;++h)d[h]=fr(h);for(u=i.s.r;u<=i.e.r;++u){for(n=[],f=pr(u),h=i.s.c;h<=i.e.c;++h){l=d[h]+f;var b=g?(e[u]||[])[h]:e[l];b!==void 0&&(c=cg(b,l,e,t))!=null&&n.push(c)}(n.length>0||m&&m[u])&&(x={r:f},m&&m[u]&&(p=m[u],p.hidden&&(x.hidden=1),k=-1,p.hpx?k=ts(p.hpx):p.hpt&&(k=p.hpt),k>-1&&(x.ht=k,x.customHeight=1),p.level&&(x.outlineLevel=p.level)),s[s.length]=xe("row",n.join(""),x))}if(m)for(;u<m.length;++u)m&&m[u]&&(x={r:u+1},p=m[u],p.hidden&&(x.hidden=1),k=-1,p.hpx?k=ts(p.hpx):p.hpt&&(k=p.hpt),k>-1&&(x.ht=k,x.customHeight=1),p.level&&(x.outlineLevel=p.level),s[s.length]=xe("row","",x));return s.join("")}function So(e,t,r,a){var s=[vr,xe("worksheet",null,{xmlns:ca[0],"xmlns:r":yr.r})],n=r.SheetNames[e],i=0,c="",l=r.Sheets[n];l==null&&(l={});var f=l["!ref"]||"A1",d=Xe(f);if(d.e.c>16383||d.e.r>1048575){if(t.WTF)throw new Error("Range "+f+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575),f=We(d)}a||(a={}),l["!comments"]=[];var u=[];Xm(l,r,e,t,s),s[s.length]=xe("dimension",null,{ref:f}),s[s.length]=ig(l,t,e,r),t.sheetFormat&&(s[s.length]=xe("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),l["!cols"]!=null&&l["!cols"].length>0&&(s[s.length]=rg(l,l["!cols"])),s[i=s.length]="<sheetData/>",l["!links"]=[],l["!ref"]!=null&&(c=lg(l,t),c.length>0&&(s[s.length]=c)),s.length>i+1&&(s[s.length]="</sheetData>",s[i]=s[i].replace("/>",">")),l["!protect"]&&(s[s.length]=Jm(l["!protect"])),l["!autofilter"]!=null&&(s[s.length]=ag(l["!autofilter"],l,r,e)),l["!merges"]!=null&&l["!merges"].length>0&&(s[s.length]=zm(l["!merges"]));var h=-1,m,g=-1;return l["!links"].length>0&&(s[s.length]="<hyperlinks>",l["!links"].forEach(function(x){x[1].Target&&(m={ref:x[0]},x[1].Target.charAt(0)!="#"&&(g=Qe(a,-1,er(x[1].Target).replace(/#.*$/,""),ze.HLINK),m["r:id"]="rId"+g),(h=x[1].Target.indexOf("#"))>-1&&(m.location=er(x[1].Target.slice(h+1))),x[1].Tooltip&&(m.tooltip=er(x[1].Tooltip)),s[s.length]=xe("hyperlink",null,m))}),s[s.length]="</hyperlinks>"),delete l["!links"],l["!margins"]!=null&&(s[s.length]=Qm(l["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(s[s.length]=Ar("ignoredErrors",xe("ignoredError",null,{numberStoredAsText:1,sqref:f}))),u.length>0&&(g=Qe(a,-1,"../drawings/drawing"+(e+1)+".xml",ze.DRAW),s[s.length]=xe("drawing",null,{"r:id":"rId"+g}),l["!drawing"]=u),l["!comments"].length>0&&(g=Qe(a,-1,"../drawings/vmlDrawing"+(e+1)+".vml",ze.VML),s[s.length]=xe("legacyDrawing",null,{"r:id":"rId"+g}),l["!legacy"]=g),s.length>1&&(s[s.length]="</worksheet>",s[1]=s[1].replace("/>",">")),s.join("")}function fg(e,t){var r={},a=e.l+t;r.r=e.read_shift(4),e.l+=4;var s=e.read_shift(2);e.l+=1;var n=e.read_shift(1);return e.l=a,n&7&&(r.level=n&7),n&16&&(r.hidden=!0),n&32&&(r.hpt=s/20),r}function dg(e,t,r){var a=Y(145),s=(r["!rows"]||[])[e]||{};a.write_shift(4,e),a.write_shift(4,0);var n=320;s.hpx?n=ts(s.hpx)*20:s.hpt&&(n=s.hpt*20),a.write_shift(2,n),a.write_shift(1,0);var i=0;s.level&&(i|=s.level),s.hidden&&(i|=16),(s.hpx||s.hpt)&&(i|=32),a.write_shift(1,i),a.write_shift(1,0);var c=0,l=a.l;a.l+=4;for(var f={r:e,c:0},d=0;d<16;++d)if(!(t.s.c>d+1<<10||t.e.c<d<<10)){for(var u=-1,h=-1,m=d<<10;m<d+1<<10;++m){f.c=m;var g=Array.isArray(r)?(r[f.r]||[])[f.c]:r[Le(f)];g&&(u<0&&(u=m),h=m)}u<0||(++c,a.write_shift(4,u),a.write_shift(4,h))}var x=a.l;return a.l=l,a.write_shift(4,c),a.l=x,a.length>a.l?a.slice(0,a.l):a}function hg(e,t,r,a){var s=dg(a,r,t);(s.length>17||(t["!rows"]||[])[a])&&ne(e,0,s)}var ug=da,xg=Aa;function mg(){}function gg(e,t){var r={},a=e[e.l];return++e.l,r.above=!(a&64),r.left=!(a&128),e.l+=18,r.name=wf(e),r}function pg(e,t,r){r==null&&(r=Y(84+4*e.length));var a=192;t&&(t.above&&(a&=-65),t.left&&(a&=-129)),r.write_shift(1,a);for(var s=1;s<3;++s)r.write_shift(1,0);return Ps({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),kc(e,r),r.slice(0,r.l)}function vg(e){var t=ot(e);return[t]}function wg(e,t,r){return r==null&&(r=Y(8)),oa(t,r)}function kg(e){var t=la(e);return[t]}function _g(e,t,r){return r==null&&(r=Y(4)),fa(t,r)}function yg(e){var t=ot(e),r=e.read_shift(1);return[t,r,"b"]}function bg(e,t,r){return r==null&&(r=Y(9)),oa(t,r),r.write_shift(1,e.v?1:0),r}function Eg(e){var t=la(e),r=e.read_shift(1);return[t,r,"b"]}function Sg(e,t,r){return r==null&&(r=Y(5)),fa(t,r),r.write_shift(1,e.v?1:0),r}function Tg(e){var t=ot(e),r=e.read_shift(1);return[t,r,"e"]}function Ng(e,t,r){return r==null&&(r=Y(9)),oa(t,r),r.write_shift(1,e.v),r}function Fg(e){var t=la(e),r=e.read_shift(1);return[t,r,"e"]}function Cg(e,t,r){return r==null&&(r=Y(8)),fa(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function Ag(e){var t=ot(e),r=e.read_shift(4);return[t,r,"s"]}function jg(e,t,r){return r==null&&(r=Y(12)),oa(t,r),r.write_shift(4,t.v),r}function Dg(e){var t=la(e),r=e.read_shift(4);return[t,r,"s"]}function Ig(e,t,r){return r==null&&(r=Y(8)),fa(t,r),r.write_shift(4,t.v),r}function Og(e){var t=ot(e),r=Rr(e);return[t,r,"n"]}function Lg(e,t,r){return r==null&&(r=Y(16)),oa(t,r),aa(e.v,r),r}function To(e){var t=la(e),r=Rr(e);return[t,r,"n"]}function Rg(e,t,r){return r==null&&(r=Y(12)),fa(t,r),aa(e.v,r),r}function Mg(e){var t=ot(e),r=e0(e);return[t,r,"n"]}function Pg(e,t,r){return r==null&&(r=Y(12)),oa(t,r),_c(e.v,r),r}function Bg(e){var t=la(e),r=e0(e);return[t,r,"n"]}function Ug(e,t,r){return r==null&&(r=Y(8)),fa(t,r),_c(e.v,r),r}function Wg(e){var t=ot(e),r=qn(e);return[t,r,"is"]}function Hg(e){var t=ot(e),r=Mr(e);return[t,r,"str"]}function Vg(e,t,r){return r==null&&(r=Y(12+4*e.v.length)),oa(t,r),Nr(e.v,r),r.length>r.l?r.slice(0,r.l):r}function $g(e){var t=la(e),r=Mr(e);return[t,r,"str"]}function zg(e,t,r){return r==null&&(r=Y(8+4*e.v.length)),fa(t,r),Nr(e.v,r),r.length>r.l?r.slice(0,r.l):r}function Gg(e,t,r){var a=e.l+t,s=ot(e);s.r=r["!row"];var n=e.read_shift(1),i=[s,n,"b"];if(r.cellFormula){e.l+=2;var c=qs(e,a-e.l,r);i[3]=Or(c,null,s,r.supbooks,r)}else e.l=a;return i}function Xg(e,t,r){var a=e.l+t,s=ot(e);s.r=r["!row"];var n=e.read_shift(1),i=[s,n,"e"];if(r.cellFormula){e.l+=2;var c=qs(e,a-e.l,r);i[3]=Or(c,null,s,r.supbooks,r)}else e.l=a;return i}function Kg(e,t,r){var a=e.l+t,s=ot(e);s.r=r["!row"];var n=Rr(e),i=[s,n,"n"];if(r.cellFormula){e.l+=2;var c=qs(e,a-e.l,r);i[3]=Or(c,null,s,r.supbooks,r)}else e.l=a;return i}function Yg(e,t,r){var a=e.l+t,s=ot(e);s.r=r["!row"];var n=Mr(e),i=[s,n,"str"];if(r.cellFormula){e.l+=2;var c=qs(e,a-e.l,r);i[3]=Or(c,null,s,r.supbooks,r)}else e.l=a;return i}var Jg=da,qg=Aa;function Zg(e,t){return t==null&&(t=Y(4)),t.write_shift(4,e),t}function Qg(e,t){var r=e.l+t,a=da(e),s=Zn(e),n=Mr(e),i=Mr(e),c=Mr(e);e.l=r;var l={rfx:a,relId:s,loc:n,display:c};return i&&(l.Tooltip=i),l}function ep(e,t){var r=Y(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));Aa({s:dr(e[0]),e:dr(e[0])},r),Qn("rId"+t,r);var a=e[1].Target.indexOf("#"),s=a==-1?"":e[1].Target.slice(a+1);return Nr(s||"",r),Nr(e[1].Tooltip||"",r),Nr("",r),r.slice(0,r.l)}function rp(){}function tp(e,t,r){var a=e.l+t,s=yc(e),n=e.read_shift(1),i=[s];if(i[2]=n,r.cellFormula){var c=Tm(e,a-e.l,r);i[1]=c}else e.l=a;return i}function ap(e,t,r){var a=e.l+t,s=da(e),n=[s];if(r.cellFormula){var i=Fm(e,a-e.l,r);n[1]=i,e.l=a}else e.l=a;return n}function sp(e,t,r){r==null&&(r=Y(18));var a=Zs(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(a.width||10)*256),r.write_shift(4,0);var s=0;return t.hidden&&(s|=1),typeof a.width=="number"&&(s|=2),t.level&&(s|=t.level<<8),r.write_shift(2,s),r}var No=["left","right","top","bottom","header","footer"];function np(e){var t={};return No.forEach(function(r){t[r]=Rr(e)}),t}function ip(e,t){return t==null&&(t=Y(6*8)),ea(e),No.forEach(function(r){aa(e[r],t)}),t}function cp(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function op(e,t,r){r==null&&(r=Y(30));var a=924;return(((t||{}).Views||[])[0]||{}).RTL&&(a|=32),r.write_shift(2,a),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function lp(e){var t=Y(24);return t.write_shift(4,4),t.write_shift(4,1),Aa(e,t),t}function fp(e,t){return t==null&&(t=Y(16*4+2)),t.write_shift(2,e.password?i0(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function dp(){}function hp(){}function up(e,t,r,a,s,n,i){if(!e)return e;var c=t||{};a||(a={"!id":{}});var l=c.dense?[]:{},f,d={s:{r:2e6,c:2e6},e:{r:0,c:0}},u=!1,h=!1,m,g,x,p,k,b,w,j,R,I=[];c.biff=12,c["!row"]=0;var E=0,U=!1,N=[],B={},L=c.supbooks||s.supbooks||[[]];if(L.sharedf=B,L.arrayf=N,L.SheetNames=s.SheetNames||s.Sheets.map(function(Ve){return Ve.name}),!c.supbooks&&(c.supbooks=L,s.Names))for(var P=0;P<s.Names.length;++P)L[0][P+1]=s.Names[P];var Q=[],fe=[],ie=!1;as[16]={n:"BrtShortReal",f:To};var pe;if(Dt(e,function(H,we,Ee){if(!h)switch(Ee){case 148:f=H;break;case 0:m=H,c.sheetRows&&c.sheetRows<=m.r&&(h=!0),j=pr(p=m.r),c["!row"]=m.r,(H.hidden||H.hpt||H.level!=null)&&(H.hpt&&(H.hpx=Sa(H.hpt)),fe[H.r]=H);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(g={t:H[2]},H[2]){case"n":g.v=H[1];break;case"s":w=Ha[H[1]],g.v=w.t,g.r=w.r;break;case"b":g.v=!!H[1];break;case"e":g.v=H[1],c.cellText!==!1&&(g.w=It[g.v]);break;case"str":g.t="s",g.v=H[1];break;case"is":g.t="s",g.v=H[1].t;break}if((x=i.CellXf[H[0].iStyleRef])&&bo(g,x.numFmtId,null,c,n,i),k=H[0].c==-1?k+1:H[0].c,c.dense?(l[p]||(l[p]=[]),l[p][k]=g):l[fr(k)+j]=g,c.cellFormula){for(U=!1,E=0;E<N.length;++E){var A=N[E];m.r>=A[0].s.r&&m.r<=A[0].e.r&&k>=A[0].s.c&&k<=A[0].e.c&&(g.F=We(A[0]),U=!0)}!U&&H.length>3&&(g.f=H[3])}if(d.s.r>m.r&&(d.s.r=m.r),d.s.c>k&&(d.s.c=k),d.e.r<m.r&&(d.e.r=m.r),d.e.c<k&&(d.e.c=k),c.cellDates&&x&&g.t=="n"&&Na(Ie[x.numFmtId])){var M=Jt(g.v);M&&(g.t="d",g.v=new Date(M.y,M.m-1,M.d,M.H,M.M,M.S,M.u))}pe&&(pe.type=="XLDAPR"&&(g.D=!0),pe=void 0);break;case 1:case 12:if(!c.sheetStubs||u)break;g={t:"z",v:void 0},k=H[0].c==-1?k+1:H[0].c,c.dense?(l[p]||(l[p]=[]),l[p][k]=g):l[fr(k)+j]=g,d.s.r>m.r&&(d.s.r=m.r),d.s.c>k&&(d.s.c=k),d.e.r<m.r&&(d.e.r=m.r),d.e.c<k&&(d.e.c=k),pe&&(pe.type=="XLDAPR"&&(g.D=!0),pe=void 0);break;case 176:I.push(H);break;case 49:pe=((c.xlmeta||{}).Cell||[])[H-1];break;case 494:var D=a["!id"][H.relId];for(D?(H.Target=D.Target,H.loc&&(H.Target+="#"+H.loc),H.Rel=D):H.relId==""&&(H.Target="#"+H.loc),p=H.rfx.s.r;p<=H.rfx.e.r;++p)for(k=H.rfx.s.c;k<=H.rfx.e.c;++k)c.dense?(l[p]||(l[p]=[]),l[p][k]||(l[p][k]={t:"z",v:void 0}),l[p][k].l=H):(b=Le({c:k,r:p}),l[b]||(l[b]={t:"z",v:void 0}),l[b].l=H);break;case 426:if(!c.cellFormula)break;N.push(H),R=c.dense?l[p][k]:l[fr(k)+j],R.f=Or(H[1],d,{r:m.r,c:k},L,c),R.F=We(H[0]);break;case 427:if(!c.cellFormula)break;B[Le(H[0].s)]=H[1],R=c.dense?l[p][k]:l[fr(k)+j],R.f=Or(H[1],d,{r:m.r,c:k},L,c);break;case 60:if(!c.cellStyles)break;for(;H.e>=H.s;)Q[H.e--]={width:H.w/256,hidden:!!(H.flags&1),level:H.level},ie||(ie=!0,c0(H.w/256)),Bt(Q[H.e+1]);break;case 161:l["!autofilter"]={ref:We(H)};break;case 476:l["!margins"]=H;break;case 147:s.Sheets[r]||(s.Sheets[r]={}),H.name&&(s.Sheets[r].CodeName=H.name),(H.above||H.left)&&(l["!outline"]={above:H.above,left:H.left});break;case 137:s.Views||(s.Views=[{}]),s.Views[0]||(s.Views[0]={}),H.RTL&&(s.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:u=!0;break;case 36:u=!1;break;case 37:u=!0;break;case 38:u=!1;break;default:if(!we.T){if(!u||c.WTF)throw new Error("Unexpected record 0x"+Ee.toString(16))}}},c),delete c.supbooks,delete c["!row"],!l["!ref"]&&(d.s.r<2e6||f&&(f.e.r>0||f.e.c>0||f.s.r>0||f.s.c>0))&&(l["!ref"]=We(f||d)),c.sheetRows&&l["!ref"]){var he=Xe(l["!ref"]);c.sheetRows<=+he.e.r&&(he.e.r=c.sheetRows-1,he.e.r>d.e.r&&(he.e.r=d.e.r),he.e.r<he.s.r&&(he.s.r=he.e.r),he.e.c>d.e.c&&(he.e.c=d.e.c),he.e.c<he.s.c&&(he.s.c=he.e.c),l["!fullref"]=l["!ref"],l["!ref"]=We(he))}return I.length>0&&(l["!merges"]=I),Q.length>0&&(l["!cols"]=Q),fe.length>0&&(l["!rows"]=fe),l}function xp(e,t,r,a,s,n,i){if(t.v===void 0)return!1;var c="";switch(t.t){case"b":c=t.v?"1":"0";break;case"d":t=ir(t),t.z=t.z||Ie[14],t.v=br(nr(t.v)),t.t="n";break;case"n":case"e":c=""+t.v;break;default:c=t.v;break}var l={r,c:a};switch(l.s=$t(s.cellXfs,t,s),t.l&&n["!links"].push([Le(l),t.l]),t.c&&n["!comments"].push([Le(l),t.c]),t.t){case"s":case"str":return s.bookSST?(c=h0(s.Strings,t.v,s.revStrings),l.t="s",l.v=c,i?ne(e,18,Ig(t,l)):ne(e,7,jg(t,l))):(l.t="str",i?ne(e,17,zg(t,l)):ne(e,6,Vg(t,l))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?i?ne(e,13,Ug(t,l)):ne(e,2,Pg(t,l)):i?ne(e,16,Rg(t,l)):ne(e,5,Lg(t,l)),!0;case"b":return l.t="b",i?ne(e,15,Sg(t,l)):ne(e,4,bg(t,l)),!0;case"e":return l.t="e",i?ne(e,14,Cg(t,l)):ne(e,3,Ng(t,l)),!0}return i?ne(e,12,_g(t,l)):ne(e,1,wg(t,l)),!0}function mp(e,t,r,a){var s=Xe(t["!ref"]||"A1"),n,i="",c=[];ne(e,145);var l=Array.isArray(t),f=s.e.r;t["!rows"]&&(f=Math.max(s.e.r,t["!rows"].length-1));for(var d=s.s.r;d<=f;++d){i=pr(d),hg(e,t,s,d);var u=!1;if(d<=s.e.r)for(var h=s.s.c;h<=s.e.c;++h){d===s.s.r&&(c[h]=fr(h)),n=c[h]+i;var m=l?(t[d]||[])[h]:t[n];if(!m){u=!1;continue}u=xp(e,m,d,h,a,t,u)}}ne(e,146)}function gp(e,t){!t||!t["!merges"]||(ne(e,177,Zg(t["!merges"].length)),t["!merges"].forEach(function(r){ne(e,176,qg(r))}),ne(e,178))}function pp(e,t){!t||!t["!cols"]||(ne(e,390),t["!cols"].forEach(function(r,a){r&&ne(e,60,sp(a,r))}),ne(e,391))}function vp(e,t){!t||!t["!ref"]||(ne(e,648),ne(e,649,lp(Xe(t["!ref"]))),ne(e,650))}function wp(e,t,r){t["!links"].forEach(function(a){if(a[1].Target){var s=Qe(r,-1,a[1].Target.replace(/#.*$/,""),ze.HLINK);ne(e,494,ep(a,s))}}),delete t["!links"]}function kp(e,t,r,a){if(t["!comments"].length>0){var s=Qe(a,-1,"../drawings/vmlDrawing"+(r+1)+".vml",ze.VML);ne(e,551,Qn("rId"+s)),t["!legacy"]=s}}function _p(e,t,r,a){if(t["!autofilter"]){var s=t["!autofilter"],n=typeof s.ref=="string"?s.ref:We(s.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var i=r.Workbook.Names,c=Xr(n);c.s.r==c.e.r&&(c.e.r=Xr(t["!ref"]).e.r,n=We(c));for(var l=0;l<i.length;++l){var f=i[l];if(f.Name=="_xlnm._FilterDatabase"&&f.Sheet==a){f.Ref="'"+r.SheetNames[a]+"'!"+n;break}}l==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:a,Ref:"'"+r.SheetNames[a]+"'!"+n}),ne(e,161,Aa(Xe(n))),ne(e,162)}}function yp(e,t,r){ne(e,133),ne(e,137,op(t,r)),ne(e,138),ne(e,134)}function bp(e,t){t["!protect"]&&ne(e,535,fp(t["!protect"]))}function Ep(e,t,r,a){var s=Gr(),n=r.SheetNames[e],i=r.Sheets[n]||{},c=n;try{r&&r.Workbook&&(c=r.Workbook.Sheets[e].CodeName||c)}catch{}var l=Xe(i["!ref"]||"A1");if(l.e.c>16383||l.e.r>1048575){if(t.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");l.e.c=Math.min(l.e.c,16383),l.e.r=Math.min(l.e.c,1048575)}return i["!links"]=[],i["!comments"]=[],ne(s,129),(r.vbaraw||i["!outline"])&&ne(s,147,pg(c,i["!outline"])),ne(s,148,xg(l)),yp(s,i,r.Workbook),pp(s,i),mp(s,i,e,t),bp(s,i),_p(s,i,r,e),gp(s,i),wp(s,i,a),i["!margins"]&&ne(s,476,ip(i["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&vp(s,i),kp(s,i,e,a),ne(s,130),s.end()}function Sp(e){var t=[],r=e.match(/^<c:numCache>/),a;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(n){var i=n.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);i&&(t[+i[1]]=r?+i[2]:i[2])});var s=Ge((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(n){a=n.replace(/<.*?>/g,"")}),[t,s,a]}function Tp(e,t,r,a,s,n){var i=n||{"!type":"chart"};if(!e)return n;var c=0,l=0,f="A",d={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(u){var h=Sp(u);d.s.r=d.s.c=0,d.e.c=c,f=fr(c),h[0].forEach(function(m,g){i[f+pr(g)]={t:"n",v:m,z:h[1]},l=g}),d.e.r<l&&(d.e.r=l),++c}),c>0&&(i["!ref"]=We(d)),i}function Np(e,t,r,a,s){if(!e)return e;a||(a={"!id":{}});var n={"!type":"chart","!drawel":null,"!rel":""},i,c=e.match(Eo);return c&&u0(c[0],n,s,r),(i=e.match(/drawing r:id="(.*?)"/))&&(n["!rel"]=i[1]),a["!id"][n["!rel"]]&&(n["!drawel"]=a["!id"][n["!rel"]]),n}function Fp(e,t){e.l+=10;var r=Mr(e);return{name:r}}function Cp(e,t,r,a,s){if(!e)return e;a||(a={"!id":{}});var n={"!type":"chart","!drawel":null,"!rel":""},i=!1;return Dt(e,function(l,f,d){switch(d){case 550:n["!rel"]=l;break;case 651:s.Sheets[r]||(s.Sheets[r]={}),l.name&&(s.Sheets[r].CodeName=l.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!(f.T>0)){if(!(f.T<0)){if(!i||t.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}},t),a["!id"][n["!rel"]]&&(n["!drawel"]=a["!id"][n["!rel"]]),n}var x0=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],Ap=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],jp=[],Dp=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function ki(e,t){for(var r=0;r!=e.length;++r)for(var a=e[r],s=0;s!=t.length;++s){var n=t[s];if(a[n[0]]==null)a[n[0]]=n[1];else switch(n[2]){case"bool":typeof a[n[0]]=="string"&&(a[n[0]]=sr(a[n[0]]));break;case"int":typeof a[n[0]]=="string"&&(a[n[0]]=parseInt(a[n[0]],10));break}}}function _i(e,t){for(var r=0;r!=t.length;++r){var a=t[r];if(e[a[0]]==null)e[a[0]]=a[1];else switch(a[2]){case"bool":typeof e[a[0]]=="string"&&(e[a[0]]=sr(e[a[0]]));break;case"int":typeof e[a[0]]=="string"&&(e[a[0]]=parseInt(e[a[0]],10));break}}}function Fo(e){_i(e.WBProps,x0),_i(e.CalcPr,Dp),ki(e.WBView,Ap),ki(e.Sheets,jp),ya.date1904=sr(e.WBProps.date1904)}function Ip(e){return!e.Workbook||!e.Workbook.WBProps?"false":sr(e.Workbook.WBProps.date1904)?"true":"false"}var Op="][*?/\\".split("");function Co(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return Op.forEach(function(a){if(e.indexOf(a)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function Lp(e,t,r){e.forEach(function(a,s){Co(a);for(var n=0;n<s;++n)if(a==e[n])throw new Error("Duplicate Sheet Name: "+a);if(r){var i=t&&t[s]&&t[s].CodeName||a;if(i.charCodeAt(0)==95&&i.length>22)throw new Error("Bad Code Name: Worksheet"+i)}})}function Rp(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];Lp(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)Im(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}var Mp=/<\w+:workbook/;function Pp(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},a=!1,s="xmlns",n={},i=0;if(e.replace(Br,function(l,f){var d=Me(l);switch(yt(d[0])){case"<?xml":break;case"<workbook":l.match(Mp)&&(s="xmlns"+l.match(/<(\w+):/)[1]),r.xmlns=d[s];break;case"</workbook>":break;case"<fileVersion":delete d[0],r.AppVersion=d;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":x0.forEach(function(u){if(d[u[0]]!=null)switch(u[2]){case"bool":r.WBProps[u[0]]=sr(d[u[0]]);break;case"int":r.WBProps[u[0]]=parseInt(d[u[0]],10);break;default:r.WBProps[u[0]]=d[u[0]]}}),d.codeName&&(r.WBProps.CodeName=rr(d.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete d[0],r.WBView.push(d);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(d.state){case"hidden":d.Hidden=1;break;case"veryHidden":d.Hidden=2;break;default:d.Hidden=0}delete d.state,d.name=Ge(rr(d.name)),delete d[0],r.Sheets.push(d);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":a=!0;break;case"</definedNames>":a=!1;break;case"<definedName":n={},n.Name=rr(d.name),d.comment&&(n.Comment=d.comment),d.localSheetId&&(n.Sheet=+d.localSheetId),sr(d.hidden||"0")&&(n.Hidden=!0),i=f+l.length;break;case"</definedName>":n.Ref=Ge(rr(e.slice(i,f))),r.Names.push(n);break;case"<definedName/>":break;case"<calcPr":delete d[0],r.CalcPr=d;break;case"<calcPr/>":delete d[0],r.CalcPr=d;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":a=!0;break;case"</AlternateContent>":a=!1;break;case"<revisionPtr":break;default:if(!a&&t.WTF)throw new Error("unrecognized "+d[0]+" in workbook")}return l}),ca.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return Fo(r),r}function Ao(e){var t=[vr];t[t.length]=xe("workbook",null,{xmlns:ca[0],"xmlns:r":yr.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,a={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(x0.forEach(function(c){e.Workbook.WBProps[c[0]]!=null&&e.Workbook.WBProps[c[0]]!=c[1]&&(a[c[0]]=e.Workbook.WBProps[c[0]])}),e.Workbook.WBProps.CodeName&&(a.codeName=e.Workbook.WBProps.CodeName,delete a.CodeName)),t[t.length]=xe("workbookPr",null,a);var s=e.Workbook&&e.Workbook.Sheets||[],n=0;if(s&&s[0]&&s[0].Hidden){for(t[t.length]="<bookViews>",n=0;n!=e.SheetNames.length&&!(!s[n]||!s[n].Hidden);++n);n==e.SheetNames.length&&(n=0),t[t.length]='<workbookView firstSheet="'+n+'" activeTab="'+n+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",n=0;n!=e.SheetNames.length;++n){var i={name:er(e.SheetNames[n].slice(0,31))};if(i.sheetId=""+(n+1),i["r:id"]="rId"+(n+1),s[n])switch(s[n].Hidden){case 1:i.state="hidden";break;case 2:i.state="veryHidden";break}t[t.length]=xe("sheet",null,i)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(c){var l={name:c.Name};c.Comment&&(l.comment=c.Comment),c.Sheet!=null&&(l.localSheetId=""+c.Sheet),c.Hidden&&(l.hidden="1"),c.Ref&&(t[t.length]=xe("definedName",er(c.Ref),l))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function Bp(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=Sn(e),r.name=Mr(e),r}function Up(e,t){return t||(t=Y(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),Qn(e.strRelID,t),Nr(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function Wp(e,t){var r={},a=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var s=t>8?Mr(e):"";return s.length>0&&(r.CodeName=s),r.autoCompressPictures=!!(a&65536),r.backupFile=!!(a&64),r.checkCompatibility=!!(a&4096),r.date1904=!!(a&1),r.filterPrivacy=!!(a&8),r.hidePivotFieldList=!!(a&1024),r.promptedSolutions=!!(a&16),r.publishItems=!!(a&2048),r.refreshAllConnections=!!(a&262144),r.saveExternalLinkValues=!!(a&128),r.showBorderUnselectedTables=!!(a&4),r.showInkAnnotation=!!(a&32),r.showObjects=["all","placeholders","none"][a>>13&3],r.showPivotChartFilter=!!(a&32768),r.updateLinks=["userSet","never","always"][a>>8&3],r}function Hp(e,t){t||(t=Y(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),kc(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function Vp(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function $p(e,t,r){var a=e.l+t;e.l+=4,e.l+=1;var s=e.read_shift(4),n=kf(e),i=Nm(e,0,r),c=Zn(e);e.l=a;var l={Name:n,Ptg:i};return s<268435455&&(l.Sheet=s),c&&(l.Comment=c),l}function zp(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},a=[],s=!1;t||(t={}),t.biff=12;var n=[],i=[[]];return i.SheetNames=[],i.XTI=[],as[16]={n:"BrtFRTArchID$",f:Vp},Dt(e,function(l,f,d){switch(d){case 156:i.SheetNames.push(l.name),r.Sheets.push(l);break;case 153:r.WBProps=l;break;case 39:l.Sheet!=null&&(t.SID=l.Sheet),l.Ref=Or(l.Ptg,null,null,i,t),delete t.SID,delete l.Ptg,n.push(l);break;case 1036:break;case 357:case 358:case 355:case 667:i[0].length?i.push([d,l]):i[0]=[d,l],i[i.length-1].XTI=[];break;case 362:i.length===0&&(i[0]=[],i[0].XTI=[]),i[i.length-1].XTI=i[i.length-1].XTI.concat(l),i.XTI=i.XTI.concat(l);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:a.push(d),s=!0;break;case 36:a.pop(),s=!1;break;case 37:a.push(d),s=!0;break;case 38:a.pop(),s=!1;break;case 16:break;default:if(!f.T){if(!s||t.WTF&&a[a.length-1]!=37&&a[a.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}},t),Fo(r),r.Names=n,r.supbooks=i,r}function Gp(e,t){ne(e,143);for(var r=0;r!=t.SheetNames.length;++r){var a=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,s={Hidden:a,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};ne(e,156,Up(s))}ne(e,144)}function Xp(e,t){t||(t=Y(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return Nr("SheetJS",t),Nr(js.version,t),Nr(js.version,t),Nr("7262",t),t.length>t.l?t.slice(0,t.l):t}function Kp(e,t){t||(t=Y(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function Yp(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,a=0,s=-1,n=-1;a<r.length;++a)!r[a]||!r[a].Hidden&&s==-1?s=a:r[a].Hidden==1&&n==-1&&(n=a);n>s||(ne(e,135),ne(e,158,Kp(s)),ne(e,136))}}function Jp(e,t){var r=Gr();return ne(r,131),ne(r,128,Xp()),ne(r,153,Hp(e.Workbook&&e.Workbook.WBProps||null)),Yp(r,e),Gp(r,e),ne(r,132),r.end()}function qp(e,t,r){return t.slice(-4)===".bin"?zp(e,r):Pp(e,r)}function Zp(e,t,r,a,s,n,i,c){return t.slice(-4)===".bin"?up(e,a,r,s,n,i,c):$m(e,a,r,s,n,i,c)}function Qp(e,t,r,a,s,n,i,c){return t.slice(-4)===".bin"?Cp(e,a,r,s,n):Np(e,a,r,s,n)}function e2(e,t,r,a,s,n,i,c){return t.slice(-4)===".bin"?t1():a1()}function r2(e,t,r,a,s,n,i,c){return t.slice(-4)===".bin"?e1():r1()}function t2(e,t,r,a){return t.slice(-4)===".bin"?qu(e,r,a):Bu(e,r,a)}function a2(e,t,r){return lo(e,r)}function s2(e,t,r){return t.slice(-4)===".bin"?su(e,r):ru(e,r)}function n2(e,t,r){return t.slice(-4)===".bin"?Yx(e,r):Ux(e,r)}function i2(e,t,r){return t.slice(-4)===".bin"?Mx(e):Lx(e)}function c2(e,t,r,a){return r.slice(-4)===".bin"?Px(e,t,r,a):void 0}function o2(e,t,r){return t.slice(-4)===".bin"?Dx(e,t,r):Ox(e,t,r)}function l2(e,t,r){return(t.slice(-4)===".bin"?Jp:Ao)(e)}function f2(e,t,r,a,s){return(t.slice(-4)===".bin"?Ep:So)(e,r,a,s)}function d2(e,t,r){return(t.slice(-4)===".bin"?cx:co)(e,r)}function h2(e,t,r){return(t.slice(-4)===".bin"?cu:Qc)(e,r)}function u2(e,t,r){return(t.slice(-4)===".bin"?Jx:uo)(e)}function x2(e){return(e.slice(-4)===".bin"?Ix:fo)()}var jo=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,Do=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function ht(e,t){var r=e.split(/\s+/),a=[];if(a[0]=r[0],r.length===1)return a;var s=e.match(jo),n,i,c,l;if(s)for(l=0;l!=s.length;++l)n=s[l].match(Do),(i=n[1].indexOf(":"))===-1?a[n[1]]=n[2].slice(1,n[2].length-1):(n[1].slice(0,6)==="xmlns:"?c="xmlns"+n[1].slice(6):c=n[1].slice(i+1),a[c]=n[2].slice(1,n[2].length-1));return a}function m2(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var a=e.match(jo),s,n,i,c;if(a)for(c=0;c!=a.length;++c)s=a[c].match(Do),(n=s[1].indexOf(":"))===-1?r[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?i="xmlns"+s[1].slice(6):i=s[1].slice(n+1),r[i]=s[2].slice(1,s[2].length-1));return r}var $a;function g2(e,t){var r=$a[e]||Ge(e);return r==="General"?ra(t):ct(r,t)}function p2(e,t,r,a){var s=a;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":s=sr(a);break;case"i2":case"int":s=parseInt(a,10);break;case"r4":case"float":s=parseFloat(a);break;case"date":case"dateTime.tz":s=nr(a);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[Ge(t)]=s}function v2(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||It[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Ka(e.v):e.w=ra(e.v):e.w=g2(t||"General",e.v)}catch(n){if(r.WTF)throw n}try{var a=$a[t]||t||"General";if(r.cellNF&&(e.z=a),r.cellDates&&e.t=="n"&&Na(a)){var s=Jt(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}catch(n){if(r.WTF)throw n}}}function w2(e,t,r){if(r.cellStyles&&t.Interior){var a=t.Interior;a.Pattern&&(a.patternType=ju[a.Pattern]||a.Pattern)}e[t.ID]=t}function k2(e,t,r,a,s,n,i,c,l,f){var d="General",u=a.StyleID,h={};f=f||{};var m=[],g=0;for(u===void 0&&c&&(u=c.StyleID),u===void 0&&i&&(u=i.StyleID);n[u]!==void 0&&(n[u].nf&&(d=n[u].nf),n[u].Interior&&m.push(n[u].Interior),!!n[u].Parent);)u=n[u].Parent;switch(r.Type){case"Boolean":a.t="b",a.v=sr(e);break;case"String":a.t="s",a.r=P0(Ge(e)),a.v=e.indexOf("<")>-1?Ge(t||e).replace(/<.*?>/g,""):a.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),a.v=(nr(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),a.v!==a.v?a.v=Ge(e):a.v<60&&(a.v=a.v-1),(!d||d=="General")&&(d="yyyy-mm-dd");case"Number":a.v===void 0&&(a.v=+e),a.t||(a.t="n");break;case"Error":a.t="e",a.v=Sc[e],f.cellText!==!1&&(a.w=e);break;default:e==""&&t==""?a.t="z":(a.t="s",a.v=P0(t||e));break}if(v2(a,d,f),f.cellFormula!==!1)if(a.Formula){var x=Ge(a.Formula);x.charCodeAt(0)==61&&(x=x.slice(1)),a.f=_a(x,s),delete a.Formula,a.ArrayRange=="RC"?a.F=_a("RC:RC",s):a.ArrayRange&&(a.F=_a(a.ArrayRange,s),l.push([Xe(a.F),a.F]))}else for(g=0;g<l.length;++g)s.r>=l[g][0].s.r&&s.r<=l[g][0].e.r&&s.c>=l[g][0].s.c&&s.c<=l[g][0].e.c&&(a.F=l[g][1]);f.cellStyles&&(m.forEach(function(p){!h.patternType&&p.patternType&&(h.patternType=p.patternType)}),a.s=h),a.StyleID!==void 0&&(a.ixfe=a.StyleID)}function _2(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function un(e,t){var r=t||{};Fa();var a=La(Gn(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(a=rr(a));var s=a.slice(0,1024).toLowerCase(),n=!1;if(s=s.replace(/".*?"/g,""),(s.indexOf(">")&1023)>Math.min(s.indexOf(",")&1023,s.indexOf(";")&1023)){var i=ir(r);return i.type="string",Ea.to_workbook(a,i)}if(s.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Ye){s.indexOf("<"+Ye)>=0&&(n=!0)}),n)return iv(a,r);$a={"General Number":"General","General Date":Ie[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Ie[15],"Short Date":Ie[14],"Long Time":Ie[19],"Medium Time":Ie[18],"Short Time":Ie[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Ie[2],Standard:Ie[4],Percent:Ie[10],Scientific:Ie[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var c,l=[],f,d={},u=[],h=r.dense?[]:{},m="",g={},x={},p=ht('<Data ss:Type="String">'),k=0,b=0,w=0,j={s:{r:2e6,c:2e6},e:{r:0,c:0}},R={},I={},E="",U=0,N=[],B={},L={},P=0,Q=[],fe=[],ie={},pe=[],he,Ve=!1,H=[],we=[],Ee={},A=0,M=0,D={Sheets:[],WBProps:{date1904:!1}},O={};qa.lastIndex=0,a=a.replace(/<!--([\s\S]*?)-->/mg,"");for(var W="";c=qa.exec(a);)switch(c[3]=(W=c[3]).toLowerCase()){case"data":if(W=="data"){if(c[1]==="/"){if((f=l.pop())[0]!==c[3])throw new Error("Bad state: "+f.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&l.push([c[3],!0]);break}if(l[l.length-1][1])break;c[1]==="/"?k2(a.slice(k,c.index),E,p,l[l.length-1][0]=="comment"?ie:g,{c:b,r:w},R,pe[b],x,H,r):(E="",p=ht(c[0]),k=c.index+c[0].length);break;case"cell":if(c[1]==="/")if(fe.length>0&&(g.c=fe),(!r.sheetRows||r.sheetRows>w)&&g.v!==void 0&&(r.dense?(h[w]||(h[w]=[]),h[w][b]=g):h[fr(b)+pr(w)]=g),g.HRef&&(g.l={Target:Ge(g.HRef)},g.HRefScreenTip&&(g.l.Tooltip=g.HRefScreenTip),delete g.HRef,delete g.HRefScreenTip),(g.MergeAcross||g.MergeDown)&&(A=b+(parseInt(g.MergeAcross,10)|0),M=w+(parseInt(g.MergeDown,10)|0),N.push({s:{c:b,r:w},e:{c:A,r:M}})),!r.sheetStubs)g.MergeAcross?b=A+1:++b;else if(g.MergeAcross||g.MergeDown){for(var ee=b;ee<=A;++ee)for(var se=w;se<=M;++se)(ee>b||se>w)&&(r.dense?(h[se]||(h[se]=[]),h[se][ee]={t:"z"}):h[fr(ee)+pr(se)]={t:"z"});b=A+1}else++b;else g=m2(c[0]),g.Index&&(b=+g.Index-1),b<j.s.c&&(j.s.c=b),b>j.e.c&&(j.e.c=b),c[0].slice(-2)==="/>"&&++b,fe=[];break;case"row":c[1]==="/"||c[0].slice(-2)==="/>"?(w<j.s.r&&(j.s.r=w),w>j.e.r&&(j.e.r=w),c[0].slice(-2)==="/>"&&(x=ht(c[0]),x.Index&&(w=+x.Index-1)),b=0,++w):(x=ht(c[0]),x.Index&&(w=+x.Index-1),Ee={},(x.AutoFitHeight=="0"||x.Height)&&(Ee.hpx=parseInt(x.Height,10),Ee.hpt=ts(Ee.hpx),we[w]=Ee),x.Hidden=="1"&&(Ee.hidden=!0,we[w]=Ee));break;case"worksheet":if(c[1]==="/"){if((f=l.pop())[0]!==c[3])throw new Error("Bad state: "+f.join("|"));u.push(m),j.s.r<=j.e.r&&j.s.c<=j.e.c&&(h["!ref"]=We(j),r.sheetRows&&r.sheetRows<=j.e.r&&(h["!fullref"]=h["!ref"],j.e.r=r.sheetRows-1,h["!ref"]=We(j))),N.length&&(h["!merges"]=N),pe.length>0&&(h["!cols"]=pe),we.length>0&&(h["!rows"]=we),d[m]=h}else j={s:{r:2e6,c:2e6},e:{r:0,c:0}},w=b=0,l.push([c[3],!1]),f=ht(c[0]),m=Ge(f.Name),h=r.dense?[]:{},N=[],H=[],we=[],O={name:m,Hidden:0},D.Sheets.push(O);break;case"table":if(c[1]==="/"){if((f=l.pop())[0]!==c[3])throw new Error("Bad state: "+f.join("|"))}else{if(c[0].slice(-2)=="/>")break;l.push([c[3],!1]),pe=[],Ve=!1}break;case"style":c[1]==="/"?w2(R,I,r):I=ht(c[0]);break;case"numberformat":I.nf=Ge(ht(c[0]).Format||"General"),$a[I.nf]&&(I.nf=$a[I.nf]);for(var J=0;J!=392&&Ie[J]!=I.nf;++J);if(J==392){for(J=57;J!=392;++J)if(Ie[J]==null){Ft(I.nf,J);break}}break;case"column":if(l[l.length-1][0]!=="table")break;if(he=ht(c[0]),he.Hidden&&(he.hidden=!0,delete he.Hidden),he.Width&&(he.wpx=parseInt(he.Width,10)),!Ve&&he.wpx>10){Ve=!0,Lr=no;for(var q=0;q<pe.length;++q)pe[q]&&Bt(pe[q])}Ve&&Bt(he),pe[he.Index-1||pe.length]=he;for(var ke=0;ke<+he.Span;++ke)pe[pe.length]=ir(he);break;case"namedrange":if(c[1]==="/")break;D.Names||(D.Names=[]);var S=Me(c[0]),je={Name:S.Name,Ref:_a(S.RefersTo.slice(1),{r:0,c:0})};D.Sheets.length>0&&(je.Sheet=D.Sheets.length-1),D.Names.push(je);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(c[0].slice(-2)==="/>")break;c[1]==="/"?E+=a.slice(U,c.index):U=c.index+c[0].length;break;case"interior":if(!r.cellStyles)break;I.Interior=ht(c[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(c[0].slice(-2)==="/>")break;c[1]==="/"?zf(B,W,a.slice(P,c.index)):P=c.index+c[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(c[1]==="/"){if((f=l.pop())[0]!==c[3])throw new Error("Bad state: "+f.join("|"))}else l.push([c[3],!1]);break;case"comment":if(c[1]==="/"){if((f=l.pop())[0]!==c[3])throw new Error("Bad state: "+f.join("|"));_2(ie),fe.push(ie)}else l.push([c[3],!1]),f=ht(c[0]),ie={a:f.Author};break;case"autofilter":if(c[1]==="/"){if((f=l.pop())[0]!==c[3])throw new Error("Bad state: "+f.join("|"))}else if(c[0].charAt(c[0].length-2)!=="/"){var Ce=ht(c[0]);h["!autofilter"]={ref:_a(Ce.Range).replace(/\$/g,"")},l.push([c[3],!0])}break;case"name":break;case"datavalidation":if(c[1]==="/"){if((f=l.pop())[0]!==c[3])throw new Error("Bad state: "+f.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&l.push([c[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(c[1]==="/"){if((f=l.pop())[0]!==c[3])throw new Error("Bad state: "+f.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&l.push([c[3],!0]);break;case"null":break;default:if(l.length==0&&c[3]=="document"||l.length==0&&c[3]=="uof")return Ti(a,r);var Be=!0;switch(l[l.length-1][0]){case"officedocumentsettings":switch(c[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Be=!1}break;case"componentoptions":switch(c[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Be=!1}break;case"excelworkbook":switch(c[3]){case"date1904":D.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Be=!1}break;case"workbookoptions":switch(c[3]){case"owcversion":break;case"height":break;case"width":break;default:Be=!1}break;case"worksheetoptions":switch(c[3]){case"visible":if(c[0].slice(-2)!=="/>")if(c[1]==="/")switch(a.slice(P,c.index)){case"SheetHidden":O.Hidden=1;break;case"SheetVeryHidden":O.Hidden=2;break}else P=c.index+c[0].length;break;case"header":h["!margins"]||ea(h["!margins"]={},"xlml"),isNaN(+Me(c[0]).Margin)||(h["!margins"].header=+Me(c[0]).Margin);break;case"footer":h["!margins"]||ea(h["!margins"]={},"xlml"),isNaN(+Me(c[0]).Margin)||(h["!margins"].footer=+Me(c[0]).Margin);break;case"pagemargins":var Fe=Me(c[0]);h["!margins"]||ea(h["!margins"]={},"xlml"),isNaN(+Fe.Top)||(h["!margins"].top=+Fe.Top),isNaN(+Fe.Left)||(h["!margins"].left=+Fe.Left),isNaN(+Fe.Right)||(h["!margins"].right=+Fe.Right),isNaN(+Fe.Bottom)||(h["!margins"].bottom=+Fe.Bottom);break;case"displayrighttoleft":D.Views||(D.Views=[]),D.Views[0]||(D.Views[0]={}),D.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Be=!1}break;case"pivottable":case"pivotcache":switch(c[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Be=!1}break;case"pagebreaks":switch(c[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Be=!1}break;case"autofilter":switch(c[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Be=!1}break;case"querytable":switch(c[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Be=!1}break;case"datavalidation":switch(c[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Be=!1}break;case"sorting":case"conditionalformatting":switch(c[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Be=!1}break;case"mapinfo":case"schema":case"data":switch(c[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Be=!1}break;case"smarttags":break;default:Be=!1;break}if(Be||c[3].match(/!\[CDATA/))break;if(!l[l.length-1][1])throw"Unrecognized tag: "+c[3]+"|"+l.join("|");if(l[l.length-1][0]==="customdocumentproperties"){if(c[0].slice(-2)==="/>")break;c[1]==="/"?p2(L,W,Q,a.slice(P,c.index)):(Q=c,P=c.index+c[0].length);break}if(r.WTF)throw"Unrecognized tag: "+c[3]+"|"+l.join("|")}var ce={};return!r.bookSheets&&!r.bookProps&&(ce.Sheets=d),ce.SheetNames=u,ce.Workbook=D,ce.SSF=ir(Ie),ce.Props=B,ce.Custprops=L,ce}function Dn(e,t){switch(g0(t=t||{}),t.type||"base64"){case"base64":return un(Qr(e),t);case"binary":case"buffer":case"file":return un(e,t);case"array":return un(Ht(e),t)}}function y2(e,t){var r=[];return e.Props&&r.push(Gf(e.Props,t)),e.Custprops&&r.push(Xf(e.Props,e.Custprops)),r.join("")}function b2(){return""}function E2(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(a,s){var n=[];n.push(xe("NumberFormat",null,{"ss:Format":er(Ie[a.numFmtId])}));var i={"ss:ID":"s"+(21+s)};r.push(xe("Style",n.join(""),i))}),xe("Styles",r.join(""))}function Io(e){return xe("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+f0(e.Ref,{r:0,c:0})})}function S2(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],a=0;a<t.length;++a){var s=t[a];s.Sheet==null&&(s.Name.match(/^_xlfn\./)||r.push(Io(s)))}return xe("Names",r.join(""))}function T2(e,t,r,a){if(!e||!((a||{}).Workbook||{}).Names)return"";for(var s=a.Workbook.Names,n=[],i=0;i<s.length;++i){var c=s[i];c.Sheet==r&&(c.Name.match(/^_xlfn\./)||n.push(Io(c)))}return n.join("")}function N2(e,t,r,a){if(!e)return"";var s=[];if(e["!margins"]&&(s.push("<PageSetup>"),e["!margins"].header&&s.push(xe("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&s.push(xe("Footer",null,{"x:Margin":e["!margins"].footer})),s.push(xe("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),s.push("</PageSetup>")),a&&a.Workbook&&a.Workbook.Sheets&&a.Workbook.Sheets[r])if(a.Workbook.Sheets[r].Hidden)s.push(xe("Visible",a.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var n=0;n<r&&!(a.Workbook.Sheets[n]&&!a.Workbook.Sheets[n].Hidden);++n);n==r&&s.push("<Selected/>")}return((((a||{}).Workbook||{}).Views||[])[0]||{}).RTL&&s.push("<DisplayRightToLeft/>"),e["!protect"]&&(s.push(Ar("ProtectContents","True")),e["!protect"].objects&&s.push(Ar("ProtectObjects","True")),e["!protect"].scenarios&&s.push(Ar("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?s.push(Ar("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&s.push(Ar("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(i){e["!protect"][i[0]]&&s.push("<"+i[1]+"/>")})),s.length==0?"":xe("WorksheetOptions",s.join(""),{xmlns:Yr.x})}function F2(e){return e.map(function(t){var r=Kl(t.t||""),a=xe("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return xe("Comment",a,{"ss:Author":t.a})}).join("")}function C2(e,t,r,a,s,n,i){if(!e||e.v==null&&e.f==null)return"";var c={};if(e.f&&(c["ss:Formula"]="="+er(f0(e.f,i))),e.F&&e.F.slice(0,t.length)==t){var l=dr(e.F.slice(t.length+1));c["ss:ArrayRange"]="RC:R"+(l.r==i.r?"":"["+(l.r-i.r)+"]")+"C"+(l.c==i.c?"":"["+(l.c-i.c)+"]")}if(e.l&&e.l.Target&&(c["ss:HRef"]=er(e.l.Target),e.l.Tooltip&&(c["x:HRefScreenTip"]=er(e.l.Tooltip))),r["!merges"])for(var f=r["!merges"],d=0;d!=f.length;++d)f[d].s.c!=i.c||f[d].s.r!=i.r||(f[d].e.c>f[d].s.c&&(c["ss:MergeAcross"]=f[d].e.c-f[d].s.c),f[d].e.r>f[d].s.r&&(c["ss:MergeDown"]=f[d].e.r-f[d].s.r));var u="",h="";switch(e.t){case"z":if(!a.sheetStubs)return"";break;case"n":u="Number",h=String(e.v);break;case"b":u="Boolean",h=e.v?"1":"0";break;case"e":u="Error",h=It[e.v];break;case"d":u="DateTime",h=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||Ie[14]);break;case"s":u="String",h=Xl(e.v||"");break}var m=$t(a.cellXfs,e,a);c["ss:StyleID"]="s"+(21+m),c["ss:Index"]=i.c+1;var g=e.v!=null?h:"",x=e.t=="z"?"":'<Data ss:Type="'+u+'">'+g+"</Data>";return(e.c||[]).length>0&&(x+=F2(e.c)),xe("Cell",x,c)}function A2(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=Sa(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function j2(e,t,r,a){if(!e["!ref"])return"";var s=Xe(e["!ref"]),n=e["!merges"]||[],i=0,c=[];e["!cols"]&&e["!cols"].forEach(function(p,k){Bt(p);var b=!!p.width,w=Zs(k,p),j={"ss:Index":k+1};b&&(j["ss:Width"]=es(w.width)),p.hidden&&(j["ss:Hidden"]="1"),c.push(xe("Column",null,j))});for(var l=Array.isArray(e),f=s.s.r;f<=s.e.r;++f){for(var d=[A2(f,(e["!rows"]||[])[f])],u=s.s.c;u<=s.e.c;++u){var h=!1;for(i=0;i!=n.length;++i)if(!(n[i].s.c>u)&&!(n[i].s.r>f)&&!(n[i].e.c<u)&&!(n[i].e.r<f)){(n[i].s.c!=u||n[i].s.r!=f)&&(h=!0);break}if(!h){var m={r:f,c:u},g=Le(m),x=l?(e[f]||[])[u]:e[g];d.push(C2(x,g,e,t,r,a,m))}}d.push("</Row>"),d.length>2&&c.push(d.join(""))}return c.join("")}function D2(e,t,r){var a=[],s=r.SheetNames[e],n=r.Sheets[s],i=n?T2(n,t,e,r):"";return i.length>0&&a.push("<Names>"+i+"</Names>"),i=n?j2(n,t,e,r):"",i.length>0&&a.push("<Table>"+i+"</Table>"),a.push(N2(n,t,e,r)),a.join("")}function I2(e,t){t||(t={}),e.SSF||(e.SSF=ir(Ie)),e.SSF&&(Fa(),zs(e.SSF),t.revssf=Xs(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],$t(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(y2(e,t)),r.push(b2()),r.push(""),r.push("");for(var a=0;a<e.SheetNames.length;++a)r.push(xe("Worksheet",D2(a,t,e),{"ss:Name":er(e.SheetNames[a])}));return r[2]=E2(e,t),r[3]=S2(e),vr+xe("Workbook",r.join(""),{xmlns:Yr.ss,"xmlns:o":Yr.o,"xmlns:x":Yr.x,"xmlns:ss":Yr.ss,"xmlns:dt":Yr.dt,"xmlns:html":Yr.html})}function O2(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=Sf(r),r.length-r.l<=4)return t;var a=r.read_shift(4);if(a==0||a>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(a=r.read_shift(4),a!==1907505652)||(t.UnicodeClipboardFormat=Tf(r),a=r.read_shift(4),a==0||a>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var L2=[60,1084,2066,2165,2175];function R2(e,t,r,a,s){var n=a,i=[],c=r.slice(r.l,r.l+n);if(s&&s.enc&&s.enc.insitu&&c.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:s.enc.insitu(c)}i.push(c),r.l+=n;for(var l=Tt(r,r.l),f=In[l],d=0;f!=null&&L2.indexOf(l)>-1;)n=Tt(r,r.l+2),d=r.l+4,l==2066?d+=4:(l==2165||l==2175)&&(d+=12),c=r.slice(d,r.l+4+n),i.push(c),r.l+=4+n,f=In[l=Tt(r,r.l)];var u=Tr(i);Cr(u,0);var h=0;u.lens=[];for(var m=0;m<i.length;++m)u.lens.push(h),h+=i[m].length;if(u.length<a)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+u.length+" < "+a;return t.f(u,u.length,s)}function vt(e,t,r){if(e.t!=="z"&&e.XF){var a=0;try{a=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=Ie[a])}catch(n){if(t.WTF)throw n}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||It[e.v]:a===0||a=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Ka(e.v):e.w=ra(e.v):e.w=ct(a,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(n){if(t.WTF)throw n}if(t.cellDates&&a&&e.t=="n"&&Na(Ie[a]||String(a))){var s=Jt(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}}function Ts(e,t,r){return{v:e,ixfe:t,t:r}}function M2(e,t){var r={opts:{}},a={},s=t.dense?[]:{},n={},i={},c=null,l=[],f="",d={},u,h="",m,g,x,p,k={},b=[],w,j,R=[],I=[],E={Sheets:[],WBProps:{date1904:!1},Views:[{}]},U={},N=function(ye){return ye<8?qt[ye]:ye<64&&I[ye-8]||qt[ye]},B=function(ye,Z,ue){var oe=Z.XF.data;if(!(!oe||!oe.patternType||!ue||!ue.cellStyles)){Z.s={},Z.s.patternType=oe.patternType;var be;(be=Qa(N(oe.icvFore)))&&(Z.s.fgColor={rgb:be}),(be=Qa(N(oe.icvBack)))&&(Z.s.bgColor={rgb:be})}},L=function(ye,Z,ue){if(!(Ee>1)&&!(ue.sheetRows&&ye.r>=ue.sheetRows)){if(ue.cellStyles&&Z.XF&&Z.XF.data&&B(ye,Z,ue),delete Z.ixfe,delete Z.XF,u=ye,h=Le(ye),(!i||!i.s||!i.e)&&(i={s:{r:0,c:0},e:{r:0,c:0}}),ye.r<i.s.r&&(i.s.r=ye.r),ye.c<i.s.c&&(i.s.c=ye.c),ye.r+1>i.e.r&&(i.e.r=ye.r+1),ye.c+1>i.e.c&&(i.e.c=ye.c+1),ue.cellFormula&&Z.f){for(var oe=0;oe<b.length;++oe)if(!(b[oe][0].s.c>ye.c||b[oe][0].s.r>ye.r)&&!(b[oe][0].e.c<ye.c||b[oe][0].e.r<ye.r)){Z.F=We(b[oe][0]),(b[oe][0].s.c!=ye.c||b[oe][0].s.r!=ye.r)&&delete Z.f,Z.f&&(Z.f=""+Or(b[oe][1],i,ye,H,P));break}}ue.dense?(s[ye.r]||(s[ye.r]=[]),s[ye.r][ye.c]=Z):s[h]=Z}},P={enc:!1,sbcch:0,snames:[],sharedf:k,arrayf:b,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(P.password=t.password);var Q,fe=[],ie=[],pe=[],he=[],Ve=!1,H=[];H.SheetNames=P.snames,H.sharedf=P.sharedf,H.arrayf=P.arrayf,H.names=[],H.XTI=[];var we=0,Ee=0,A=0,M=[],D=[],O;P.codepage=1200,ut(1200);for(var W=!1;e.l<e.length-1;){var ee=e.l,se=e.read_shift(2);if(se===0&&we===10)break;var J=e.l===e.length?0:e.read_shift(2),q=In[se];if(q&&q.f){if(t.bookSheets&&we===133&&se!==133)break;if(we=se,q.r===2||q.r==12){var ke=e.read_shift(2);if(J-=2,!P.enc&&ke!==se&&((ke&255)<<8|ke>>8)!==se)throw new Error("rt mismatch: "+ke+"!="+se);q.r==12&&(e.l+=10,J-=10)}var S={};if(se===10?S=q.f(e,J,P):S=R2(se,q,e,J,P),Ee==0&&[9,521,1033,2057].indexOf(we)===-1)continue;switch(se){case 34:r.opts.Date1904=E.WBProps.date1904=S;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(P.enc||(e.l=0),P.enc=S,!t.password)throw new Error("File is password-protected");if(S.valid==null)throw new Error("Encryption scheme unsupported");if(!S.valid)throw new Error("Password is incorrect");break;case 92:P.lastuser=S;break;case 66:var je=Number(S);switch(je){case 21010:je=1200;break;case 32768:je=1e4;break;case 32769:je=1252;break}ut(P.codepage=je),W=!0;break;case 317:P.rrtabid=S;break;case 25:P.winlocked=S;break;case 439:r.opts.RefreshAll=S;break;case 12:r.opts.CalcCount=S;break;case 16:r.opts.CalcDelta=S;break;case 17:r.opts.CalcIter=S;break;case 13:r.opts.CalcMode=S;break;case 14:r.opts.CalcPrecision=S;break;case 95:r.opts.CalcSaveRecalc=S;break;case 15:P.CalcRefMode=S;break;case 2211:r.opts.FullCalc=S;break;case 129:S.fDialog&&(s["!type"]="dialog"),S.fBelow||((s["!outline"]||(s["!outline"]={})).above=!0),S.fRight||((s["!outline"]||(s["!outline"]={})).left=!0);break;case 224:R.push(S);break;case 430:H.push([S]),H[H.length-1].XTI=[];break;case 35:case 547:H[H.length-1].push(S);break;case 24:case 536:O={Name:S.Name,Ref:Or(S.rgce,i,null,H,P)},S.itab>0&&(O.Sheet=S.itab-1),H.names.push(O),H[0]||(H[0]=[],H[0].XTI=[]),H[H.length-1].push(S),S.Name=="_xlnm._FilterDatabase"&&S.itab>0&&S.rgce&&S.rgce[0]&&S.rgce[0][0]&&S.rgce[0][0][0]=="PtgArea3d"&&(D[S.itab-1]={ref:We(S.rgce[0][0][1][2])});break;case 22:P.ExternCount=S;break;case 23:H.length==0&&(H[0]=[],H[0].XTI=[]),H[H.length-1].XTI=H[H.length-1].XTI.concat(S),H.XTI=H.XTI.concat(S);break;case 2196:if(P.biff<8)break;O!=null&&(O.Comment=S[1]);break;case 18:s["!protect"]=S;break;case 19:S!==0&&P.WTF&&console.error("Password verifier: "+S);break;case 133:n[S.pos]=S,P.snames.push(S.name);break;case 10:{if(--Ee)break;if(i.e){if(i.e.r>0&&i.e.c>0){if(i.e.r--,i.e.c--,s["!ref"]=We(i),t.sheetRows&&t.sheetRows<=i.e.r){var Ce=i.e.r;i.e.r=t.sheetRows-1,s["!fullref"]=s["!ref"],s["!ref"]=We(i),i.e.r=Ce}i.e.r++,i.e.c++}fe.length>0&&(s["!merges"]=fe),ie.length>0&&(s["!objects"]=ie),pe.length>0&&(s["!cols"]=pe),he.length>0&&(s["!rows"]=he),E.Sheets.push(U)}f===""?d=s:a[f]=s,s=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(P.biff===8&&(P.biff={9:2,521:3,1033:4}[se]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[S.BIFFVer]||8),P.biffguess=S.BIFFVer==0,S.BIFFVer==0&&S.dt==4096&&(P.biff=5,W=!0,ut(P.codepage=28591)),P.biff==8&&S.BIFFVer==0&&S.dt==16&&(P.biff=2),Ee++)break;if(s=t.dense?[]:{},P.biff<8&&!W&&(W=!0,ut(P.codepage=t.codepage||1252)),P.biff<5||S.BIFFVer==0&&S.dt==4096){f===""&&(f="Sheet1"),i={s:{r:0,c:0},e:{r:0,c:0}};var Be={pos:e.l-J,name:f};n[Be.pos]=Be,P.snames.push(f)}else f=(n[ee]||{name:""}).name;S.dt==32&&(s["!type"]="chart"),S.dt==64&&(s["!type"]="macro"),fe=[],ie=[],P.arrayf=b=[],pe=[],he=[],Ve=!1,U={Hidden:(n[ee]||{hs:0}).hs,name:f}}break;case 515:case 3:case 2:s["!type"]=="chart"&&(t.dense?(s[S.r]||[])[S.c]:s[Le({c:S.c,r:S.r})])&&++S.c,w={ixfe:S.ixfe,XF:R[S.ixfe]||{},v:S.val,t:"n"},A>0&&(w.z=M[w.ixfe>>8&63]),vt(w,t,r.opts.Date1904),L({c:S.c,r:S.r},w,t);break;case 5:case 517:w={ixfe:S.ixfe,XF:R[S.ixfe],v:S.val,t:S.t},A>0&&(w.z=M[w.ixfe>>8&63]),vt(w,t,r.opts.Date1904),L({c:S.c,r:S.r},w,t);break;case 638:w={ixfe:S.ixfe,XF:R[S.ixfe],v:S.rknum,t:"n"},A>0&&(w.z=M[w.ixfe>>8&63]),vt(w,t,r.opts.Date1904),L({c:S.c,r:S.r},w,t);break;case 189:for(var Fe=S.c;Fe<=S.C;++Fe){var ce=S.rkrec[Fe-S.c][0];w={ixfe:ce,XF:R[ce],v:S.rkrec[Fe-S.c][1],t:"n"},A>0&&(w.z=M[w.ixfe>>8&63]),vt(w,t,r.opts.Date1904),L({c:Fe,r:S.r},w,t)}break;case 6:case 518:case 1030:{if(S.val=="String"){c=S;break}if(w=Ts(S.val,S.cell.ixfe,S.tt),w.XF=R[w.ixfe],t.cellFormula){var Ye=S.formula;if(Ye&&Ye[0]&&Ye[0][0]&&Ye[0][0][0]=="PtgExp"){var hr=Ye[0][0][1][0],Re=Ye[0][0][1][1],Ur=Le({r:hr,c:Re});k[Ur]?w.f=""+Or(S.formula,i,S.cell,H,P):w.F=((t.dense?(s[hr]||[])[Re]:s[Ur])||{}).F}else w.f=""+Or(S.formula,i,S.cell,H,P)}A>0&&(w.z=M[w.ixfe>>8&63]),vt(w,t,r.opts.Date1904),L(S.cell,w,t),c=S}break;case 7:case 519:if(c)c.val=S,w=Ts(S,c.cell.ixfe,"s"),w.XF=R[w.ixfe],t.cellFormula&&(w.f=""+Or(c.formula,i,c.cell,H,P)),A>0&&(w.z=M[w.ixfe>>8&63]),vt(w,t,r.opts.Date1904),L(c.cell,w,t),c=null;else throw new Error("String record expects Formula");break;case 33:case 545:{b.push(S);var Kr=Le(S[0].s);if(m=t.dense?(s[S[0].s.r]||[])[S[0].s.c]:s[Kr],t.cellFormula&&m){if(!c||!Kr||!m)break;m.f=""+Or(S[1],i,S[0],H,P),m.F=We(S[0])}}break;case 1212:{if(!t.cellFormula)break;if(h){if(!c)break;k[Le(c.cell)]=S[0],m=t.dense?(s[c.cell.r]||[])[c.cell.c]:s[Le(c.cell)],(m||{}).f=""+Or(S[0],i,u,H,P)}}break;case 253:w=Ts(l[S.isst].t,S.ixfe,"s"),l[S.isst].h&&(w.h=l[S.isst].h),w.XF=R[w.ixfe],A>0&&(w.z=M[w.ixfe>>8&63]),vt(w,t,r.opts.Date1904),L({c:S.c,r:S.r},w,t);break;case 513:t.sheetStubs&&(w={ixfe:S.ixfe,XF:R[S.ixfe],t:"z"},A>0&&(w.z=M[w.ixfe>>8&63]),vt(w,t,r.opts.Date1904),L({c:S.c,r:S.r},w,t));break;case 190:if(t.sheetStubs)for(var $r=S.c;$r<=S.C;++$r){var cr=S.ixfe[$r-S.c];w={ixfe:cr,XF:R[cr],t:"z"},A>0&&(w.z=M[w.ixfe>>8&63]),vt(w,t,r.opts.Date1904),L({c:$r,r:S.r},w,t)}break;case 214:case 516:case 4:w=Ts(S.val,S.ixfe,"s"),w.XF=R[w.ixfe],A>0&&(w.z=M[w.ixfe>>8&63]),vt(w,t,r.opts.Date1904),L({c:S.c,r:S.r},w,t);break;case 0:case 512:Ee===1&&(i=S);break;case 252:l=S;break;case 1054:if(P.biff==4){M[A++]=S[1];for(var ae=0;ae<A+163&&Ie[ae]!=S[1];++ae);ae>=163&&Ft(S[1],A+163)}else Ft(S[1],S[0]);break;case 30:{M[A++]=S;for(var re=0;re<A+163&&Ie[re]!=S;++re);re>=163&&Ft(S,A+163)}break;case 229:fe=fe.concat(S);break;case 93:ie[S.cmo[0]]=P.lastobj=S;break;case 438:P.lastobj.TxO=S;break;case 127:P.lastobj.ImData=S;break;case 440:for(p=S[0].s.r;p<=S[0].e.r;++p)for(x=S[0].s.c;x<=S[0].e.c;++x)m=t.dense?(s[p]||[])[x]:s[Le({c:x,r:p})],m&&(m.l=S[1]);break;case 2048:for(p=S[0].s.r;p<=S[0].e.r;++p)for(x=S[0].s.c;x<=S[0].e.c;++x)m=t.dense?(s[p]||[])[x]:s[Le({c:x,r:p})],m&&m.l&&(m.l.Tooltip=S[1]);break;case 28:{if(P.biff<=5&&P.biff>=2)break;m=t.dense?(s[S[0].r]||[])[S[0].c]:s[Le(S[0])];var ge=ie[S[2]];m||(t.dense?(s[S[0].r]||(s[S[0].r]=[]),m=s[S[0].r][S[0].c]={t:"z"}):m=s[Le(S[0])]={t:"z"},i.e.r=Math.max(i.e.r,S[0].r),i.s.r=Math.min(i.s.r,S[0].r),i.e.c=Math.max(i.e.c,S[0].c),i.s.c=Math.min(i.s.c,S[0].c)),m.c||(m.c=[]),g={a:S[1],t:ge.TxO.t},m.c.push(g)}break;case 2173:Ex(R[S.ixfe],S.ext);break;case 125:{if(!P.cellStyles)break;for(;S.e>=S.s;)pe[S.e--]={width:S.w/256,level:S.level||0,hidden:!!(S.flags&1)},Ve||(Ve=!0,c0(S.w/256)),Bt(pe[S.e+1])}break;case 520:{var Te={};S.level!=null&&(he[S.r]=Te,Te.level=S.level),S.hidden&&(he[S.r]=Te,Te.hidden=!0),S.hpt&&(he[S.r]=Te,Te.hpt=S.hpt,Te.hpx=Sa(S.hpt))}break;case 38:case 39:case 40:case 41:s["!margins"]||ea(s["!margins"]={}),s["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[se]]=S;break;case 161:s["!margins"]||ea(s["!margins"]={}),s["!margins"].header=S.header,s["!margins"].footer=S.footer;break;case 574:S.RTL&&(E.Views[0].RTL=!0);break;case 146:I=S;break;case 2198:Q=S;break;case 140:j=S;break;case 442:f?U.CodeName=S||U.name:E.WBProps.CodeName=S||"ThisWorkbook";break}}else q||console.error("Missing Info for XLS Record 0x"+se.toString(16)),e.l+=J}return r.SheetNames=mr(n).sort(function(Oe,ye){return Number(Oe)-Number(ye)}).map(function(Oe){return n[Oe].name}),t.bookSheets||(r.Sheets=a),!r.SheetNames.length&&d["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=d)):r.Preamble=d,r.Sheets&&D.forEach(function(Oe,ye){r.Sheets[r.SheetNames[ye]]["!autofilter"]=Oe}),r.Strings=l,r.SSF=ir(Ie),P.enc&&(r.Encryption=P.enc),Q&&(r.Themes=Q),r.Metadata={},j!==void 0&&(r.Metadata.Country=j),H.names.length>0&&(E.Names=H.names),r.Workbook=E,r}var za={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function P2(e,t,r){var a=Ae.find(e,"/!DocumentSummaryInformation");if(a&&a.size>0)try{var s=ti(a,Tn,za.DSI);for(var n in s)t[n]=s[n]}catch(f){if(r.WTF)throw f}var i=Ae.find(e,"/!SummaryInformation");if(i&&i.size>0)try{var c=ti(i,Nn,za.SI);for(var l in c)t[l]==null&&(t[l]=c[l])}catch(f){if(r.WTF)throw f}t.HeadingPairs&&t.TitlesOfParts&&(jc(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function B2(e,t){var r=[],a=[],s=[],n=0,i,c=D0(Tn,"n"),l=D0(Nn,"n");if(e.Props)for(i=mr(e.Props),n=0;n<i.length;++n)(Object.prototype.hasOwnProperty.call(c,i[n])?r:Object.prototype.hasOwnProperty.call(l,i[n])?a:s).push([i[n],e.Props[i[n]]]);if(e.Custprops)for(i=mr(e.Custprops),n=0;n<i.length;++n)Object.prototype.hasOwnProperty.call(e.Props||{},i[n])||(Object.prototype.hasOwnProperty.call(c,i[n])?r:Object.prototype.hasOwnProperty.call(l,i[n])?a:s).push([i[n],e.Custprops[i[n]]]);var f=[];for(n=0;n<s.length;++n)Pc.indexOf(s[n][0])>-1||Ac.indexOf(s[n][0])>-1||s[n][1]!=null&&f.push(s[n]);a.length&&Ae.utils.cfb_add(t,"/SummaryInformation",ai(a,za.SI,l,Nn)),(r.length||f.length)&&Ae.utils.cfb_add(t,"/DocumentSummaryInformation",ai(r,za.DSI,c,Tn,f.length?f:null,za.UDI))}function Oo(e,t){t||(t={}),g0(t),Mn(),t.codepage&&Rn(t.codepage);var r,a;if(e.FullPaths){if(Ae.find(e,"/encryption"))throw new Error("File is password-protected");r=Ae.find(e,"!CompObj"),a=Ae.find(e,"/Workbook")||Ae.find(e,"/Book")}else{switch(t.type){case"base64":e=qr(Qr(e));break;case"binary":e=qr(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}Cr(e,0),a={content:e}}var s,n;if(r&&O2(r),t.bookProps&&!t.bookSheets)s={};else{var i=$e?"buffer":"array";if(a&&a.content)s=M2(a.content,t);else if((n=Ae.find(e,"PerfectOffice_MAIN"))&&n.content)s=Qt.to_workbook(n.content,(t.type=i,t));else if((n=Ae.find(e,"NativeContent_MAIN"))&&n.content)s=Qt.to_workbook(n.content,(t.type=i,t));else throw(n=Ae.find(e,"MN0"))&&n.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&Ae.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(s.vbaraw=Zx(e))}var c={};return e.FullPaths&&P2(e,c,t),s.Props=s.Custprops=c,t.bookFiles&&(s.cfb=e),s}function U2(e,t){var r=t||{},a=Ae.utils.cfb_new({root:"R"}),s="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":s="/Workbook",r.biff=8;break;case"biff5":s="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return Ae.utils.cfb_add(a,s,Lo(e,r)),r.biff==8&&(e.Props||e.Custprops)&&B2(e,a),r.biff==8&&e.vbaraw&&Qx(a,Ae.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),a}var as={0:{f:fg},1:{f:vg},2:{f:Mg},3:{f:Tg},4:{f:yg},5:{f:Og},6:{f:Hg},7:{f:Ag},8:{f:Yg},9:{f:Kg},10:{f:Gg},11:{f:Xg},12:{f:kg},13:{f:Bg},14:{f:Fg},15:{f:Eg},16:{f:To},17:{f:$g},18:{f:Dg},19:{f:qn},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:$p},40:{},42:{},43:{f:Hu},44:{f:Uu},45:{f:zu},46:{f:Xu},47:{f:Gu},48:{},49:{f:uf},50:{},51:{f:Nx},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:Yc},62:{f:Wg},63:{f:Rx},64:{f:dp},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Pr,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:cp},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:gg},148:{f:ug,p:16},151:{f:rp},152:{},153:{f:Wp},154:{},155:{},156:{f:Bp},157:{},158:{},159:{T:1,f:au},160:{T:-1},161:{T:1,f:da},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:Jg},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:Sx},336:{T:-1},337:{f:Ax,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Sn},357:{},358:{},359:{},360:{T:1},361:{},362:{f:Kc},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:tp},427:{f:ap},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:np},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:mg},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:Qg},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Sn},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:Xx},633:{T:1},634:{T:-1},635:{T:1,f:zx},636:{T:-1},637:{f:pf},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:Fp},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:hp},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},In={6:{f:dn},10:{f:Ot},12:{f:_r},13:{f:_r},14:{f:gr},15:{f:gr},16:{f:Rr},17:{f:gr},18:{f:gr},19:{f:_r},20:{f:li},21:{f:li},23:{f:Kc},24:{f:di},25:{f:gr},26:{},27:{},28:{f:hh},29:{},34:{f:gr},35:{f:fi},38:{f:Rr},39:{f:Rr},40:{f:Rr},41:{f:Rr},42:{f:gr},43:{f:gr},47:{f:Eu},49:{f:Bd},51:{f:_r},60:{},61:{f:Od},64:{f:gr},65:{f:Pd},66:{f:_r},77:{},80:{},81:{},82:{},85:{f:_r},89:{},90:{},91:{},92:{f:bd},93:{f:mh},94:{},95:{f:gr},96:{},97:{},99:{f:gr},125:{f:Yc},128:{f:eh},129:{f:Sd},130:{f:_r},131:{f:gr},132:{f:gr},133:{f:Td},134:{},140:{f:bh},141:{f:_r},144:{},146:{f:Th},151:{},152:{},153:{},154:{},155:{},156:{f:_r},157:{},158:{},160:{f:Ih},161:{f:Ch},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:Jd},190:{f:qd},193:{f:Ot},197:{},198:{},199:{},200:{},201:{},202:{f:gr},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:_r},220:{},221:{f:gr},222:{},224:{f:Qd},225:{f:yd},226:{f:Ot},227:{},229:{f:uh},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:Fd},253:{f:Wd},255:{f:Ad},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:Bc},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:gr},353:{f:Ot},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:nh},431:{f:gr},432:{},433:{},434:{},437:{},438:{f:vh},439:{f:gr},440:{f:wh},441:{},442:{f:hs},443:{},444:{f:_r},445:{},446:{},448:{f:Ot},449:{f:Id,r:2},450:{f:Ot},512:{f:ii},513:{f:Dh},515:{f:ah},516:{f:Vd},517:{f:oi},519:{f:Oh},520:{f:jd},523:{},545:{f:hi},549:{f:ni},566:{},574:{f:Rd},638:{f:Yd},659:{},1048:{},1054:{f:zd},1084:{},1212:{f:lh},2048:{f:_h},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:bs},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Ot},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:Nh,r:12},2173:{f:bx,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:gr,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:oh,r:12},2197:{},2198:{f:px,r:12},2199:{},2200:{},2201:{},2202:{f:fh,r:12},2203:{f:Ot},2204:{},2205:{},2206:{},2207:{},2211:{f:Dd},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:_r},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:Ah},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:Sh},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:ii},1:{},2:{f:Bh},3:{f:Mh},4:{f:Rh},5:{f:oi},7:{f:Wh},8:{},9:{f:bs},11:{},22:{f:_r},30:{f:Xd},31:{},32:{},33:{f:hi},36:{},37:{f:ni},50:{f:Hh},62:{},52:{},67:{},68:{f:_r},69:{},86:{},126:{},127:{f:Lh},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:Vh},223:{},234:{},354:{},421:{},518:{f:dn},521:{f:bs},536:{f:di},547:{f:fi},561:{},579:{},1030:{f:dn},1033:{f:bs},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function me(e,t,r,a){var s=t;if(!isNaN(s)){var n=a||(r||[]).length||0,i=e.next(4);i.write_shift(2,s),i.write_shift(2,n),n>0&&Kn(r)&&e.push(r)}}function W2(e,t,r,a){var s=(r||[]).length||0;if(s<=8224)return me(e,t,r,s);var n=t;if(!isNaN(n)){for(var i=r.parts||[],c=0,l=0,f=0;f+(i[c]||8224)<=8224;)f+=i[c]||8224,c++;var d=e.next(4);for(d.write_shift(2,n),d.write_shift(2,f),e.push(r.slice(l,l+f)),l+=f;l<s;){for(d=e.next(4),d.write_shift(2,60),f=0;f+(i[c]||8224)<=8224;)f+=i[c]||8224,c++;d.write_shift(2,f),e.push(r.slice(l,l+f)),l+=f}}}function gs(e,t,r){return e||(e=Y(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function H2(e,t,r,a){var s=Y(9);return gs(s,e,t),Uc(r,a||"b",s),s}function V2(e,t,r){var a=Y(8+2*r.length);return gs(a,e,t),a.write_shift(1,r.length),a.write_shift(r.length,r,"sbcs"),a.l<a.length?a.slice(0,a.l):a}function $2(e,t,r,a){if(t.v!=null)switch(t.t){case"d":case"n":var s=t.t=="d"?br(nr(t.v)):t.v;s==(s|0)&&s>=0&&s<65536?me(e,2,Uh(r,a,s)):me(e,3,Ph(r,a,s));return;case"b":case"e":me(e,5,H2(r,a,t.v,t.t));return;case"s":case"str":me(e,4,V2(r,a,(t.v||"").slice(0,255)));return}me(e,1,gs(null,r,a))}function z2(e,t,r,a){var s=Array.isArray(t),n=Xe(t["!ref"]||"A1"),i,c="",l=[];if(n.e.c>255||n.e.r>16383){if(a.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");n.e.c=Math.min(n.e.c,255),n.e.r=Math.min(n.e.c,16383),i=We(n)}for(var f=n.s.r;f<=n.e.r;++f){c=pr(f);for(var d=n.s.c;d<=n.e.c;++d){f===n.s.r&&(l[d]=fr(d)),i=l[d]+c;var u=s?(t[f]||[])[d]:t[i];u&&$2(e,u,f,d)}}}function G2(e,t){for(var r=t||{},a=Gr(),s=0,n=0;n<e.SheetNames.length;++n)e.SheetNames[n]==r.sheet&&(s=n);if(s==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return me(a,r.biff==4?1033:r.biff==3?521:9,s0(e,16,r)),z2(a,e.Sheets[e.SheetNames[s]],s,r),me(a,10),a.end()}function X2(e,t,r){me(e,49,Ud({sz:12,name:"Arial"},r))}function K2(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var s=a[0];s<=a[1];++s)t[s]!=null&&me(e,1054,Gd(s,t[s],r))})}function Y2(e,t){var r=Y(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),me(e,2151,r),r=Y(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),zc(Xe(t["!ref"]||"A1"),r),r.write_shift(4,4),me(e,2152,r)}function J2(e,t){for(var r=0;r<16;++r)me(e,224,ci({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(a){me(e,224,ci(a,0,t))})}function q2(e,t){for(var r=0;r<t["!links"].length;++r){var a=t["!links"][r];me(e,440,kh(a)),a[1].Tooltip&&me(e,2048,yh(a))}delete t["!links"]}function Z2(e,t){if(t){var r=0;t.forEach(function(a,s){++r<=256&&a&&me(e,125,Fh(Zs(s,a),s))})}}function Q2(e,t,r,a,s){var n=16+$t(s.cellXfs,t,s);if(t.v==null&&!t.bf){me(e,513,na(r,a,n));return}if(t.bf)me(e,6,Sm(t,r,a,s,n));else switch(t.t){case"d":case"n":var i=t.t=="d"?br(nr(t.v)):t.v;me(e,515,sh(r,a,i,n));break;case"b":case"e":me(e,517,th(r,a,t.v,n,s,t.t));break;case"s":case"str":if(s.bookSST){var c=h0(s.Strings,t.v,s.revStrings);me(e,253,Hd(r,a,c,n))}else me(e,516,$d(r,a,(t.v||"").slice(0,255),n,s));break;default:me(e,513,na(r,a,n))}}function ev(e,t,r){var a=Gr(),s=r.SheetNames[e],n=r.Sheets[s]||{},i=(r||{}).Workbook||{},c=(i.Sheets||[])[e]||{},l=Array.isArray(n),f=t.biff==8,d,u="",h=[],m=Xe(n["!ref"]||"A1"),g=f?65536:16384;if(m.e.c>255||m.e.r>=g){if(t.WTF)throw new Error("Range "+(n["!ref"]||"A1")+" exceeds format limit A1:IV16384");m.e.c=Math.min(m.e.c,255),m.e.r=Math.min(m.e.c,g-1)}me(a,2057,s0(r,16,t)),me(a,13,nt(1)),me(a,12,nt(100)),me(a,15,Hr(!0)),me(a,17,Hr(!1)),me(a,16,aa(.001)),me(a,95,Hr(!0)),me(a,42,Hr(!1)),me(a,43,Hr(!1)),me(a,130,nt(1)),me(a,128,rh()),me(a,131,Hr(!1)),me(a,132,Hr(!1)),f&&Z2(a,n["!cols"]),me(a,512,Kd(m,t)),f&&(n["!links"]=[]);for(var x=m.s.r;x<=m.e.r;++x){u=pr(x);for(var p=m.s.c;p<=m.e.c;++p){x===m.s.r&&(h[p]=fr(p)),d=h[p]+u;var k=l?(n[x]||[])[p]:n[d];k&&(Q2(a,k,x,p,t),f&&k.l&&n["!links"].push([d,k.l]))}}var b=c.CodeName||c.name||s;return f&&me(a,574,Md((i.Views||[])[0])),f&&(n["!merges"]||[]).length&&me(a,229,xh(n["!merges"])),f&&q2(a,n),me(a,442,Wc(b)),f&&Y2(a,n),me(a,10),a.end()}function rv(e,t,r){var a=Gr(),s=(e||{}).Workbook||{},n=s.Sheets||[],i=s.WBProps||{},c=r.biff==8,l=r.biff==5;if(me(a,2057,s0(e,5,r)),r.bookType=="xla"&&me(a,135),me(a,225,c?nt(1200):null),me(a,193,td(2)),l&&me(a,191),l&&me(a,192),me(a,226),me(a,92,Ed("SheetJS",r)),me(a,66,nt(c?1200:1252)),c&&me(a,353,nt(0)),c&&me(a,448),me(a,317,jh(e.SheetNames.length)),c&&e.vbaraw&&me(a,211),c&&e.vbaraw){var f=i.CodeName||"ThisWorkbook";me(a,442,Wc(f))}me(a,156,nt(17)),me(a,25,Hr(!1)),me(a,18,Hr(!1)),me(a,19,nt(0)),c&&me(a,431,Hr(!1)),c&&me(a,444,nt(0)),me(a,61,Ld()),me(a,64,Hr(!1)),me(a,141,nt(0)),me(a,34,Hr(Ip(e)=="true")),me(a,14,Hr(!0)),c&&me(a,439,Hr(!1)),me(a,218,nt(0)),X2(a,e,r),K2(a,e.SSF,r),J2(a,r),c&&me(a,352,Hr(!1));var d=a.end(),u=Gr();c&&me(u,140,Eh()),c&&r.Strings&&W2(u,252,Cd(r.Strings)),me(u,10);var h=u.end(),m=Gr(),g=0,x=0;for(x=0;x<e.SheetNames.length;++x)g+=(c?12:11)+(c?2:1)*e.SheetNames[x].length;var p=d.length+g+h.length;for(x=0;x<e.SheetNames.length;++x){var k=n[x]||{};me(m,133,Nd({pos:p,hs:k.Hidden||0,dt:0,name:e.SheetNames[x]},r)),p+=t[x].length}var b=m.end();if(g!=b.length)throw new Error("BS8 "+g+" != "+b.length);var w=[];return d.length&&w.push(d),b.length&&w.push(b),h.length&&w.push(h),Tr(w)}function tv(e,t){var r=t||{},a=[];e&&!e.SSF&&(e.SSF=ir(Ie)),e&&e.SSF&&(Fa(),zs(e.SSF),r.revssf=Xs(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,p0(r),r.cellXfs=[],$t(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var s=0;s<e.SheetNames.length;++s)a[a.length]=ev(s,r,e);return a.unshift(rv(e,a,r)),Tr(a)}function Lo(e,t){for(var r=0;r<=e.SheetNames.length;++r){var a=e.Sheets[e.SheetNames[r]];if(!(!a||!a["!ref"])){var s=Xr(a["!ref"]);s.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var n=t||{};switch(n.biff||2){case 8:case 5:return tv(e,t);case 4:case 3:case 2:return G2(e,t)}throw new Error("invalid type "+n.bookType+" for BIFF")}function yi(e,t){var r=t||{},a=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var s=e.match(/<table/i);if(!s)throw new Error("Invalid HTML: could not find <table>");var n=e.match(/<\/table/i),i=s.index,c=n&&n.index||e.length,l=Bl(e.slice(i,c),/(:?<tr[^>]*>)/i,"<tr>"),f=-1,d=0,u=0,h=0,m={s:{r:1e7,c:1e7},e:{r:0,c:0}},g=[];for(i=0;i<l.length;++i){var x=l[i].trim(),p=x.slice(0,3).toLowerCase();if(p=="<tr"){if(++f,r.sheetRows&&r.sheetRows<=f){--f;break}d=0;continue}if(!(p!="<td"&&p!="<th")){var k=x.split(/<\/t[dh]>/i);for(c=0;c<k.length;++c){var b=k[c].trim();if(b.match(/<t[dh]/i)){for(var w=b,j=0;w.charAt(0)=="<"&&(j=w.indexOf(">"))>-1;)w=w.slice(j+1);for(var R=0;R<g.length;++R){var I=g[R];I.s.c==d&&I.s.r<f&&f<=I.e.r&&(d=I.e.c+1,R=-1)}var E=Me(b.slice(0,b.indexOf(">")));h=E.colspan?+E.colspan:1,((u=+E.rowspan)>1||h>1)&&g.push({s:{r:f,c:d},e:{r:f+(u||1)-1,c:d+h-1}});var U=E.t||E["data-t"]||"";if(!w.length){d+=h;continue}if(w=sc(w),m.s.r>f&&(m.s.r=f),m.e.r<f&&(m.e.r=f),m.s.c>d&&(m.s.c=d),m.e.c<d&&(m.e.c=d),!w.length){d+=h;continue}var N={t:"s",v:w};r.raw||!w.trim().length||U=="s"||(w==="TRUE"?N={t:"b",v:!0}:w==="FALSE"?N={t:"b",v:!1}:isNaN(mt(w))?isNaN(ba(w).getDate())||(N={t:"d",v:nr(w)},r.cellDates||(N={t:"n",v:br(N.v)}),N.z=r.dateNF||Ie[14]):N={t:"n",v:mt(w)}),r.dense?(a[f]||(a[f]=[]),a[f][d]=N):a[Le({r:f,c:d})]=N,d+=h}}}}return a["!ref"]=We(m),g.length&&(a["!merges"]=g),a}function av(e,t,r,a){for(var s=e["!merges"]||[],n=[],i=t.s.c;i<=t.e.c;++i){for(var c=0,l=0,f=0;f<s.length;++f)if(!(s[f].s.r>r||s[f].s.c>i)&&!(s[f].e.r<r||s[f].e.c<i)){if(s[f].s.r<r||s[f].s.c<i){c=-1;break}c=s[f].e.r-s[f].s.r+1,l=s[f].e.c-s[f].s.c+1;break}if(!(c<0)){var d=Le({r,c:i}),u=a.dense?(e[r]||[])[i]:e[d],h=u&&u.v!=null&&(u.h||zn(u.w||(At(u),u.w)||""))||"",m={};c>1&&(m.rowspan=c),l>1&&(m.colspan=l),a.editable?h='<span contenteditable="true">'+h+"</span>":u&&(m["data-t"]=u&&u.t||"z",u.v!=null&&(m["data-v"]=u.v),u.z!=null&&(m["data-z"]=u.z),u.l&&(u.l.Target||"#").charAt(0)!="#"&&(h='<a href="'+u.l.Target+'">'+h+"</a>")),m.id=(a.id||"sjs")+"-"+d,n.push(xe("td",h,m))}}var g="<tr>";return g+n.join("")+"</tr>"}var sv='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',nv="</body></html>";function iv(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return Vt(yi(r[0],t),t);var a=k0();return r.forEach(function(s,n){_0(a,yi(s,t),"Sheet"+(n+1))}),a}function cv(e,t,r){var a=[];return a.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function Ro(e,t){var r=t||{},a=r.header!=null?r.header:sv,s=r.footer!=null?r.footer:nv,n=[a],i=Xr(e["!ref"]);r.dense=Array.isArray(e),n.push(cv(e,i,r));for(var c=i.s.r;c<=i.e.r;++c)n.push(av(e,i,c,r));return n.push("</table>"+s),n.join("")}function Mo(e,t,r){var a=r||{},s=0,n=0;if(a.origin!=null)if(typeof a.origin=="number")s=a.origin;else{var i=typeof a.origin=="string"?dr(a.origin):a.origin;s=i.r,n=i.c}var c=t.getElementsByTagName("tr"),l=Math.min(a.sheetRows||1e7,c.length),f={s:{r:0,c:0},e:{r:s,c:n}};if(e["!ref"]){var d=Xr(e["!ref"]);f.s.r=Math.min(f.s.r,d.s.r),f.s.c=Math.min(f.s.c,d.s.c),f.e.r=Math.max(f.e.r,d.e.r),f.e.c=Math.max(f.e.c,d.e.c),s==-1&&(f.e.r=s=d.e.r+1)}var u=[],h=0,m=e["!rows"]||(e["!rows"]=[]),g=0,x=0,p=0,k=0,b=0,w=0;for(e["!cols"]||(e["!cols"]=[]);g<c.length&&x<l;++g){var j=c[g];if(bi(j)){if(a.display)continue;m[x]={hidden:!0}}var R=j.children;for(p=k=0;p<R.length;++p){var I=R[p];if(!(a.display&&bi(I))){var E=I.hasAttribute("data-v")?I.getAttribute("data-v"):I.hasAttribute("v")?I.getAttribute("v"):sc(I.innerHTML),U=I.getAttribute("data-z")||I.getAttribute("z");for(h=0;h<u.length;++h){var N=u[h];N.s.c==k+n&&N.s.r<x+s&&x+s<=N.e.r&&(k=N.e.c+1-n,h=-1)}w=+I.getAttribute("colspan")||1,((b=+I.getAttribute("rowspan")||1)>1||w>1)&&u.push({s:{r:x+s,c:k+n},e:{r:x+s+(b||1)-1,c:k+n+(w||1)-1}});var B={t:"s",v:E},L=I.getAttribute("data-t")||I.getAttribute("t")||"";E!=null&&(E.length==0?B.t=L||"z":a.raw||E.trim().length==0||L=="s"||(E==="TRUE"?B={t:"b",v:!0}:E==="FALSE"?B={t:"b",v:!1}:isNaN(mt(E))?isNaN(ba(E).getDate())||(B={t:"d",v:nr(E)},a.cellDates||(B={t:"n",v:br(B.v)}),B.z=a.dateNF||Ie[14]):B={t:"n",v:mt(E)})),B.z===void 0&&U!=null&&(B.z=U);var P="",Q=I.getElementsByTagName("A");if(Q&&Q.length)for(var fe=0;fe<Q.length&&!(Q[fe].hasAttribute("href")&&(P=Q[fe].getAttribute("href"),P.charAt(0)!="#"));++fe);P&&P.charAt(0)!="#"&&(B.l={Target:P}),a.dense?(e[x+s]||(e[x+s]=[]),e[x+s][k+n]=B):e[Le({c:k+n,r:x+s})]=B,f.e.c<k+n&&(f.e.c=k+n),k+=w}}++x}return u.length&&(e["!merges"]=(e["!merges"]||[]).concat(u)),f.e.r=Math.max(f.e.r,x-1+s),e["!ref"]=We(f),x>=l&&(e["!fullref"]=We((f.e.r=c.length-g+x-1+s,f))),e}function Po(e,t){var r=t||{},a=r.dense?[]:{};return Mo(a,e,t)}function ov(e,t){return Vt(Po(e,t),t)}function bi(e){var t="",r=lv(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function lv(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function fv(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(a,s){return Array(parseInt(s,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=Ge(t.replace(/<[^>]*>/g,""));return[r]}var Ei={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function Bo(e,t){var r=t||{},a=Gn(e),s=[],n,i,c={name:""},l="",f=0,d,u,h={},m=[],g=r.dense?[]:{},x,p,k={value:""},b="",w=0,j=[],R=-1,I=-1,E={s:{r:1e6,c:1e7},e:{r:0,c:0}},U=0,N={},B=[],L={},P=0,Q=0,fe=[],ie=1,pe=1,he=[],Ve={Names:[]},H={},we=["",""],Ee=[],A={},M="",D=0,O=!1,W=!1,ee=0;for(qa.lastIndex=0,a=a.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");x=qa.exec(a);)switch(x[3]=x[3].replace(/_.*$/,"")){case"table":case"工作表":x[1]==="/"?(E.e.c>=E.s.c&&E.e.r>=E.s.r?g["!ref"]=We(E):g["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=E.e.r&&(g["!fullref"]=g["!ref"],E.e.r=r.sheetRows-1,g["!ref"]=We(E)),B.length&&(g["!merges"]=B),fe.length&&(g["!rows"]=fe),d.name=d.名称||d.name,typeof JSON<"u"&&JSON.stringify(d),m.push(d.name),h[d.name]=g,W=!1):x[0].charAt(x[0].length-2)!=="/"&&(d=Me(x[0],!1),R=I=-1,E.s.r=E.s.c=1e7,E.e.r=E.e.c=0,g=r.dense?[]:{},B=[],fe=[],W=!0);break;case"table-row-group":x[1]==="/"?--U:++U;break;case"table-row":case"行":if(x[1]==="/"){R+=ie,ie=1;break}if(u=Me(x[0],!1),u.行号?R=u.行号-1:R==-1&&(R=0),ie=+u["number-rows-repeated"]||1,ie<10)for(ee=0;ee<ie;++ee)U>0&&(fe[R+ee]={level:U});I=-1;break;case"covered-table-cell":x[1]!=="/"&&++I,r.sheetStubs&&(r.dense?(g[R]||(g[R]=[]),g[R][I]={t:"z"}):g[Le({r:R,c:I})]={t:"z"}),b="",j=[];break;case"table-cell":case"数据":if(x[0].charAt(x[0].length-2)==="/")++I,k=Me(x[0],!1),pe=parseInt(k["number-columns-repeated"]||"1",10),p={t:"z",v:null},k.formula&&r.cellFormula!=!1&&(p.f=wi(Ge(k.formula))),(k.数据类型||k["value-type"])=="string"&&(p.t="s",p.v=Ge(k["string-value"]||""),r.dense?(g[R]||(g[R]=[]),g[R][I]=p):g[Le({r:R,c:I})]=p),I+=pe-1;else if(x[1]!=="/"){++I,b="",w=0,j=[],pe=1;var se=ie?R+ie-1:R;if(I>E.e.c&&(E.e.c=I),I<E.s.c&&(E.s.c=I),R<E.s.r&&(E.s.r=R),se>E.e.r&&(E.e.r=se),k=Me(x[0],!1),Ee=[],A={},p={t:k.数据类型||k["value-type"],v:null},r.cellFormula)if(k.formula&&(k.formula=Ge(k.formula)),k["number-matrix-columns-spanned"]&&k["number-matrix-rows-spanned"]&&(P=parseInt(k["number-matrix-rows-spanned"],10)||0,Q=parseInt(k["number-matrix-columns-spanned"],10)||0,L={s:{r:R,c:I},e:{r:R+P-1,c:I+Q-1}},p.F=We(L),he.push([L,p.F])),k.formula)p.f=wi(k.formula);else for(ee=0;ee<he.length;++ee)R>=he[ee][0].s.r&&R<=he[ee][0].e.r&&I>=he[ee][0].s.c&&I<=he[ee][0].e.c&&(p.F=he[ee][1]);switch((k["number-columns-spanned"]||k["number-rows-spanned"])&&(P=parseInt(k["number-rows-spanned"],10)||0,Q=parseInt(k["number-columns-spanned"],10)||0,L={s:{r:R,c:I},e:{r:R+P-1,c:I+Q-1}},B.push(L)),k["number-columns-repeated"]&&(pe=parseInt(k["number-columns-repeated"],10)),p.t){case"boolean":p.t="b",p.v=sr(k["boolean-value"]);break;case"float":p.t="n",p.v=parseFloat(k.value);break;case"percentage":p.t="n",p.v=parseFloat(k.value);break;case"currency":p.t="n",p.v=parseFloat(k.value);break;case"date":p.t="d",p.v=nr(k["date-value"]),r.cellDates||(p.t="n",p.v=br(p.v)),p.z="m/d/yy";break;case"time":p.t="n",p.v=Rl(k["time-value"])/86400,r.cellDates&&(p.t="d",p.v=Ks(p.v)),p.z="HH:MM:SS";break;case"number":p.t="n",p.v=parseFloat(k.数据数值);break;default:if(p.t==="string"||p.t==="text"||!p.t)p.t="s",k["string-value"]!=null&&(b=Ge(k["string-value"]),j=[]);else throw new Error("Unsupported value type "+p.t)}}else{if(O=!1,p.t==="s"&&(p.v=b||"",j.length&&(p.R=j),O=w==0),H.Target&&(p.l=H),Ee.length>0&&(p.c=Ee,Ee=[]),b&&r.cellText!==!1&&(p.w=b),O&&(p.t="z",delete p.v),(!O||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=R))for(var J=0;J<ie;++J){if(pe=parseInt(k["number-columns-repeated"]||"1",10),r.dense)for(g[R+J]||(g[R+J]=[]),g[R+J][I]=J==0?p:ir(p);--pe>0;)g[R+J][I+pe]=ir(p);else for(g[Le({r:R+J,c:I})]=p;--pe>0;)g[Le({r:R+J,c:I+pe})]=ir(p);E.e.c<=I&&(E.e.c=I)}pe=parseInt(k["number-columns-repeated"]||"1",10),I+=pe-1,pe=0,p={},b="",j=[]}H={};break;case"document":case"document-content":case"电子表格文档":case"spreadsheet":case"主体":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(x[1]==="/"){if((n=s.pop())[0]!==x[3])throw"Bad state: "+n}else x[0].charAt(x[0].length-2)!=="/"&&s.push([x[3],!0]);break;case"annotation":if(x[1]==="/"){if((n=s.pop())[0]!==x[3])throw"Bad state: "+n;A.t=b,j.length&&(A.R=j),A.a=M,Ee.push(A)}else x[0].charAt(x[0].length-2)!=="/"&&s.push([x[3],!1]);M="",D=0,b="",w=0,j=[];break;case"creator":x[1]==="/"?M=a.slice(D,x.index):D=x.index+x[0].length;break;case"meta":case"元数据":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(x[1]==="/"){if((n=s.pop())[0]!==x[3])throw"Bad state: "+n}else x[0].charAt(x[0].length-2)!=="/"&&s.push([x[3],!1]);b="",w=0,j=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(x[1]==="/"){if(N[c.name]=l,(n=s.pop())[0]!==x[3])throw"Bad state: "+n}else x[0].charAt(x[0].length-2)!=="/"&&(l="",c=Me(x[0],!1),s.push([x[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(s[s.length-1][0]){case"time-style":case"date-style":i=Me(x[0],!1),l+=Ei[x[3]][i.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(s[s.length-1][0]){case"time-style":case"date-style":i=Me(x[0],!1),l+=Ei[x[3]][i.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(x[0].slice(-2)==="/>")break;if(x[1]==="/")switch(s[s.length-1][0]){case"number-style":case"date-style":case"time-style":l+=a.slice(f,x.index);break}else f=x.index+x[0].length;break;case"named-range":i=Me(x[0],!1),we=hn(i["cell-range-address"]);var q={Name:i.name,Ref:we[0]+"!"+we[1]};W&&(q.Sheet=m.length),Ve.Names.push(q);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"电子表格":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"文本串":if(["master-styles"].indexOf(s[s.length-1][0])>-1)break;if(x[1]==="/"&&(!k||!k["string-value"])){var ke=fv(a.slice(w,x.index));b=(b.length>0?b+`
`:"")+ke[0]}else Me(x[0],!1),w=x.index+x[0].length;break;case"s":break;case"database-range":if(x[1]==="/")break;try{we=hn(Me(x[0])["target-range-address"]),h[we[0]]["!autofilter"]={ref:we[1]}}catch{}break;case"date":break;case"object":break;case"title":case"标题":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(x[1]!=="/"){if(H=Me(x[0],!1),!H.href)break;H.Target=Ge(H.href),delete H.href,H.Target.charAt(0)=="#"&&H.Target.indexOf(".")>-1?(we=hn(H.Target.slice(1)),H.Target="#"+we[0]+"!"+we[1]):H.Target.match(/^\.\.[\\\/]/)&&(H.Target=H.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(x[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"表:":case"字:":break;default:if(r.WTF)throw new Error(x)}}var S={Sheets:h,SheetNames:m,Workbook:Ve};return r.bookSheets&&delete S.Sheets,S}function Si(e,t){t=t||{},st(e,"META-INF/manifest.xml")&&Mf(kr(e,"META-INF/manifest.xml"),t);var r=Zr(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var a=Bo(rr(r),t);return st(e,"meta.xml")&&(a.Props=Fc(kr(e,"meta.xml"))),a}function Ti(e,t){return Bo(e,t)}var dv=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+Ja({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return vr+t}}(),Ni=function(){var e=function(n){return er(n).replace(/  +/g,function(i){return'<text:s text:c="'+i.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,a=function(n,i,c){var l=[];l.push('      <table:table table:name="'+er(i.SheetNames[c])+`" table:style-name="ta1">
`);var f=0,d=0,u=Xr(n["!ref"]||"A1"),h=n["!merges"]||[],m=0,g=Array.isArray(n);if(n["!cols"])for(d=0;d<=u.e.c;++d)l.push("        <table:table-column"+(n["!cols"][d]?' table:style-name="co'+n["!cols"][d].ods+'"':"")+`></table:table-column>
`);var x="",p=n["!rows"]||[];for(f=0;f<u.s.r;++f)x=p[f]?' table:style-name="ro'+p[f].ods+'"':"",l.push("        <table:table-row"+x+`></table:table-row>
`);for(;f<=u.e.r;++f){for(x=p[f]?' table:style-name="ro'+p[f].ods+'"':"",l.push("        <table:table-row"+x+`>
`),d=0;d<u.s.c;++d)l.push(t);for(;d<=u.e.c;++d){var k=!1,b={},w="";for(m=0;m!=h.length;++m)if(!(h[m].s.c>d)&&!(h[m].s.r>f)&&!(h[m].e.c<d)&&!(h[m].e.r<f)){(h[m].s.c!=d||h[m].s.r!=f)&&(k=!0),b["table:number-columns-spanned"]=h[m].e.c-h[m].s.c+1,b["table:number-rows-spanned"]=h[m].e.r-h[m].s.r+1;break}if(k){l.push(r);continue}var j=Le({r:f,c:d}),R=g?(n[f]||[])[d]:n[j];if(R&&R.f&&(b["table:formula"]=er(jm(R.f)),R.F&&R.F.slice(0,j.length)==j)){var I=Xr(R.F);b["table:number-matrix-columns-spanned"]=I.e.c-I.s.c+1,b["table:number-matrix-rows-spanned"]=I.e.r-I.s.r+1}if(!R){l.push(t);continue}switch(R.t){case"b":w=R.v?"TRUE":"FALSE",b["office:value-type"]="boolean",b["office:boolean-value"]=R.v?"true":"false";break;case"n":w=R.w||String(R.v||0),b["office:value-type"]="float",b["office:value"]=R.v||0;break;case"s":case"str":w=R.v==null?"":R.v,b["office:value-type"]="string";break;case"d":w=R.w||nr(R.v).toISOString(),b["office:value-type"]="date",b["office:date-value"]=nr(R.v).toISOString(),b["table:style-name"]="ce1";break;default:l.push(t);continue}var E=e(w);if(R.l&&R.l.Target){var U=R.l.Target;U=U.charAt(0)=="#"?"#"+Dm(U.slice(1)):U,U.charAt(0)!="#"&&!U.match(/^\w+:/)&&(U="../"+U),E=xe("text:a",E,{"xlink:href":U.replace(/&/g,"&amp;")})}l.push("          "+xe("table:table-cell",xe("text:p",E,{}),b)+`
`)}l.push(`        </table:table-row>
`)}return l.push(`      </table:table>
`),l.join("")},s=function(n,i){n.push(` <office:automatic-styles>
`),n.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),n.push(`   <number:month number:style="long"/>
`),n.push(`   <number:text>/</number:text>
`),n.push(`   <number:day number:style="long"/>
`),n.push(`   <number:text>/</number:text>
`),n.push(`   <number:year/>
`),n.push(`  </number:date-style>
`);var c=0;i.SheetNames.map(function(f){return i.Sheets[f]}).forEach(function(f){if(f&&f["!cols"]){for(var d=0;d<f["!cols"].length;++d)if(f["!cols"][d]){var u=f["!cols"][d];if(u.width==null&&u.wpx==null&&u.wch==null)continue;Bt(u),u.ods=c;var h=f["!cols"][d].wpx+"px";n.push('  <style:style style:name="co'+c+`" style:family="table-column">
`),n.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+h+`"/>
`),n.push(`  </style:style>
`),++c}}});var l=0;i.SheetNames.map(function(f){return i.Sheets[f]}).forEach(function(f){if(f&&f["!rows"]){for(var d=0;d<f["!rows"].length;++d)if(f["!rows"][d]){f["!rows"][d].ods=l;var u=f["!rows"][d].hpx+"px";n.push('  <style:style style:name="ro'+l+`" style:family="table-row">
`),n.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+u+`"/>
`),n.push(`  </style:style>
`),++l}}}),n.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),n.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),n.push(`  </style:style>
`),n.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),n.push(` </office:automatic-styles>
`)};return function(i,c){var l=[vr],f=Ja({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),d=Ja({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});c.bookType=="fods"?(l.push("<office:document"+f+d+`>
`),l.push(Nc().replace(/office:document-meta/g,"office:meta"))):l.push("<office:document-content"+f+`>
`),s(l,i),l.push(`  <office:body>
`),l.push(`    <office:spreadsheet>
`);for(var u=0;u!=i.SheetNames.length;++u)l.push(a(i.Sheets[i.SheetNames[u]],i,u));return l.push(`    </office:spreadsheet>
`),l.push(`  </office:body>
`),c.bookType=="fods"?l.push("</office:document>"):l.push("</office:document-content>"),l.join("")}}();function Uo(e,t){if(t.bookType=="fods")return Ni(e,t);var r=Hn(),a="",s=[],n=[];return a="mimetype",He(r,a,"application/vnd.oasis.opendocument.spreadsheet"),a="content.xml",He(r,a,Ni(e,t)),s.push([a,"text/xml"]),n.push([a,"ContentFile"]),a="styles.xml",He(r,a,dv(e,t)),s.push([a,"text/xml"]),n.push([a,"StylesFile"]),a="meta.xml",He(r,a,vr+Nc()),s.push([a,"text/xml"]),n.push([a,"MetadataFile"]),a="manifest.rdf",He(r,a,Uf(n)),s.push([a,"application/rdf+xml"]),a="META-INF/manifest.xml",He(r,a,Pf(s)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function ia(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function On(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):rr(Ht(e))}function hv(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):qr(_t(e))}function uv(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var a=0;a<t.length;++a)if(e[r+a]!=t[a])continue e;return!0}return!1}function Wt(e){var t=e.reduce(function(s,n){return s+n.length},0),r=new Uint8Array(t),a=0;return e.forEach(function(s){r.set(s,a),a+=s.length}),r}function Fi(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function xv(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,a=e[t+14]&1,s=t+13;s>=t;--s)a=a*256+e[s];return(e[t+15]&128?-a:a)*Math.pow(10,r-6176)}function mv(e,t,r){var a=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,s=r/Math.pow(10,a-6176);e[t+15]|=a>>7,e[t+14]|=(a&127)<<1;for(var n=0;s>=1;++n,s/=256)e[t+n]=s&255;e[t+15]|=r>=0?0:128}function ss(e,t){var r=t?t[0]:0,a=e[r]&127;e:if(e[r++]>=128&&(a|=(e[r]&127)<<7,e[r++]<128||(a|=(e[r]&127)<<14,e[r++]<128)||(a|=(e[r]&127)<<21,e[r++]<128)||(a+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(a+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(a+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),a}function Ze(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function xr(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function Ke(e){for(var t=[],r=[0];r[0]<e.length;){var a=r[0],s=ss(e,r),n=s&7;s=Math.floor(s/8);var i=0,c;if(s==0)break;switch(n){case 0:{for(var l=r[0];e[r[0]++]>=128;);c=e.slice(l,r[0])}break;case 5:i=4,c=e.slice(r[0],r[0]+i),r[0]+=i;break;case 1:i=8,c=e.slice(r[0],r[0]+i),r[0]+=i;break;case 2:i=ss(e,r),c=e.slice(r[0],r[0]+i),r[0]+=i;break;case 3:case 4:default:throw new Error("PB Type ".concat(n," for Field ").concat(s," at offset ").concat(a))}var f={data:c,type:n};t[s]==null?t[s]=[f]:t[s].push(f)}return t}function Fr(e){var t=[];return e.forEach(function(r,a){r.forEach(function(s){s.data&&(t.push(Ze(a*8+s.type)),s.type==2&&t.push(Ze(s.data.length)),t.push(s.data))})}),Wt(t)}function m0(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function tt(e){for(var t,r=[],a=[0];a[0]<e.length;){var s=ss(e,a),n=Ke(e.slice(a[0],a[0]+s));a[0]+=s;var i={id:xr(n[1][0].data),messages:[]};n[2].forEach(function(c){var l=Ke(c.data),f=xr(l[3][0].data);i.messages.push({meta:l,data:e.slice(a[0],a[0]+f)}),a[0]+=f}),(t=n[3])!=null&&t[0]&&(i.merge=xr(n[3][0].data)>>>0>0),r.push(i)}return r}function ma(e){var t=[];return e.forEach(function(r){var a=[];a[1]=[{data:Ze(r.id),type:0}],a[2]=[],r.merge!=null&&(a[3]=[{data:Ze(+!!r.merge),type:0}]);var s=[];r.messages.forEach(function(i){s.push(i.data),i.meta[3]=[{type:0,data:Ze(i.data.length)}],a[2].push({data:Fr(i.meta),type:2})});var n=Fr(a);t.push(Ze(n.length)),t.push(n),s.forEach(function(i){return t.push(i)})}),Wt(t)}function gv(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],a=ss(t,r),s=[];r[0]<t.length;){var n=t[r[0]]&3;if(n==0){var i=t[r[0]++]>>2;if(i<60)++i;else{var c=i-59;i=t[r[0]],c>1&&(i|=t[r[0]+1]<<8),c>2&&(i|=t[r[0]+2]<<16),c>3&&(i|=t[r[0]+3]<<24),i>>>=0,i++,r[0]+=c}s.push(t.slice(r[0],r[0]+i)),r[0]+=i;continue}else{var l=0,f=0;if(n==1?(f=(t[r[0]]>>2&7)+4,l=(t[r[0]++]&224)<<3,l|=t[r[0]++]):(f=(t[r[0]++]>>2)+1,n==2?(l=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(l=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),s=[Wt(s)],l==0)throw new Error("Invalid offset 0");if(l>s[0].length)throw new Error("Invalid offset beyond length");if(f>=l)for(s.push(s[0].slice(-l)),f-=l;f>=s[s.length-1].length;)s.push(s[s.length-1]),f-=s[s.length-1].length;s.push(s[0].slice(-l,-l+f))}}var d=Wt(s);if(d.length!=a)throw new Error("Unexpected length: ".concat(d.length," != ").concat(a));return d}function at(e){for(var t=[],r=0;r<e.length;){var a=e[r++],s=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(gv(a,e.slice(r,r+s))),r+=s}if(r!==e.length)throw new Error("data is not a valid framed stream!");return Wt(t)}function ga(e){for(var t=[],r=0;r<e.length;){var a=Math.min(e.length-r,268435455),s=new Uint8Array(4);t.push(s);var n=Ze(a),i=n.length;t.push(n),a<=60?(i++,t.push(new Uint8Array([a-1<<2]))):a<=256?(i+=2,t.push(new Uint8Array([240,a-1&255]))):a<=65536?(i+=3,t.push(new Uint8Array([244,a-1&255,a-1>>8&255]))):a<=16777216?(i+=4,t.push(new Uint8Array([248,a-1&255,a-1>>8&255,a-1>>16&255]))):a<=4294967296&&(i+=5,t.push(new Uint8Array([252,a-1&255,a-1>>8&255,a-1>>16&255,a-1>>>24&255]))),t.push(e.slice(r,r+a)),i+=a,s[0]=0,s[1]=i&255,s[2]=i>>8&255,s[3]=i>>16&255,r+=a}return Wt(t)}function pv(e,t,r,a){var s=ia(e),n=s.getUint32(4,!0),i=(a>1?12:8)+Fi(n&(a>1?3470:398))*4,c=-1,l=-1,f=NaN,d=new Date(2001,0,1);n&512&&(c=s.getUint32(i,!0),i+=4),i+=Fi(n&(a>1?12288:4096))*4,n&16&&(l=s.getUint32(i,!0),i+=4),n&32&&(f=s.getFloat64(i,!0),i+=8),n&64&&(d.setTime(d.getTime()+s.getFloat64(i,!0)*1e3),i+=8);var u;switch(e[2]){case 0:break;case 2:u={t:"n",v:f};break;case 3:u={t:"s",v:t[l]};break;case 5:u={t:"d",v:d};break;case 6:u={t:"b",v:f>0};break;case 7:u={t:"n",v:f/86400};break;case 8:u={t:"e",v:0};break;case 9:if(c>-1)u={t:"s",v:r[c]};else if(l>-1)u={t:"s",v:t[l]};else if(!isNaN(f))u={t:"n",v:f};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return u}function vv(e,t,r){var a=ia(e),s=a.getUint32(8,!0),n=12,i=-1,c=-1,l=NaN,f=NaN,d=new Date(2001,0,1);s&1&&(l=xv(e,n),n+=16),s&2&&(f=a.getFloat64(n,!0),n+=8),s&4&&(d.setTime(d.getTime()+a.getFloat64(n,!0)*1e3),n+=8),s&8&&(c=a.getUint32(n,!0),n+=4),s&16&&(i=a.getUint32(n,!0),n+=4);var u;switch(e[1]){case 0:break;case 2:u={t:"n",v:l};break;case 3:u={t:"s",v:t[c]};break;case 5:u={t:"d",v:d};break;case 6:u={t:"b",v:f>0};break;case 7:u={t:"n",v:f/86400};break;case 8:u={t:"e",v:0};break;case 9:if(i>-1)u={t:"s",v:r[i]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)));break;case 10:u={t:"n",v:l};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)))}return u}function xn(e,t){var r=new Uint8Array(32),a=ia(r),s=12,n=0;switch(r[0]=5,e.t){case"n":r[1]=2,mv(r,s,e.v),n|=1,s+=16;break;case"b":r[1]=6,a.setFloat64(s,e.v?1:0,!0),n|=2,s+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,a.setUint32(s,t.indexOf(e.v),!0),n|=8,s+=4;break;default:throw"unsupported cell type "+e.t}return a.setUint32(8,n,!0),r.slice(0,s)}function mn(e,t){var r=new Uint8Array(32),a=ia(r),s=12,n=0;switch(r[0]=3,e.t){case"n":r[2]=2,a.setFloat64(s,e.v,!0),n|=32,s+=8;break;case"b":r[2]=6,a.setFloat64(s,e.v?1:0,!0),n|=32,s+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,a.setUint32(s,t.indexOf(e.v),!0),n|=16,s+=4;break;default:throw"unsupported cell type "+e.t}return a.setUint32(4,n,!0),r.slice(0,s)}function wv(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return pv(e,t,r,e[0]);case 5:return vv(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function Ir(e){var t=Ke(e);return ss(t[1][0].data)}function Ci(e,t){var r=Ke(t.data),a=xr(r[1][0].data),s=r[3],n=[];return(s||[]).forEach(function(i){var c=Ke(i.data),l=xr(c[1][0].data)>>>0;switch(a){case 1:n[l]=On(c[3][0].data);break;case 8:{var f=e[Ir(c[9][0].data)][0],d=Ke(f.data),u=e[Ir(d[1][0].data)][0],h=xr(u.meta[1][0].data);if(h!=2001)throw new Error("2000 unexpected reference to ".concat(h));var m=Ke(u.data);n[l]=m[3].map(function(g){return On(g.data)}).join("")}break}}),n}function kv(e,t){var r,a,s,n,i,c,l,f,d,u,h,m,g,x,p=Ke(e),k=xr(p[1][0].data)>>>0,b=xr(p[2][0].data)>>>0,w=((a=(r=p[8])==null?void 0:r[0])==null?void 0:a.data)&&xr(p[8][0].data)>0||!1,j,R;if((n=(s=p[7])==null?void 0:s[0])!=null&&n.data&&t!=0)j=(c=(i=p[7])==null?void 0:i[0])==null?void 0:c.data,R=(f=(l=p[6])==null?void 0:l[0])==null?void 0:f.data;else if((u=(d=p[4])==null?void 0:d[0])!=null&&u.data&&t!=1)j=(m=(h=p[4])==null?void 0:h[0])==null?void 0:m.data,R=(x=(g=p[3])==null?void 0:g[0])==null?void 0:x.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var I=w?4:1,E=ia(j),U=[],N=0;N<j.length/2;++N){var B=E.getUint16(N*2,!0);B<65535&&U.push([N,B])}if(U.length!=b)throw"Expected ".concat(b," cells, found ").concat(U.length);var L=[];for(N=0;N<U.length-1;++N)L[U[N][0]]=R.subarray(U[N][1]*I,U[N+1][1]*I);return U.length>=1&&(L[U[U.length-1][0]]=R.subarray(U[U.length-1][1]*I)),{R:k,cells:L}}function _v(e,t){var r,a=Ke(t.data),s=(r=a==null?void 0:a[7])!=null&&r[0]?xr(a[7][0].data)>>>0>0?1:0:-1,n=m0(a[5],function(i){return kv(i,s)});return{nrows:xr(a[4][0].data)>>>0,data:n.reduce(function(i,c){return i[c.R]||(i[c.R]=[]),c.cells.forEach(function(l,f){if(i[c.R][f])throw new Error("Duplicate cell r=".concat(c.R," c=").concat(f));i[c.R][f]=l}),i},[])}}function yv(e,t,r){var a,s=Ke(t.data),n={s:{r:0,c:0},e:{r:0,c:0}};if(n.e.r=(xr(s[6][0].data)>>>0)-1,n.e.r<0)throw new Error("Invalid row varint ".concat(s[6][0].data));if(n.e.c=(xr(s[7][0].data)>>>0)-1,n.e.c<0)throw new Error("Invalid col varint ".concat(s[7][0].data));r["!ref"]=We(n);var i=Ke(s[4][0].data),c=Ci(e,e[Ir(i[4][0].data)][0]),l=(a=i[17])!=null&&a[0]?Ci(e,e[Ir(i[17][0].data)][0]):[],f=Ke(i[3][0].data),d=0;f[1].forEach(function(u){var h=Ke(u.data),m=e[Ir(h[2][0].data)][0],g=xr(m.meta[1][0].data);if(g!=6002)throw new Error("6001 unexpected reference to ".concat(g));var x=_v(e,m);x.data.forEach(function(p,k){p.forEach(function(b,w){var j=Le({r:d+k,c:w}),R=wv(b,c,l);R&&(r[j]=R)})}),d+=x.nrows})}function bv(e,t){var r=Ke(t.data),a={"!ref":"A1"},s=e[Ir(r[2][0].data)],n=xr(s[0].meta[1][0].data);if(n!=6001)throw new Error("6000 unexpected reference to ".concat(n));return yv(e,s[0],a),a}function Ev(e,t){var r,a=Ke(t.data),s={name:(r=a[1])!=null&&r[0]?On(a[1][0].data):"",sheets:[]},n=m0(a[2],Ir);return n.forEach(function(i){e[i].forEach(function(c){var l=xr(c.meta[1][0].data);l==6e3&&s.sheets.push(bv(e,c))})}),s}function Sv(e,t){var r=k0(),a=Ke(t.data),s=m0(a[1],Ir);if(s.forEach(function(n){e[n].forEach(function(i){var c=xr(i.meta[1][0].data);if(c==2){var l=Ev(e,i);l.sheets.forEach(function(f,d){_0(r,f,d==0?l.name:l.name+"_"+d,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function gn(e){var t,r,a,s,n={},i=[];if(e.FullPaths.forEach(function(l){if(l.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(l){if(l.name.match(/\.iwa$/)){var f;try{f=at(l.content)}catch(u){return console.log("?? "+l.content.length+" "+(u.message||u))}var d;try{d=tt(f)}catch(u){return console.log("## "+(u.message||u))}d.forEach(function(u){n[u.id]=u.messages,i.push(u.id)})}}),!i.length)throw new Error("File has no messages");var c=((s=(a=(r=(t=n==null?void 0:n[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:a[1])==null?void 0:s[0].data)&&xr(n[1][0].meta[1][0].data)==1&&n[1][0];if(c||i.forEach(function(l){n[l].forEach(function(f){var d=xr(f.meta[1][0].data)>>>0;if(d==1)if(!c)c=f;else throw new Error("Document has multiple roots")})}),!c)throw new Error("Cannot find Document root");return Sv(n,c)}function Tv(e,t,r){var a,s,n,i;if(!((a=e[6])!=null&&a[0])||!((s=e[7])!=null&&s[0]))throw"Mutation only works on post-BNC storages!";var c=((i=(n=e[8])==null?void 0:n[0])==null?void 0:i.data)&&xr(e[8][0].data)>0||!1;if(c)throw"Math only works with normal offsets";for(var l=0,f=ia(e[7][0].data),d=0,u=[],h=ia(e[4][0].data),m=0,g=[],x=0;x<t.length;++x){if(t[x]==null){f.setUint16(x*2,65535,!0),h.setUint16(x*2,65535);continue}f.setUint16(x*2,d,!0),h.setUint16(x*2,m,!0);var p,k;switch(typeof t[x]){case"string":p=xn({t:"s",v:t[x]},r),k=mn({t:"s",v:t[x]},r);break;case"number":p=xn({t:"n",v:t[x]},r),k=mn({t:"n",v:t[x]},r);break;case"boolean":p=xn({t:"b",v:t[x]},r),k=mn({t:"b",v:t[x]},r);break;default:throw new Error("Unsupported value "+t[x])}u.push(p),d+=p.length,g.push(k),m+=k.length,++l}for(e[2][0].data=Ze(l);x<e[7][0].data.length/2;++x)f.setUint16(x*2,65535,!0),h.setUint16(x*2,65535,!0);return e[6][0].data=Wt(u),e[3][0].data=Wt(g),l}function Nv(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var a=Xr(r["!ref"]);a.s.r=a.s.c=0;var s=!1;a.e.c>9&&(s=!0,a.e.c=9),a.e.r>49&&(s=!0,a.e.r=49),s&&console.error("The Numbers writer is currently limited to ".concat(We(a)));var n=Vs(r,{range:a,header:1}),i=["~Sh33tJ5~"];n.forEach(function(M){return M.forEach(function(D){typeof D=="string"&&i.push(D)})});var c={},l=[],f=Ae.read(t.numbers,{type:"base64"});f.FileIndex.map(function(M,D){return[M,f.FullPaths[D]]}).forEach(function(M){var D=M[0],O=M[1];if(D.type==2&&D.name.match(/\.iwa/)){var W=D.content,ee=at(W),se=tt(ee);se.forEach(function(J){l.push(J.id),c[J.id]={deps:[],location:O,type:xr(J.messages[0].meta[1][0].data)}})}}),l.sort(function(M,D){return M-D});var d=l.filter(function(M){return M>1}).map(function(M){return[M,Ze(M)]});f.FileIndex.map(function(M,D){return[M,f.FullPaths[D]]}).forEach(function(M){var D=M[0];if(M[1],!!D.name.match(/\.iwa/)){var O=tt(at(D.content));O.forEach(function(W){W.messages.forEach(function(ee){d.forEach(function(se){W.messages.some(function(J){return xr(J.meta[1][0].data)!=11006&&uv(J.data,se[1])})&&c[se[0]].deps.push(W.id)})})})}});for(var u=Ae.find(f,c[1].location),h=tt(at(u.content)),m,g=0;g<h.length;++g){var x=h[g];x.id==1&&(m=x)}var p=Ir(Ke(m.messages[0].data)[1][0].data);for(u=Ae.find(f,c[p].location),h=tt(at(u.content)),g=0;g<h.length;++g)x=h[g],x.id==p&&(m=x);for(p=Ir(Ke(m.messages[0].data)[2][0].data),u=Ae.find(f,c[p].location),h=tt(at(u.content)),g=0;g<h.length;++g)x=h[g],x.id==p&&(m=x);for(p=Ir(Ke(m.messages[0].data)[2][0].data),u=Ae.find(f,c[p].location),h=tt(at(u.content)),g=0;g<h.length;++g)x=h[g],x.id==p&&(m=x);var k=Ke(m.messages[0].data);{k[6][0].data=Ze(a.e.r+1),k[7][0].data=Ze(a.e.c+1);var b=Ir(k[46][0].data),w=Ae.find(f,c[b].location),j=tt(at(w.content));{for(var R=0;R<j.length&&j[R].id!=b;++R);if(j[R].id!=b)throw"Bad ColumnRowUIDMapArchive";var I=Ke(j[R].messages[0].data);I[1]=[],I[2]=[],I[3]=[];for(var E=0;E<=a.e.c;++E){var U=[];U[1]=U[2]=[{type:0,data:Ze(E+420690)}],I[1].push({type:2,data:Fr(U)}),I[2].push({type:0,data:Ze(E)}),I[3].push({type:0,data:Ze(E)})}I[4]=[],I[5]=[],I[6]=[];for(var N=0;N<=a.e.r;++N)U=[],U[1]=U[2]=[{type:0,data:Ze(N+726270)}],I[4].push({type:2,data:Fr(U)}),I[5].push({type:0,data:Ze(N)}),I[6].push({type:0,data:Ze(N)});j[R].messages[0].data=Fr(I)}w.content=ga(ma(j)),w.size=w.content.length,delete k[46];var B=Ke(k[4][0].data);{B[7][0].data=Ze(a.e.r+1);var L=Ke(B[1][0].data),P=Ir(L[2][0].data);w=Ae.find(f,c[P].location),j=tt(at(w.content));{if(j[0].id!=P)throw"Bad HeaderStorageBucket";var Q=Ke(j[0].messages[0].data);for(N=0;N<n.length;++N){var fe=Ke(Q[2][0].data);fe[1][0].data=Ze(N),fe[4][0].data=Ze(n[N].length),Q[2][N]={type:Q[2][0].type,data:Fr(fe)}}j[0].messages[0].data=Fr(Q)}w.content=ga(ma(j)),w.size=w.content.length;var ie=Ir(B[2][0].data);w=Ae.find(f,c[ie].location),j=tt(at(w.content));{if(j[0].id!=ie)throw"Bad HeaderStorageBucket";for(Q=Ke(j[0].messages[0].data),E=0;E<=a.e.c;++E)fe=Ke(Q[2][0].data),fe[1][0].data=Ze(E),fe[4][0].data=Ze(a.e.r+1),Q[2][E]={type:Q[2][0].type,data:Fr(fe)};j[0].messages[0].data=Fr(Q)}w.content=ga(ma(j)),w.size=w.content.length;var pe=Ir(B[4][0].data);(function(){for(var M=Ae.find(f,c[pe].location),D=tt(at(M.content)),O,W=0;W<D.length;++W){var ee=D[W];ee.id==pe&&(O=ee)}var se=Ke(O.messages[0].data);{se[3]=[];var J=[];i.forEach(function(S,je){J[1]=[{type:0,data:Ze(je)}],J[2]=[{type:0,data:Ze(1)}],J[3]=[{type:2,data:hv(S)}],se[3].push({type:2,data:Fr(J)})})}O.messages[0].data=Fr(se);var q=ma(D),ke=ga(q);M.content=ke,M.size=M.content.length})();var he=Ke(B[3][0].data);{var Ve=he[1][0];delete he[2];var H=Ke(Ve.data);{var we=Ir(H[2][0].data);(function(){for(var M=Ae.find(f,c[we].location),D=tt(at(M.content)),O,W=0;W<D.length;++W){var ee=D[W];ee.id==we&&(O=ee)}var se=Ke(O.messages[0].data);{delete se[6],delete he[7];var J=new Uint8Array(se[5][0].data);se[5]=[];for(var q=0,ke=0;ke<=a.e.r;++ke){var S=Ke(J);q+=Tv(S,n[ke],i),S[1][0].data=Ze(ke),se[5].push({data:Fr(S),type:2})}se[1]=[{type:0,data:Ze(a.e.c+1)}],se[2]=[{type:0,data:Ze(a.e.r+1)}],se[3]=[{type:0,data:Ze(q)}],se[4]=[{type:0,data:Ze(a.e.r+1)}]}O.messages[0].data=Fr(se);var je=ma(D),Ce=ga(je);M.content=Ce,M.size=M.content.length})()}Ve.data=Fr(H)}B[3][0].data=Fr(he)}k[4][0].data=Fr(B)}m.messages[0].data=Fr(k);var Ee=ma(h),A=ga(Ee);return u.content=A,u.size=u.content.length,f}function Wo(e){return function(r){for(var a=0;a!=e.length;++a){var s=e[a];r[s[0]]===void 0&&(r[s[0]]=s[1]),s[2]==="n"&&(r[s[0]]=Number(r[s[0]]))}}}function g0(e){Wo([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function p0(e){Wo([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function Fv(e){return ze.WS.indexOf(e)>-1?"sheet":e==ze.CS?"chart":e==ze.DS?"dialog":e==ze.MS?"macro":e&&e.length?e:"sheet"}function Cv(e,t){if(!e)return 0;try{e=t.map(function(a){return a.id||(a.id=a.strRelID),[a.name,e["!id"][a.id].Target,Fv(e["!id"][a.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function Av(e,t,r,a,s,n,i,c,l,f,d,u){try{n[a]=Wa(Zr(e,r,!0),t);var h=kr(e,t),m;switch(c){case"sheet":m=Zp(h,t,s,l,n[a],f,d,u);break;case"chart":if(m=Qp(h,t,s,l,n[a],f,d,u),!m||!m["!drawel"])break;var g=Ma(m["!drawel"].Target,t),x=Za(g),p=Bx(Zr(e,g,!0),Wa(Zr(e,x,!0),g)),k=Ma(p,g),b=Za(k);m=Tp(Zr(e,k,!0),k,l,Wa(Zr(e,b,!0),k),f,m);break;case"macro":m=e2(h,t,s,l,n[a],f,d,u);break;case"dialog":m=r2(h,t,s,l,n[a],f,d,u);break;default:throw new Error("Unrecognized sheet type "+c)}i[a]=m;var w=[];n&&n[a]&&mr(n[a]).forEach(function(j){var R="";if(n[a][j].Type==ze.CMNT){R=Ma(n[a][j].Target,t);var I=n2(kr(e,R,!0),R,l);if(!I||!I.length)return;xi(m,I,!1)}n[a][j].Type==ze.TCMNT&&(R=Ma(n[a][j].Target,t),w=w.concat(Wx(kr(e,R,!0),l)))}),w&&w.length&&xi(m,w,!0,l.people||[])}catch(j){if(l.WTF)throw j}}function et(e){return e.charAt(0)=="/"?e.slice(1):e}function jv(e,t){if(Fa(),t=t||{},g0(t),st(e,"META-INF/manifest.xml")||st(e,"objectdata.xml"))return Si(e,t);if(st(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof gn<"u"){if(e.FileIndex)return gn(e);var r=Ae.utils.cfb_new();return L0(e).forEach(function(fe){He(r,fe,Wl(e,fe))}),gn(r)}throw new Error("Unsupported NUMBERS file")}if(!st(e,"[Content_Types].xml"))throw st(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):st(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var a=L0(e),s=Lf(Zr(e,"[Content_Types].xml")),n=!1,i,c;if(s.workbooks.length===0&&(c="xl/workbook.xml",kr(e,c,!0)&&s.workbooks.push(c)),s.workbooks.length===0){if(c="xl/workbook.bin",!kr(e,c,!0))throw new Error("Could not find workbook");s.workbooks.push(c),n=!0}s.workbooks[0].slice(-3)=="bin"&&(n=!0);var l={},f={};if(!t.bookSheets&&!t.bookProps){if(Ha=[],s.sst)try{Ha=s2(kr(e,et(s.sst)),s.sst,t)}catch(fe){if(t.WTF)throw fe}t.cellStyles&&s.themes.length&&(l=a2(Zr(e,s.themes[0].replace(/^\//,""),!0)||"",s.themes[0],t)),s.style&&(f=t2(kr(e,et(s.style)),s.style,l,t))}s.links.map(function(fe){try{var ie=Wa(Zr(e,Za(et(fe))),fe);return c2(kr(e,et(fe)),ie,fe,t)}catch{}});var d=qp(kr(e,et(s.workbooks[0])),s.workbooks[0],t),u={},h="";s.coreprops.length&&(h=kr(e,et(s.coreprops[0]),!0),h&&(u=Fc(h)),s.extprops.length!==0&&(h=kr(e,et(s.extprops[0]),!0),h&&Hf(h,u,t)));var m={};(!t.bookSheets||t.bookProps)&&s.custprops.length!==0&&(h=Zr(e,et(s.custprops[0]),!0),h&&(m=$f(h,t)));var g={};if((t.bookSheets||t.bookProps)&&(d.Sheets?i=d.Sheets.map(function(ie){return ie.name}):u.Worksheets&&u.SheetNames.length>0&&(i=u.SheetNames),t.bookProps&&(g.Props=u,g.Custprops=m),t.bookSheets&&typeof i<"u"&&(g.SheetNames=i),t.bookSheets?g.SheetNames:t.bookProps))return g;i={};var x={};t.bookDeps&&s.calcchain&&(x=i2(kr(e,et(s.calcchain)),s.calcchain));var p=0,k={},b,w;{var j=d.Sheets;u.Worksheets=j.length,u.SheetNames=[];for(var R=0;R!=j.length;++R)u.SheetNames[R]=j[R].name}var I=n?"bin":"xml",E=s.workbooks[0].lastIndexOf("/"),U=(s.workbooks[0].slice(0,E+1)+"_rels/"+s.workbooks[0].slice(E+1)+".rels").replace(/^\//,"");st(e,U)||(U="xl/_rels/workbook."+I+".rels");var N=Wa(Zr(e,U,!0),U.replace(/_rels.*/,"s5s"));(s.metadata||[]).length>=1&&(t.xlmeta=o2(kr(e,et(s.metadata[0])),s.metadata[0],t)),(s.people||[]).length>=1&&(t.people=Vx(kr(e,et(s.people[0])),t)),N&&(N=Cv(N,d.Sheets));var B=kr(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(p=0;p!=u.Worksheets;++p){var L="sheet";if(N&&N[p]?(b="xl/"+N[p][1].replace(/[\/]?xl\//,""),st(e,b)||(b=N[p][1]),st(e,b)||(b=U.replace(/_rels\/.*$/,"")+N[p][1]),L=N[p][2]):(b="xl/worksheets/sheet"+(p+1-B)+"."+I,b=b.replace(/sheet0\./,"sheet.")),w=b.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(p!=t.sheets)continue e;break;case"string":if(u.SheetNames[p].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var P=!1,Q=0;Q!=t.sheets.length;++Q)typeof t.sheets[Q]=="number"&&t.sheets[Q]==p&&(P=1),typeof t.sheets[Q]=="string"&&t.sheets[Q].toLowerCase()==u.SheetNames[p].toLowerCase()&&(P=1);if(!P)continue e}}Av(e,b,w,u.SheetNames[p],p,k,i,L,t,d,l,f)}return g={Directory:s,Workbook:d,Props:u,Custprops:m,Deps:x,Sheets:i,SheetNames:u.SheetNames,Strings:Ha,Styles:f,Themes:l,SSF:ir(Ie)},t&&t.bookFiles&&(e.files?(g.keys=a,g.files=e.files):(g.keys=[],g.files={},e.FullPaths.forEach(function(fe,ie){fe=fe.replace(/^Root Entry[\/]/,""),g.keys.push(fe),g.files[fe]=e.FileIndex[ie]}))),t&&t.bookVBA&&(s.vba.length>0?g.vbaraw=kr(e,et(s.vba[0]),!0):s.defaults&&s.defaults.bin===qx&&(g.vbaraw=kr(e,"xl/vbaProject.bin",!0))),g}function Dv(e,t){var r=t||{},a="Workbook",s=Ae.find(e,a);try{if(a="/!DataSpaces/Version",s=Ae.find(e,a),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+a);if(ou(s.content),a="/!DataSpaces/DataSpaceMap",s=Ae.find(e,a),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+a);var n=fu(s.content);if(n.length!==1||n[0].comps.length!==1||n[0].comps[0].t!==0||n[0].name!=="StrongEncryptionDataSpace"||n[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+a);if(a="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",s=Ae.find(e,a),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+a);var i=du(s.content);if(i.length!=1||i[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+a);if(a="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",s=Ae.find(e,a),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+a);uu(s.content)}catch{}if(a="/EncryptionInfo",s=Ae.find(e,a),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+a);var c=xu(s.content);if(a="/EncryptedPackage",s=Ae.find(e,a),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+a);if(c[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(c[1],s.content,r.password||"",r);if(c[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(c[1],s.content,r.password||"",r);throw new Error("File is password-protected")}function Iv(e,t){return t.bookType=="ods"?Uo(e,t):t.bookType=="numbers"?Nv(e,t):t.bookType=="xlsb"?Ov(e,t):Lv(e,t)}function Ov(e,t){va=1024,e&&!e.SSF&&(e.SSF=ir(Ie)),e&&e.SSF&&(Fa(),zs(e.SSF),t.revssf=Xs(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Va?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",a=xo.indexOf(t.bookType)>-1,s=t0();p0(t=t||{});var n=Hn(),i="",c=0;if(t.cellXfs=[],$t(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),i="docProps/core.xml",He(n,i,Cc(e.Props,t)),s.coreprops.push(i),Qe(t.rels,2,i,ze.CORE_PROPS),i="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var l=[],f=0;f<e.SheetNames.length;++f)(e.Workbook.Sheets[f]||{}).Hidden!=2&&l.push(e.SheetNames[f]);e.Props.SheetNames=l}for(e.Props.Worksheets=e.Props.SheetNames.length,He(n,i,Dc(e.Props)),s.extprops.push(i),Qe(t.rels,3,i,ze.EXT_PROPS),e.Custprops!==e.Props&&mr(e.Custprops||{}).length>0&&(i="docProps/custom.xml",He(n,i,Ic(e.Custprops)),s.custprops.push(i),Qe(t.rels,4,i,ze.CUST_PROPS)),c=1;c<=e.SheetNames.length;++c){var d={"!id":{}},u=e.Sheets[e.SheetNames[c-1]],h=(u||{})["!type"]||"sheet";switch(h){case"chart":default:i="xl/worksheets/sheet"+c+"."+r,He(n,i,f2(c-1,i,t,e,d)),s.sheets.push(i),Qe(t.wbrels,-1,"worksheets/sheet"+c+"."+r,ze.WS[0])}if(u){var m=u["!comments"],g=!1,x="";m&&m.length>0&&(x="xl/comments"+c+"."+r,He(n,x,u2(m,x)),s.comments.push(x),Qe(d,-1,"../comments"+c+"."+r,ze.CMNT),g=!0),u["!legacy"]&&g&&He(n,"xl/drawings/vmlDrawing"+c+".vml",ho(c,u["!comments"])),delete u["!comments"],delete u["!legacy"]}d["!id"].rId1&&He(n,Za(i),ka(d))}return t.Strings!=null&&t.Strings.length>0&&(i="xl/sharedStrings."+r,He(n,i,h2(t.Strings,i,t)),s.strs.push(i),Qe(t.wbrels,-1,"sharedStrings."+r,ze.SST)),i="xl/workbook."+r,He(n,i,l2(e,i)),s.workbooks.push(i),Qe(t.rels,1,i,ze.WB),i="xl/theme/theme1.xml",He(n,i,o0(e.Themes,t)),s.themes.push(i),Qe(t.wbrels,-1,"theme/theme1.xml",ze.THEME),i="xl/styles."+r,He(n,i,d2(e,i,t)),s.styles.push(i),Qe(t.wbrels,-1,"styles."+r,ze.STY),e.vbaraw&&a&&(i="xl/vbaProject.bin",He(n,i,e.vbaraw),s.vba.push(i),Qe(t.wbrels,-1,"vbaProject.bin",ze.VBA)),i="xl/metadata."+r,He(n,i,x2(i)),s.metadata.push(i),Qe(t.wbrels,-1,"metadata."+r,ze.XLMETA),He(n,"[Content_Types].xml",Tc(s,t)),He(n,"_rels/.rels",ka(t.rels)),He(n,"xl/_rels/workbook."+r+".rels",ka(t.wbrels)),delete t.revssf,delete t.ssf,n}function Lv(e,t){va=1024,e&&!e.SSF&&(e.SSF=ir(Ie)),e&&e.SSF&&(Fa(),zs(e.SSF),t.revssf=Xs(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Va?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",a=xo.indexOf(t.bookType)>-1,s=t0();p0(t=t||{});var n=Hn(),i="",c=0;if(t.cellXfs=[],$t(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),i="docProps/core.xml",He(n,i,Cc(e.Props,t)),s.coreprops.push(i),Qe(t.rels,2,i,ze.CORE_PROPS),i="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var l=[],f=0;f<e.SheetNames.length;++f)(e.Workbook.Sheets[f]||{}).Hidden!=2&&l.push(e.SheetNames[f]);e.Props.SheetNames=l}e.Props.Worksheets=e.Props.SheetNames.length,He(n,i,Dc(e.Props)),s.extprops.push(i),Qe(t.rels,3,i,ze.EXT_PROPS),e.Custprops!==e.Props&&mr(e.Custprops||{}).length>0&&(i="docProps/custom.xml",He(n,i,Ic(e.Custprops)),s.custprops.push(i),Qe(t.rels,4,i,ze.CUST_PROPS));var d=["SheetJ5"];for(t.tcid=0,c=1;c<=e.SheetNames.length;++c){var u={"!id":{}},h=e.Sheets[e.SheetNames[c-1]],m=(h||{})["!type"]||"sheet";switch(m){case"chart":default:i="xl/worksheets/sheet"+c+"."+r,He(n,i,So(c-1,t,e,u)),s.sheets.push(i),Qe(t.wbrels,-1,"worksheets/sheet"+c+"."+r,ze.WS[0])}if(h){var g=h["!comments"],x=!1,p="";if(g&&g.length>0){var k=!1;g.forEach(function(b){b[1].forEach(function(w){w.T==!0&&(k=!0)})}),k&&(p="xl/threadedComments/threadedComment"+c+"."+r,He(n,p,Hx(g,d,t)),s.threadedcomments.push(p),Qe(u,-1,"../threadedComments/threadedComment"+c+"."+r,ze.TCMNT)),p="xl/comments"+c+"."+r,He(n,p,uo(g)),s.comments.push(p),Qe(u,-1,"../comments"+c+"."+r,ze.CMNT),x=!0}h["!legacy"]&&x&&He(n,"xl/drawings/vmlDrawing"+c+".vml",ho(c,h["!comments"])),delete h["!comments"],delete h["!legacy"]}u["!id"].rId1&&He(n,Za(i),ka(u))}return t.Strings!=null&&t.Strings.length>0&&(i="xl/sharedStrings."+r,He(n,i,Qc(t.Strings,t)),s.strs.push(i),Qe(t.wbrels,-1,"sharedStrings."+r,ze.SST)),i="xl/workbook."+r,He(n,i,Ao(e)),s.workbooks.push(i),Qe(t.rels,1,i,ze.WB),i="xl/theme/theme1.xml",He(n,i,o0(e.Themes,t)),s.themes.push(i),Qe(t.wbrels,-1,"theme/theme1.xml",ze.THEME),i="xl/styles."+r,He(n,i,co(e,t)),s.styles.push(i),Qe(t.wbrels,-1,"styles."+r,ze.STY),e.vbaraw&&a&&(i="xl/vbaProject.bin",He(n,i,e.vbaraw),s.vba.push(i),Qe(t.wbrels,-1,"vbaProject.bin",ze.VBA)),i="xl/metadata."+r,He(n,i,fo()),s.metadata.push(i),Qe(t.wbrels,-1,"metadata."+r,ze.XLMETA),d.length>1&&(i="xl/persons/person.xml",He(n,i,$x(d)),s.people.push(i),Qe(t.wbrels,-1,"persons/person.xml",ze.PEOPLE)),He(n,"[Content_Types].xml",Tc(s,t)),He(n,"_rels/.rels",ka(t.rels)),He(n,"xl/_rels/workbook."+r+".rels",ka(t.wbrels)),delete t.revssf,delete t.ssf,n}function v0(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=Qr(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function Rv(e,t){return Ae.find(e,"EncryptedPackage")?Dv(e,t):Oo(e,t)}function Mv(e,t){var r,a=e,s=t||{};return s.type||(s.type=$e&&Buffer.isBuffer(e)?"buffer":"base64"),r=rc(a,s),jv(r,s)}function Ho(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return Dn(e.slice(r),t);default:break e}return Ea.to_workbook(e,t)}function Pv(e,t){var r="",a=v0(e,t);switch(t.type){case"base64":r=Qr(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=ta(e);break;default:throw new Error("Unrecognized type "+t.type)}return a[0]==239&&a[1]==187&&a[2]==191&&(r=rr(r)),t.type="binary",Ho(r,t)}function Bv(e,t){var r=e;return t.type=="base64"&&(r=Qr(r)),r=Ga.utils.decode(1200,r.slice(2),"str"),t.type="binary",Ho(r,t)}function Uv(e){return e.match(/[^\x00-\x7F]/)?_t(e):e}function pn(e,t,r,a){return a?(r.type="string",Ea.to_workbook(e,r)):Ea.to_workbook(t,r)}function ns(e,t){Mn();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return ns(new Uint8Array(e),(r=ir(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var a=e,s=[0,0,0,0],n=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),ya={},r.dateNF&&(ya.dateNF=r.dateNF),r.type||(r.type=$e&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=$e?"buffer":"binary",a=Il(e),typeof Uint8Array<"u"&&!$e&&(r.type="array")),r.type=="string"&&(n=!0,r.type="binary",r.codepage=65001,a=Uv(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var i=new ArrayBuffer(3),c=new Uint8Array(i);if(c.foo="bar",!c.foo)return r=ir(r),r.type="array",ns(Pn(a),r)}switch((s=v0(a,r))[0]){case 208:if(s[1]===207&&s[2]===17&&s[3]===224&&s[4]===161&&s[5]===177&&s[6]===26&&s[7]===225)return Rv(Ae.read(a,r),r);break;case 9:if(s[1]<=8)return Oo(a,r);break;case 60:return Dn(a,r);case 73:if(s[1]===73&&s[2]===42&&s[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(s[1]===68)return zh(a,r);break;case 84:if(s[1]===65&&s[2]===66&&s[3]===76)return qc.to_workbook(a,r);break;case 80:return s[1]===75&&s[2]<9&&s[3]<9?Mv(a,r):pn(e,a,r,n);case 239:return s[3]===60?Dn(a,r):pn(e,a,r,n);case 255:if(s[1]===254)return Bv(a,r);if(s[1]===0&&s[2]===2&&s[3]===0)return Qt.to_workbook(a,r);break;case 0:if(s[1]===0&&(s[2]>=2&&s[3]===0||s[2]===0&&(s[3]===8||s[3]===9)))return Qt.to_workbook(a,r);break;case 3:case 131:case 139:case 140:return jn.to_workbook(a,r);case 123:if(s[1]===92&&s[2]===114&&s[3]===116)return so.to_workbook(a,r);break;case 10:case 13:case 32:return Pv(a,r);case 137:if(s[1]===80&&s[2]===78&&s[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return $h.indexOf(s[0])>-1&&s[2]<=12&&s[3]<=31?jn.to_workbook(a,r):pn(e,a,r,n)}function Vo(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return ls(t.file,Ae.write(e,{type:$e?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return Ae.write(e,t)}function Wv(e,t){var r=ir(t||{}),a=Iv(e,r);return Hv(a,r)}function Hv(e,t){var r={},a=$e?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=a;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=a;break;default:throw new Error("Unrecognized type "+t.type)}var s=e.FullPaths?Ae.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof s=="string"){if(t.type=="binary"||t.type=="base64")return s;s=new Uint8Array($s(s))}return t.password&&typeof encrypt_agile<"u"?Vo(encrypt_agile(s,t.password),t):t.type==="file"?ls(t.file,s):t.type=="string"?rr(s):s}function Vv(e,t){var r=t||{},a=U2(e,r);return Vo(a,r)}function kt(e,t,r){r||(r="");var a=r+e;switch(t.type){case"base64":return Xa(_t(a));case"binary":return _t(a);case"string":return e;case"file":return ls(t.file,a,"utf8");case"buffer":return $e?jt(a,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(a):kt(a,{type:"binary"}).split("").map(function(s){return s.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function $v(e,t){switch(t.type){case"base64":return Xa(e);case"binary":return e;case"string":return e;case"file":return ls(t.file,e,"binary");case"buffer":return $e?jt(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function Ns(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",a=0;a<e.length;++a)r+=String.fromCharCode(e[a]);return t.type=="base64"?Xa(r):t.type=="string"?rr(r):r;case"file":return ls(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function $o(e,t){Mn(),Rp(e);var r=ir(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var a=$o(e,r);return r.type="array",$s(a)}var s=0;if(r.sheet&&(typeof r.sheet=="number"?s=r.sheet:s=e.SheetNames.indexOf(r.sheet),!e.SheetNames[s]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return kt(I2(e,r),r);case"slk":case"sylk":return kt(Jc.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"htm":case"html":return kt(Ro(e.Sheets[e.SheetNames[s]],r),r);case"txt":return $v(zo(e.Sheets[e.SheetNames[s]],r),r);case"csv":return kt(w0(e.Sheets[e.SheetNames[s]],r),r,"\uFEFF");case"dif":return kt(qc.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"dbf":return Ns(jn.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"prn":return kt(Ea.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"rtf":return kt(so.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"eth":return kt(Zc.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"fods":return kt(Uo(e,r),r);case"wk1":return Ns(Qt.sheet_to_wk1(e.Sheets[e.SheetNames[s]],r),r);case"wk3":return Ns(Qt.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),Ns(Lo(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),Vv(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return Wv(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function zv(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function Mt(e,t,r){var a={};return a.type="file",a.file=t,zv(a),$o(e,a)}function Gv(e,t,r,a,s,n,i,c){var l=pr(r),f=c.defval,d=c.raw||!Object.prototype.hasOwnProperty.call(c,"raw"),u=!0,h=s===1?[]:{};if(s!==1)if(Object.defineProperty)try{Object.defineProperty(h,"__rowNum__",{value:r,enumerable:!1})}catch{h.__rowNum__=r}else h.__rowNum__=r;if(!i||e[r])for(var m=t.s.c;m<=t.e.c;++m){var g=i?e[r][m]:e[a[m]+l];if(g===void 0||g.t===void 0){if(f===void 0)continue;n[m]!=null&&(h[n[m]]=f);continue}var x=g.v;switch(g.t){case"z":if(x==null)break;continue;case"e":x=x==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+g.t)}if(n[m]!=null){if(x==null)if(g.t=="e"&&x===null)h[n[m]]=null;else if(f!==void 0)h[n[m]]=f;else if(d&&x===null)h[n[m]]=null;else continue;else h[n[m]]=d&&(g.t!=="n"||g.t==="n"&&c.rawNumbers!==!1)?x:At(g,x,c);x!=null&&(u=!1)}}return{row:h,isempty:u}}function Vs(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},a=0,s=1,n=[],i=0,c="",l={s:{r:0,c:0},e:{r:0,c:0}},f=t||{},d=f.range!=null?f.range:e["!ref"];switch(f.header===1?a=1:f.header==="A"?a=2:Array.isArray(f.header)?a=3:f.header==null&&(a=0),typeof d){case"string":l=Xe(d);break;case"number":l=Xe(e["!ref"]),l.s.r=d;break;default:l=d}a>0&&(s=0);var u=pr(l.s.r),h=[],m=[],g=0,x=0,p=Array.isArray(e),k=l.s.r,b=0,w={};p&&!e[k]&&(e[k]=[]);var j=f.skipHidden&&e["!cols"]||[],R=f.skipHidden&&e["!rows"]||[];for(b=l.s.c;b<=l.e.c;++b)if(!(j[b]||{}).hidden)switch(h[b]=fr(b),r=p?e[k][b]:e[h[b]+u],a){case 1:n[b]=b-l.s.c;break;case 2:n[b]=h[b];break;case 3:n[b]=f.header[b-l.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),c=i=At(r,null,f),x=w[i]||0,!x)w[i]=1;else{do c=i+"_"+x++;while(w[c]);w[i]=x,w[c]=1}n[b]=c}for(k=l.s.r+s;k<=l.e.r;++k)if(!(R[k]||{}).hidden){var I=Gv(e,l,k,h,a,n,p,f);(I.isempty===!1||(a===1?f.blankrows!==!1:f.blankrows))&&(m[g++]=I.row)}return m.length=g,m}var Ai=/"/g;function Xv(e,t,r,a,s,n,i,c){for(var l=!0,f=[],d="",u=pr(r),h=t.s.c;h<=t.e.c;++h)if(a[h]){var m=c.dense?(e[r]||[])[h]:e[a[h]+u];if(m==null)d="";else if(m.v!=null){l=!1,d=""+(c.rawNumbers&&m.t=="n"?m.v:At(m,null,c));for(var g=0,x=0;g!==d.length;++g)if((x=d.charCodeAt(g))===s||x===n||x===34||c.forceQuotes){d='"'+d.replace(Ai,'""')+'"';break}d=="ID"&&(d='"ID"')}else m.f!=null&&!m.F?(l=!1,d="="+m.f,d.indexOf(",")>=0&&(d='"'+d.replace(Ai,'""')+'"')):d="";f.push(d)}return c.blankrows===!1&&l?null:f.join(i)}function w0(e,t){var r=[],a=t??{};if(e==null||e["!ref"]==null)return"";var s=Xe(e["!ref"]),n=a.FS!==void 0?a.FS:",",i=n.charCodeAt(0),c=a.RS!==void 0?a.RS:`
`,l=c.charCodeAt(0),f=new RegExp((n=="|"?"\\|":n)+"+$"),d="",u=[];a.dense=Array.isArray(e);for(var h=a.skipHidden&&e["!cols"]||[],m=a.skipHidden&&e["!rows"]||[],g=s.s.c;g<=s.e.c;++g)(h[g]||{}).hidden||(u[g]=fr(g));for(var x=0,p=s.s.r;p<=s.e.r;++p)(m[p]||{}).hidden||(d=Xv(e,s,p,u,i,l,n,a),d!=null&&(a.strip&&(d=d.replace(f,"")),(d||a.blankrows!==!1)&&r.push((x++?c:"")+d)));return delete a.dense,r.join("")}function zo(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=w0(e,t);return r}function Kv(e){var t="",r,a="";if(e==null||e["!ref"]==null)return[];var s=Xe(e["!ref"]),n="",i=[],c,l=[],f=Array.isArray(e);for(c=s.s.c;c<=s.e.c;++c)i[c]=fr(c);for(var d=s.s.r;d<=s.e.r;++d)for(n=pr(d),c=s.s.c;c<=s.e.c;++c)if(t=i[c]+n,r=f?(e[d]||[])[c]:e[t],a="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;a=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)a=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)a=""+r.v;else if(r.t=="b")a=r.v?"TRUE":"FALSE";else if(r.w!==void 0)a="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?a="'"+r.v:a=""+r.v}}l[l.length]=t+"="+a}return l}function Go(e,t,r){var a=r||{},s=+!a.skipHeader,n=e||{},i=0,c=0;if(n&&a.origin!=null)if(typeof a.origin=="number")i=a.origin;else{var l=typeof a.origin=="string"?dr(a.origin):a.origin;i=l.r,c=l.c}var f,d={s:{c:0,r:0},e:{c,r:i+t.length-1+s}};if(n["!ref"]){var u=Xe(n["!ref"]);d.e.c=Math.max(d.e.c,u.e.c),d.e.r=Math.max(d.e.r,u.e.r),i==-1&&(i=u.e.r+1,d.e.r=i+t.length-1+s)}else i==-1&&(i=0,d.e.r=t.length-1+s);var h=a.header||[],m=0;t.forEach(function(x,p){mr(x).forEach(function(k){(m=h.indexOf(k))==-1&&(h[m=h.length]=k);var b=x[k],w="z",j="",R=Le({c:c+m,r:i+p+s});f=is(n,R),b&&typeof b=="object"&&!(b instanceof Date)?n[R]=b:(typeof b=="number"?w="n":typeof b=="boolean"?w="b":typeof b=="string"?w="s":b instanceof Date?(w="d",a.cellDates||(w="n",b=br(b)),j=a.dateNF||Ie[14]):b===null&&a.nullError&&(w="e",b=0),f?(f.t=w,f.v=b,delete f.w,delete f.R,j&&(f.z=j)):n[R]=f={t:w,v:b},j&&(f.z=j))})}),d.e.c=Math.max(d.e.c,c+h.length-1);var g=pr(i);if(s)for(m=0;m<h.length;++m)n[fr(m+c)+g]={t:"s",v:h[m]};return n["!ref"]=We(d),n}function Yv(e,t){return Go(null,e,t)}function is(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var a=dr(t);return e[a.r]||(e[a.r]=[]),e[a.r][a.c]||(e[a.r][a.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?is(e,Le(t)):is(e,Le({r:t,c:r||0}))}function Jv(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function k0(){return{SheetNames:[],Sheets:{}}}function _0(e,t,r,a){var s=1;if(!r)for(;s<=65535&&e.SheetNames.indexOf(r="Sheet"+s)!=-1;++s,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(a&&e.SheetNames.indexOf(r)>=0){var n=r.match(/(^.*?)(\d+)$/);s=n&&+n[2]||0;var i=n&&n[1]||r;for(++s;s<=65535&&e.SheetNames.indexOf(r=i+s)!=-1;++s);}if(Co(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function qv(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var a=Jv(e,t);switch(e.Workbook.Sheets[a]||(e.Workbook.Sheets[a]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[a].Hidden=r}function Zv(e,t){return e.z=t,e}function Xo(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function Qv(e,t,r){return Xo(e,"#"+t,r)}function ew(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function rw(e,t,r,a){for(var s=typeof t!="string"?t:Xe(t),n=typeof t=="string"?t:We(t),i=s.s.r;i<=s.e.r;++i)for(var c=s.s.c;c<=s.e.c;++c){var l=is(e,i,c);l.t="n",l.F=n,delete l.v,i==s.s.r&&c==s.s.c&&(l.f=r,a&&(l.D=!0))}return e}var ar={encode_col:fr,encode_row:pr,encode_cell:Le,encode_range:We,decode_col:Jn,decode_row:Yn,split_cell:hf,decode_cell:dr,decode_range:Xr,format_cell:At,sheet_add_aoa:wc,sheet_add_json:Go,sheet_add_dom:Mo,aoa_to_sheet:Ca,json_to_sheet:Yv,table_to_sheet:Po,table_to_book:ov,sheet_to_csv:w0,sheet_to_txt:zo,sheet_to_json:Vs,sheet_to_html:Ro,sheet_to_formulae:Kv,sheet_to_row_object_array:Vs,sheet_get_cell:is,book_new:k0,book_append_sheet:_0,book_set_sheet_visibility:qv,cell_set_number_format:Zv,cell_set_hyperlink:Xo,cell_set_internal_link:Qv,cell_add_comment:ew,sheet_set_array_formula:rw,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const tw=()=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 transform -rotate-45",viewBox:"0 0 24 24",fill:"currentColor",children:o.jsx("path",{d:"M2.01 21L23 12 2.01 3 2 10l15 2-15 2z"})}),ji=()=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),aw=()=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),sw=({students:e})=>{const{ai:t,apiKeyError:r}=G.useMemo(()=>({ai:null,apiKeyError:"عفواً، خدمة الذكاء الاصطناعي غير متاحة حالياً بسبب مشكلة في الإعدادات. يرجى التواصل مع مسؤول الخدمة."}),[]),[a,s]=G.useState([{sender:"ai",text:'أهلاً بك! أنا مساعدك الذكي لتحليل بيانات الخدام. كيف يمكنني مساعدتك اليوم؟ يمكنك أن تسألني مثلاً: "ما هو متوسط الحضور في خدمة ابتدائي؟"'}]),[n,i]=G.useState(""),[c,l]=G.useState(!1),f=G.useRef(null);G.useEffect(()=>{var h;(h=f.current)==null||h.scrollIntoView({behavior:"smooth"})},[a,c]);const d=async h=>{if(h.preventDefault(),!n.trim()||c)return;const m={sender:"user",text:n};if(s(g=>[...g,m]),i(""),l(!0),r||!t){s(g=>[...g,{sender:"ai",text:r}]),l(!1);return}try{const x=`أنت مساعد ذكاء اصطناعي خبير ومحلل بيانات، متخصص في تحليل بيانات خدام كورس "مجتمع يسوع" في كنيسة القديس بولس بالعبور.
            مهمتك هي الإجابة بدقة وتقديم رؤى تحليلية بناءً على بيانات JSON التي سأزودك بها.

            **الهدف من التحليل:**
            هدفك هو مساعدة أمين الخدمة على فهم أداء الخدام، تحديد نقاط القوة والضعف، واكتشاف الخدام المتميزين أو الذين يحتاجون إلى دعم. قدم إجاباتك في هذا السياق.

            **قواعد صارمة يجب اتباعها:**

            1.  **مصدر البيانات الوحيد:** استخدم فقط بيانات JSON المقدمة في هذا الطلب. لا تخترع أي معلومات أو تستخدم أي معرفة خارجية. إذا كان السؤال لا يمكن الإجابة عليه من البيانات، أجب بوضوح "لا يمكنني الإجابة على هذا السؤال من البيانات المتاحة".

            2.  **فهم بنية البيانات:** البيانات عبارة عن مصفوفة من كائنات JSON. كل كائن يمثل **نتيجة كورس واحد** لخادم، ويحتوي على الحقول التالية: \`code\`, \`name\`, \`mobileNumber\`, \`service\` (قد يحتوي على عدة خدمات مفصولة بـ ' / '), \`courseName\`, \`score\` (قد يكون رقمًا أو "غائب"), \`attendance\` (نسبة مئوية).

            3.  **القاعدة الأهم (الخدام الفريدون مقابل التسجيلات):**
                *   يمكن لنفس الخادم أن يكون مسجلاً في كورسات متعددة. لذلك، قد تجد نفس \`code\` و \`name\` في صفوف متعددة.
                *   عندما يُسأل عن عدد "الخدام" أو "الأشخاص"، **يجب** عليك حساب عدد قيم \`code\` الفريدة في مجموعة البيانات ذات الصلة. هذا لمنع العد المزدوج.
                *   عندما يُسأل عن "التسجيلات" أو "نتائج الكورسات"، يمكنك حساب كل كائن في مجموعة البيانات.
                *   **مثال:** إذا سئلت "كم عدد الخدام في خدمة ابتدائي؟"، يجب عليك أولاً تصفية البيانات للكائنات التي يحتوي حقل \`service\` فيها على "خدمة ابتدائي"، ثم حساب عدد الـ \`code\` الفريدة في تلك القائمة المصفاة.

            4.  **كن استباقياً وقدم رؤى:**
                *   لا تكتفِ بالإجابة المباشرة. قدم رؤى إضافية. مثلاً، إذا سُئلت عن متوسط الدرجات، يمكنك مقارنته بالمتوسط العام أو ذكر أعلى وأقل درجة.
                *   ابحث عن الأنماط. مثلاً، "هل هناك علاقة بين نسبة الحضور العالية والدرجات المرتفعة؟"
                *   عندما تقدم قائمة، قدم ملخصًا بسيطًا في النهاية. مثلاً، "هؤلاء هم الخدام الخمسة الأعلى أداءً، ويلاحظ أن معظمهم من خدمة الشباب."

            5.  **خطوات التفكير:**
                *   **الخطوة 1: تحليل السؤال:** افهم ما إذا كان المستخدم يسأل عن خدام فريدين أم تسجيلات، وعن خدمة معينة أم جميع الخدمات.
                *   **الخطوة 2: تصفية البيانات:** قم بتصفية مصفوفة JSON بناءً على معايير السؤال.
                *   **الخطوة 3: إجراء الحساب:** قم بإجراء العملية الحسابية المطلوبة (عد فريد، متوسط، الخ).
                *   **الخطوة 4: توليد الرؤى:** فكر في معنى الأرقام. هل هي عالية؟ منخفضة؟ ما هي الخطوة التالية المقترحة؟
                *   **الخطوة 5: صياغة الإجابة:** قدم إجابة واضحة وموجزة باللغة العربية، تبدأ بالجواب المباشر ثم تتبعها بالتحليل والرؤى. استخدم تنسيق Markdown (مثل الجداول والقوائم) لتحسين القراءة.

            6.  **الأسلوب:** كن ودودًا ومتعاونًا، وتحدث كخبير تحليل بيانات يقدم تقريرًا لأمين الخدمة.

            البيانات الكاملة للخدام بصيغة JSON هي كالتالي:

${JSON.stringify(e)}

السؤال: ${m.text}`,k={sender:"ai",text:(await t.models.generateContent({model:"gemini-2.5-pro",contents:x})).text};s(b=>[...b,k])}catch(g){console.error("Error with Gemini API:",g);const x="حدث خطأ أثناء التواصل مع المساعد الذكي. يرجى المحاولة مرة أخرى.";s(p=>[...p,{sender:"ai",text:x}])}finally{l(!1)}},u=["من هم الخدام الذين حضروا كل الكورسات المسجلين فيها؟","اعرض لي أعلى 5 خدام من حيث متوسط الدرجات.","ما هي الخدمة التي لديها أعلى متوسط درجات؟","قارن بين متوسط الحضور في كورس مجتمع يسوع وكورس إعداد الخدام.","هل هناك خدام حاصلون على 100% حضور وأقل من 70 درجة؟","من هو الخادم المسجل في أكبر عدد من الكورسات؟"];return o.jsxs("div",{className:"flex flex-col h-[70vh] bg-white dark:bg-slate-800 rounded-xl shadow-sm border border-gray-200/80 dark:border-slate-700",children:[o.jsxs("div",{className:"flex-1 p-4 sm:p-6 overflow-y-auto space-y-6",children:[a.map((h,m)=>o.jsxs("div",{className:`flex items-end gap-3 ${h.sender==="user"?"justify-end":"justify-start"}`,children:[h.sender==="ai"&&o.jsx("div",{className:"w-8 h-8 rounded-full bg-indigo-100 text-indigo-600 flex items-center justify-center flex-shrink-0",children:o.jsx(ji,{})}),o.jsx("div",{className:`px-4 py-3 rounded-2xl max-w-md md:max-w-lg shadow-sm ${h.sender==="user"?"bg-indigo-600 text-white rounded-br-none":"bg-gray-100 dark:bg-slate-700 text-gray-800 dark:text-gray-200 rounded-bl-none"}`,children:o.jsx("p",{className:"text-sm leading-relaxed whitespace-pre-wrap",children:h.text})}),h.sender==="user"&&o.jsx("div",{className:"w-8 h-8 rounded-full bg-gray-200 dark:bg-slate-600 text-gray-600 dark:text-gray-200 flex items-center justify-center flex-shrink-0",children:o.jsx(aw,{})})]},m)),c&&o.jsxs("div",{className:"flex items-end gap-3 justify-start",children:[o.jsx("div",{className:"w-8 h-8 rounded-full bg-indigo-100 text-indigo-600 flex items-center justify-center flex-shrink-0",children:o.jsx(ji,{})}),o.jsx("div",{className:"px-4 py-3 rounded-2xl bg-gray-100 dark:bg-slate-700 text-gray-800 rounded-bl-none shadow-sm",children:o.jsxs("div",{className:"flex items-center justify-center gap-2",children:[o.jsx("span",{className:"h-2 w-2 bg-indigo-400 rounded-full animate-bounce [animation-delay:-0.3s]"}),o.jsx("span",{className:"h-2 w-2 bg-indigo-400 rounded-full animate-bounce [animation-delay:-0.15s]"}),o.jsx("span",{className:"h-2 w-2 bg-indigo-400 rounded-full animate-bounce"})]})})]}),o.jsx("div",{ref:f})]}),!c&&a.length<3&&o.jsxs("div",{className:"px-6 pb-4 flex flex-wrap gap-2",children:[o.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 w-full mb-1",children:"أو جرب أحد هذه الأسئلة:"}),u.map(h=>o.jsx("button",{onClick:()=>i(h),className:"px-3 py-1.5 bg-gray-100 dark:bg-slate-700 text-gray-700 dark:text-gray-200 text-xs font-medium rounded-full hover:bg-gray-200 dark:hover:bg-slate-600 transition-colors",children:h},h))]}),o.jsx("div",{className:"p-4 border-t border-gray-200 dark:border-slate-700 bg-gray-50/70 dark:bg-slate-800/50 rounded-b-xl",children:o.jsxs("form",{onSubmit:d,className:"flex items-center gap-3",children:[o.jsx("input",{type:"text",value:n,onChange:h=>i(h.target.value),placeholder:"اسأل شيئًا عن البيانات...",className:"w-full px-4 py-2 text-gray-700 bg-white dark:bg-slate-700 border border-gray-300 dark:border-slate-600 rounded-full focus:outline-none focus:ring-2 focus:ring-indigo-400 transition dark:text-gray-200",disabled:c}),o.jsx("button",{type:"submit",disabled:c||!n.trim(),className:"p-3 bg-indigo-600 text-white rounded-full hover:bg-indigo-700 disabled:bg-indigo-300 disabled:cursor-not-allowed transition-all transform hover:scale-110 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:o.jsx(tw,{})})]})})]})},nw=()=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),iw=()=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",viewBox:"0 0 24 24",fill:"currentColor",children:o.jsx("path",{d:"M21.16,3.16a.5.5,0,0,0-.57-.16l-18,4A.5.5,0,0,0,2.5,8v8a.5.5,0,0,0,.16.37.5.5,0,0,0,.38.13l18,4a.5.5,0,0,0,.57-.6V3.5A.5.5,0,0,0,21.16,3.16ZM11,12.1,7.26,14.28,3.5,12.5,7.1,10.59Zm8.5,3.31-3.6-1.74,3.6-1.92ZM18,7.91,14.25,10,11,8.1,14.65,6Z"})}),vn=50,cw=({title:e,students:t,onClose:r})=>{const[a,s]=G.useState(1);G.useEffect(()=>(document.body.style.overflow="hidden",()=>{document.body.style.overflow="unset"}),[]);const n=Math.ceil(t.length/vn),i=G.useMemo(()=>{const l=(a-1)*vn;return t.slice(l,l+vn)},[t,a]),c=()=>{const l=t.map(u=>({الكود:u.code,الاسم:u.name,الخدمة:u.service,الكورس:u.courseName,الدرجة:u.score,الحضور:`${Math.round(u.attendance<=1?u.attendance*100:u.attendance)}%`})),f=ar.json_to_sheet(l),d=ar.book_new();ar.book_append_sheet(d,f,"Details"),Mt(d,`${e.replace(/[^a-z0-9]/gi,"_").toLowerCase()}.xlsx`)};return Ta.createPortal(o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 transition-opacity duration-300",onClick:r,role:"dialog","aria-modal":"true","aria-labelledby":"details-modal-title",children:o.jsxs("div",{className:"bg-white dark:bg-slate-900 p-0 rounded-2xl shadow-xl w-full max-w-4xl m-4 flex flex-col h-[90vh] animate-fade-in-up",onClick:l=>l.stopPropagation(),children:[o.jsxs("header",{className:"flex-shrink-0 flex justify-between items-center border-b border-gray-200 dark:border-slate-700 p-4 md:p-6",children:[o.jsxs("h2",{id:"details-modal-title",className:"text-xl font-bold text-slate-800 dark:text-slate-100",children:[e," (",t.length,")"]}),o.jsx("button",{onClick:r,className:"p-2 rounded-full text-gray-500 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-slate-700 hover:text-gray-800 dark:hover:text-gray-100 transition-colors","aria-label":"إغلاق",children:o.jsx(nw,{})})]}),o.jsx("main",{className:"flex-grow overflow-y-auto p-4 md:p-6",children:t.length>0?o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-slate-700",children:[o.jsx("thead",{className:"bg-gray-50 dark:bg-slate-800 sticky top-0",children:o.jsxs("tr",{children:[o.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"الاسم"}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"الخدمة"}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"الدرجة"}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"الحضور"}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"الكود"})]})}),o.jsx("tbody",{className:"bg-white dark:bg-slate-900 divide-y divide-gray-200 dark:divide-slate-700",children:i.map((l,f)=>{const d=l.attendance<=1?l.attendance*100:l.attendance;return o.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-slate-800/60",children:[o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-gray-100",children:l.name}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:l.service}),o.jsx("td",{className:`px-6 py-4 whitespace-nowrap text-sm font-semibold ${l.score==="غائب"?"text-red-500":"text-gray-800 dark:text-gray-200"}`,children:l.score}),o.jsxs("td",{className:`px-6 py-4 whitespace-nowrap text-sm font-semibold ${d<50?"text-amber-500":"text-gray-800 dark:text-gray-200"}`,children:[Math.round(d),"%"]}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:l.code||"N/A"})]},`${l.code}-${l.name}-${f}`)})})]})}):o.jsx("div",{className:"flex items-center justify-center h-full",children:o.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"لا توجد بيانات لعرضها لهذه الفئة."})})}),o.jsxs("footer",{className:"flex-shrink-0 flex items-center justify-between border-t border-gray-200 dark:border-slate-700 px-4 py-3 sm:px-6",children:[o.jsx("div",{children:t.length>0&&o.jsxs("button",{onClick:c,className:"flex items-center justify-center px-4 py-2 bg-green-600 text-white font-semibold rounded-lg hover:bg-green-700 transition",children:[o.jsx(iw,{})," تصدير إلى Excel"]})}),n>1&&o.jsxs("div",{className:"flex flex-1 justify-end gap-2",children:[o.jsx("button",{onClick:()=>s(l=>Math.max(1,l-1)),disabled:a===1,className:"relative inline-flex items-center rounded-md border border-gray-300 dark:border-slate-600 bg-white dark:bg-slate-800 px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-slate-700 disabled:opacity-50 disabled:cursor-not-allowed",children:"السابق"}),o.jsxs("span",{className:"text-sm text-gray-700 dark:text-gray-300 flex items-center",children:["صفحة ",o.jsx("strong",{className:"font-semibold mx-1",children:a})," من ",o.jsx("strong",{className:"font-semibold mx-1",children:n})]}),o.jsx("button",{onClick:()=>s(l=>Math.min(n,l+1)),disabled:a===n,className:"relative ml-3 inline-flex items-center rounded-md border border-gray-300 dark:border-slate-600 bg-white dark:bg-slate-800 px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-slate-700 disabled:opacity-50 disabled:cursor-not-allowed",children:"التالي"})]})]})]})}),document.body)},ow={mainTitle:"العنوان الرئيسي للشهادة",subTitle1:"السطر الثاني (تحت العنوان الرئيسي)",subTitle2:"السطر الثالث (تحت العنوان الرئيسي)",introLine:"جملة التقديم الأولية",bodyLine1:"النص قبل اسم الخدمة",bodyLine2:"النص قبل اسم الكورس",bodyLine3:"اسم الكورس (سيتم استبداله تلقائياً)",bodyLine4:"نهاية فقرة الاجتياز (السطر الأول)",bodyLine5:"بداية فقرة التقدير (السطر الثاني)",patronageTitle:"عنوان الراعي",patronName:"اسم الراعي وتفاصيله",responsiblePriestTitle:"لقب الكاهن المسؤول"},lw=({certificateTexts:e,setCertificateTexts:t})=>{const{addToast:r}=os(),a=G.useRef(null),s=G.useCallback(()=>{r("تم حفظ التغييرات تلقائياً.","success")},[r]),n=G.useCallback(()=>{a.current&&clearTimeout(a.current),a.current=window.setTimeout(()=>{s()},1e3)},[s]),i=(c,l)=>{t(f=>({...f,[c]:l})),n()};return o.jsxs("div",{className:"w-full",children:[o.jsxs("header",{className:"mb-8",children:[o.jsx("h1",{className:"text-2xl md:text-3xl font-semibold text-slate-800 dark:text-slate-100",children:"إدارة نصوص الشهادة"}),o.jsx("p",{className:"mt-2 text-slate-600 dark:text-slate-400",children:"هنا يمكنك تعديل جميع النصوص التي تظهر في شهادة التقدير. التغييرات التي تجريها هنا ستنعكس مباشرة على جميع الشهادات التي يتم إنشاؤها."})]}),o.jsxs("div",{className:"border border-gray-200/80 dark:border-slate-700 rounded-lg shadow-sm",children:[o.jsx("div",{className:"p-6 bg-white dark:bg-slate-800 grid grid-cols-1 md:grid-cols-2 gap-6 rounded-t-lg",children:Object.keys(e).map(c=>o.jsxs("div",{children:[o.jsx("label",{htmlFor:c,className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1.5",children:ow[c]}),o.jsx("textarea",{id:c,rows:c==="patronName"||c==="bodyLine2"?3:2,value:e[c],onChange:l=>i(c,l.target.value),className:"w-full p-2 border border-gray-300 dark:border-slate-600 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 text-sm bg-white dark:bg-slate-700 text-gray-800 dark:text-gray-200"}),c==="bodyLine2"&&o.jsxs("p",{className:"text-xs text-slate-500 dark:text-slate-400 mt-1",children:['يجب أن يحتوي هذا النص على اسم الكورس المؤقت الذي سيتم استبداله. الاسم الحالي هو: "',e.bodyLine3,'"']})]},c))}),o.jsxs("div",{className:"p-4 bg-slate-50 dark:bg-slate-800/50 border-t border-gray-200/80 dark:border-slate-700 rounded-b-lg text-left",children:[o.jsx("button",{className:"px-5 py-2 bg-indigo-600 text-white font-bold rounded-lg hover:bg-indigo-700 transition-colors disabled:bg-indigo-300",children:"حفظ التغييرات (اختياري)"}),o.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400 mt-2 text-right",children:"ملاحظة: يتم حفظ التغييرات تلقائياً أثناء الكتابة. هذا الزر وظيفته مستقبلية."})]})]})]})},fw=({servant:e,onClose:t,onSave:r,isSubmitting:a})=>{const[s,n]=G.useState({code:"",name:"",mobileNumber:"",allServices:""}),[i,c]=G.useState({}),l=!!e;G.useEffect(()=>(document.body.style.overflow="hidden",()=>{document.body.style.overflow="unset"}),[]),G.useEffect(()=>{e&&n({code:e.code,name:e.name,mobileNumber:e.mobileNumber||"",allServices:(e.allServices||[]).join(", ")})},[e]);const f=h=>{const{name:m,value:g}=h.target;n(x=>({...x,[m]:g})),i[m]&&c(x=>({...x,[m]:""}))},d=()=>{const h={};return s.code.trim()||(h.code="الكود مطلوب"),s.name.trim()||(h.name="الاسم مطلوب"),c(h),Object.keys(h).length===0},u=h=>{if(h.preventDefault(),!d())return;const m=s.allServices.split(",").map(x=>x.trim()).filter(Boolean),g={code:s.code.trim(),name:s.name.trim(),mobileNumber:s.mobileNumber.trim(),allServices:m,primaryService:m[0]||""};r(g)};return Ta.createPortal(o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50",children:o.jsxs("div",{className:"bg-white p-8 rounded-2xl shadow-xl w-full max-w-md m-4 animate-fade-in-up",role:"dialog","aria-modal":"true",children:[o.jsx("h3",{className:"text-xl font-bold text-slate-800 mb-6",children:l?"تعديل بيانات الخادم":"إضافة خادم جديد"}),o.jsxs("form",{onSubmit:u,noValidate:!0,children:[o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{htmlFor:"code",className:"block text-sm font-medium text-gray-700",children:"الكود"}),o.jsx("input",{type:"text",name:"code",id:"code",value:s.code,onChange:f,disabled:l,className:`w-full mt-1 px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 ${l?"bg-gray-100":""} ${i.code?"border-red-500":"border-gray-300"}`,required:!0}),i.code&&o.jsx("p",{className:"text-red-500 text-xs mt-1",children:i.code})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700",children:"الاسم بالكامل"}),o.jsx("input",{type:"text",name:"name",id:"name",value:s.name,onChange:f,className:`w-full mt-1 px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 ${i.name?"border-red-500":"border-gray-300"}`,required:!0}),i.name&&o.jsx("p",{className:"text-red-500 text-xs mt-1",children:i.name})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"mobileNumber",className:"block text-sm font-medium text-gray-700",children:"رقم الموبايل"}),o.jsx("input",{type:"text",name:"mobileNumber",id:"mobileNumber",value:s.mobileNumber,onChange:f,className:"w-full mt-1 px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500"})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"allServices",className:"block text-sm font-medium text-gray-700",children:"الخدمات"}),o.jsx("input",{type:"text",name:"allServices",id:"allServices",placeholder:"مثال: خدمة ابتدائي, خدمة الحضانة",value:s.allServices,onChange:f,className:"w-full mt-1 px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500"}),o.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"افصل بين الخدمات بفاصلة ( , )."})]})]}),o.jsxs("div",{className:"flex justify-end items-center gap-4 mt-8",children:[o.jsx("button",{type:"button",onClick:t,disabled:a,className:"px-5 py-2 bg-gray-100 text-slate-700 font-semibold rounded-lg hover:bg-gray-200 transition-colors disabled:opacity-50",children:"إلغاء"}),o.jsx("button",{type:"submit",disabled:a,className:"px-5 py-2 bg-indigo-600 text-white font-bold rounded-lg hover:bg-indigo-700 transition-colors disabled:bg-indigo-300 disabled:cursor-wait",children:a?"جاري الحفظ...":"حفظ"})]})]})]})}),document.body)},cs=({title:e,message:t,onConfirm:r,onCancel:a,isConfirming:s,confirmText:n="تأكيد",cancelText:i="إلغاء",confirmButtonClass:c="bg-indigo-600 hover:bg-indigo-700"})=>(G.useEffect(()=>(document.body.style.overflow="hidden",()=>{document.body.style.overflow="unset"}),[]),Ta.createPortal(o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50",children:o.jsxs("div",{className:"bg-white dark:bg-slate-800 p-8 rounded-2xl shadow-xl w-full max-w-sm m-4 animate-fade-in-up",role:"dialog","aria-modal":"true",children:[o.jsx("h3",{className:"text-xl font-bold text-slate-800 dark:text-slate-100",children:e}),o.jsx("p",{className:"text-slate-600 dark:text-slate-300 my-4",children:t}),o.jsxs("div",{className:"flex justify-end items-center gap-4 mt-6",children:[o.jsx("button",{type:"button",onClick:a,disabled:s,className:"px-5 py-2 bg-gray-100 dark:bg-slate-700 text-slate-700 dark:text-slate-200 font-semibold rounded-lg hover:bg-gray-200 dark:hover:bg-slate-600 transition-colors disabled:opacity-50",children:i}),o.jsx("button",{type:"button",onClick:r,disabled:s,className:`px-5 py-2 text-white font-bold rounded-lg transition-colors disabled:cursor-wait ${c} disabled:opacity-70`,children:s?"جاري التنفيذ...":n})]})]})}),document.body)),dw=()=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V8a2 2 0 00-2-2h-5m-4 0V5a2 2 0 012-2h2a2 2 0 012 2v1m-4 0h4"})}),hw=()=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})}),uw=()=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-slate-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 13.255A23.931 23.931 0 0112 15c-3.183 0-6.22-.62-9-1.745M16 6V4a2 2 0 00-2-2h-4a2 2 0 00-2 2v2m4 6h.01M5 20h14a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),xw=()=>o.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-indigo-600"}),mw=()=>o.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M12 14l9-5-9-5-9 5 9 5z"}),o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M12 14l6.16-3.422a12.083 12.083 0 01.665 6.479A11.952 11.952 0 0012 20.055a11.952 11.952 0 00-6.824-2.998 12.078 12.078 0 01.665-6.479L12 14z"}),o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M12 14v6m-4-3v3m8-3v3"})]}),Ko=()=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"})}),gw=()=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.52 4.674c.3.921-.755 1.688-1.54 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976-2.888c-.784.57-1.838-.197-1.539-1.118l1.52-4.674a1 1 0 00-.363-1.118L2.98 9.11c-.783-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.52-4.674z"})}),pw=()=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),vw=({servant:e})=>o.jsxs("div",{className:"bg-gradient-to-br from-indigo-50 to-white dark:from-slate-800/50 dark:to-slate-900 rounded-t-2xl p-6 shadow-sm border-b border-gray-200 dark:border-slate-700 flex flex-col sm:flex-row items-center gap-6 text-center sm:text-right flex-shrink-0",children:[o.jsx("div",{className:"relative flex-shrink-0",children:o.jsx("img",{src:e.avatarUrl||"https://i.postimg.cc/9XJjqvFn/tsmym-bdwn-ʿnwan.png",alt:`صورة ${e.name}`,className:"w-28 h-28 rounded-full object-cover border-4 border-white dark:border-slate-600 shadow-lg"})}),o.jsxs("div",{className:"flex-grow",children:[o.jsx("h2",{className:"text-3xl font-bold text-indigo-800 dark:text-indigo-300",style:{fontFamily:"'El Messiri', sans-serif"},children:e.name}),o.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-x-4 gap-y-2 mt-3 justify-center sm:justify-start",children:[o.jsxs("div",{className:"flex items-center gap-2 bg-indigo-100 text-indigo-800 px-3 py-1.5 rounded-full text-sm font-semibold self-center",children:[o.jsx(dw,{}),o.jsxs("span",{children:["الكود: ",e.code]})]}),e.mobileNumber&&o.jsxs("div",{className:"flex items-center gap-2 bg-slate-100 dark:bg-slate-700 text-slate-800 dark:text-slate-200 px-3 py-1.5 rounded-full text-sm font-semibold self-center",children:[o.jsx(hw,{}),o.jsx("span",{children:e.mobileNumber})]})]}),o.jsxs("div",{className:"mt-4 flex flex-wrap items-center justify-center sm:justify-start gap-2",children:[o.jsx(uw,{}),(e.allServices&&e.allServices.length>0?e.allServices:[e.primaryService]).filter(Boolean).map(t=>o.jsx("span",{className:"bg-slate-200 dark:bg-slate-700 text-slate-700 dark:text-slate-200 px-3 py-1 text-xs font-semibold rounded-full",children:t},t))]})]})]}),wn=({icon:e,title:t,value:r,color:a})=>o.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl p-5 shadow-sm border border-gray-200/80 dark:border-slate-700 flex items-center gap-4",children:[o.jsx("div",{className:`rounded-full p-3 ${a}`,children:e}),o.jsxs("div",{children:[o.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 font-medium",children:t}),o.jsx("p",{className:"text-2xl font-bold text-gray-800 dark:text-gray-200",children:r})]})]}),ww=({results:e,evaluations:t})=>{const r=G.useMemo(()=>{const a=e.filter(c=>typeof c.score=="number"),s=a.length>0?Math.round(a.reduce((c,l)=>c+l.score,0)/a.length):0,n=e.length>0?Math.round(e.reduce((c,l)=>{const f=typeof l.attendance=="number"?l.attendance:0,d=f<=1?f*100:f;return c+d},0)/e.length):0,i=t.length>0?Math.round(t.reduce((c,l)=>c+l.overallAverage,0)/t.length):0;return{avgScore:s,avgAttendance:n,avgEvaluation:i}},[e,t]);return o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4 my-6 px-6 flex-shrink-0",children:[o.jsx(wn,{icon:o.jsx(gw,{}),title:"متوسط الدرجات",value:`${r.avgScore}/100`,color:"bg-yellow-100 text-yellow-600"}),o.jsx(wn,{icon:o.jsx(pw,{}),title:"متوسط الحضور",value:`${r.avgAttendance}%`,color:"bg-green-100 text-green-600"}),o.jsx(wn,{icon:o.jsx(Ko,{}),title:"متوسط التقييم",value:`${r.avgEvaluation}%`,color:"bg-sky-100 text-sky-600"})]})},Yo={spiritualLife:"الحياة الروحية",commitment:"الالتزام",preparationAndDelivery:"التحضير والأداء",relationshipWithPeers:"العلاقة بالخدام",relationshipWithCongregation:"العلاقة بالمخدومين",personalGrowth:"النمو الشخصي"},kw=({scores:e})=>{const a=Object.values(Yo),s=Object.values(e),n=a.length,i=s.map((c,l)=>{const f=Math.PI/2-2*Math.PI*l/n,d=75+75*.8*(c/100)*Math.cos(f),u=75-75*.8*(c/100)*Math.sin(f);return`${d},${u}`}).join(" ");return o.jsxs("svg",{viewBox:"0 0 150 150",className:"w-full h-full",children:[o.jsx("defs",{children:o.jsxs("linearGradient",{id:"radarGradient",x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[o.jsx("stop",{offset:"0%",style:{stopColor:"rgba(var(--color-primary-rgb), 0.5)"}}),o.jsx("stop",{offset:"100%",style:{stopColor:"rgba(var(--color-primary-accent-rgb), 0.5)"}})]})}),a.map((c,l)=>{const f=Math.PI/2-2*Math.PI*l/n,d=75,u=75,h=75+75*.9*Math.cos(f),m=75-75*.9*Math.sin(f),g=75+75*1.1*Math.cos(f),x=75-75*1.1*Math.sin(f);return o.jsxs("g",{children:[o.jsx("line",{x1:d,y1:u,x2:h,y2:m,stroke:"rgba(156, 163, 175, 0.3)",strokeWidth:"0.5"}),o.jsx("text",{x:g,y:x,fontSize:"6",textAnchor:"middle",alignmentBaseline:"middle",className:"fill-current text-gray-500 dark:text-gray-400 font-semibold",children:c})]},l)}),[.25,.5,.75,1].map((c,l)=>o.jsx("polygon",{points:a.map((f,d)=>{const u=Math.PI/2-2*Math.PI*d/n,h=75+75*.8*c*Math.cos(u),m=75-75*.8*c*Math.sin(u);return`${h},${m}`}).join(" "),fill:"none",stroke:"rgba(156, 163, 175, 0.3)",strokeWidth:"0.5"},l)),o.jsx("polygon",{points:i,fill:"url(#radarGradient)",stroke:"rgb(var(--color-primary-rgb))",strokeWidth:"1.5"})]})},_w=({evaluation:e})=>{const[t,r]=G.useState(!1),{overallAverage:a,scores:s}=e,n=8,i=40,c=2*Math.PI*i,l=a/100*c;return o.jsxs("div",{className:"border border-gray-200 dark:border-slate-700 rounded-lg bg-white dark:bg-slate-800 shadow-sm transition-all duration-300",children:[o.jsxs("div",{className:"p-4 flex items-center gap-4 cursor-pointer",onClick:()=>r(!t),children:[o.jsx("div",{className:"relative w-24 h-24 flex-shrink-0",children:o.jsxs("svg",{className:"w-full h-full",viewBox:"0 0 100 100",children:[o.jsx("circle",{className:"text-gray-200 dark:text-slate-700",strokeWidth:n,stroke:"currentColor",fill:"transparent",r:i,cx:"50",cy:"50"}),o.jsx("circle",{className:"text-indigo-500",strokeWidth:n,strokeLinecap:"round",stroke:"currentColor",fill:"transparent",r:i,cx:"50",cy:"50",style:{strokeDasharray:c,strokeDashoffset:c-l,transition:"stroke-dashoffset 0.5s ease-out"},transform:"rotate(-90 50 50)"}),o.jsxs("text",{x:"50",y:"52",className:"font-bold text-2xl text-indigo-800 dark:text-indigo-300",textAnchor:"middle",alignmentBaseline:"middle",children:[Math.round(a),"%"]})]})}),o.jsxs("div",{className:"flex-grow",children:[o.jsxs("div",{className:"flex justify-between items-start",children:[o.jsx("h4",{className:"font-semibold text-slate-800 dark:text-slate-200",children:e.serviceName}),o.jsx("span",{className:"text-sm font-medium bg-indigo-100 text-indigo-800 px-2 py-0.5 rounded-full",children:e.year})]}),o.jsxs("p",{className:"text-xs text-slate-500 dark:text-slate-400 mt-1",children:["المُقيِّم: ",e.evaluatorName]})]}),o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 text-gray-400 transition-transform duration-300 ${t?"rotate-180":""}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),t&&o.jsxs("div",{className:"p-4 border-t border-gray-200 dark:border-slate-700 animate-fade-in-up grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsx("div",{className:"flex items-center justify-center",children:o.jsx(kw,{scores:s})}),o.jsx("div",{className:"space-y-3",children:Object.entries(s).map(([f,d])=>o.jsxs("div",{children:[o.jsxs("div",{className:"flex justify-between items-center mb-1 text-sm",children:[o.jsx("span",{className:"font-medium text-gray-700 dark:text-gray-300",children:Yo[f]}),o.jsxs("span",{className:"font-semibold text-indigo-700 dark:text-indigo-300",children:[d,"%"]})]}),o.jsx("div",{className:"w-full bg-gray-200 dark:bg-slate-700 rounded-full h-2",children:o.jsx("div",{className:"bg-indigo-500 h-2 rounded-full",style:{width:`${d}%`}})})]},f))}),e.generalNotes&&o.jsxs("p",{className:"md:col-span-2 text-sm text-slate-600 dark:text-slate-300 italic border-r-2 border-gray-200 dark:border-slate-600 pr-2 mt-4",children:['"',e.generalNotes,'"']})]})]})},kn=10,Jo=({servant:e,onClose:t})=>{const[r,a]=G.useState([]),[s,n]=G.useState([]),[i,c]=G.useState(!0),[l,f]=G.useState(""),[d,u]=G.useState("evaluations"),[h,m]=G.useState(1);G.useEffect(()=>(document.body.style.overflow="hidden",(async()=>{c(!0),f("");try{const b=e.code,w=parseInt(e.code,10),I=(await qe.collection("courseResults").where("servantCode","in",[b,w]).get()).docs.map(B=>B.data()),N=(await qe.collection("evaluations").where("servantCode","in",[b,w]).get()).docs.map(B=>{const L=B.data();if(L.scores&&typeof L.overallAverage=="number")return{id:B.id,...L};const Q=(L.rating||0)*20,fe={spiritualLife:Q,commitment:Q,preparationAndDelivery:Q,relationshipWithPeers:Q,relationshipWithCongregation:Q,personalGrowth:Q};return{id:B.id,servantCode:L.servantCode,serviceName:L.serviceName,year:L.year,evaluatorName:L.evaluatorName,scores:fe,overallAverage:Q,generalNotes:L.notes}});a(I.sort((B,L)=>L.year-B.year)),n(N.sort((B,L)=>L.year-B.year))}catch(b){console.error("Error fetching servant history:",b),f("حدث خطأ أثناء تحميل سجل الخادم.")}finally{c(!1)}})(),()=>{document.body.style.overflow="unset"}),[e.code]);const g=Math.ceil(r.length/kn),x=G.useMemo(()=>{const k=(h-1)*kn;return r.slice(k,k+kn)},[r,h]),p=()=>{switch(d){case"results":return o.jsx("div",{className:"animate-fade-in-up",children:r.length>0?o.jsxs("div",{className:"border border-gray-200 dark:border-slate-700 rounded-lg overflow-hidden shadow-sm",children:[o.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-slate-700 text-sm",children:[o.jsx("thead",{className:"bg-gray-50 dark:bg-slate-700",children:o.jsxs("tr",{children:[o.jsx("th",{className:"px-4 py-2 text-right font-medium text-gray-500 dark:text-gray-300",children:"الكورس"}),o.jsx("th",{className:"px-4 py-2 text-right font-medium text-gray-500 dark:text-gray-300",children:"السنة"}),o.jsx("th",{className:"px-4 py-2 text-right font-medium text-gray-500 dark:text-gray-300",children:"الدرجة"}),o.jsx("th",{className:"px-4 py-2 text-right font-medium text-gray-500 dark:text-gray-300",children:"الحضور"})]})}),o.jsx("tbody",{className:"bg-white dark:bg-slate-800 divide-y divide-gray-200 dark:divide-slate-700",children:x.map((k,b)=>o.jsxs("tr",{children:[o.jsx("td",{className:"px-4 py-2 font-medium text-slate-800 dark:text-slate-200",children:k.courseName}),o.jsx("td",{className:"px-4 py-2 text-slate-600 dark:text-slate-400",children:k.year}),o.jsx("td",{className:`px-4 py-2 font-semibold ${k.score==="غائب"?"text-red-500":"text-slate-800 dark:text-slate-200"}`,children:k.score}),o.jsx("td",{className:"px-4 py-2 text-slate-600 dark:text-slate-400",children:typeof k.attendance=="number"?`${Math.round(k.attendance<=1?k.attendance*100:k.attendance)}%`:"-"})]},b))})]}),g>1&&o.jsxs("div",{className:"flex items-center justify-end gap-2 border-t border-gray-200 dark:border-slate-700 bg-white dark:bg-slate-800 px-4 py-3",children:[o.jsx("button",{onClick:()=>m(k=>Math.max(1,k-1)),disabled:h===1,className:"relative inline-flex items-center rounded-md border border-gray-300 dark:border-slate-600 bg-white dark:bg-slate-700 px-3 py-1 text-xs font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-slate-600 disabled:opacity-50",children:"السابق"}),o.jsxs("span",{className:"text-xs text-gray-700 dark:text-gray-300",children:["صفحة ",h," من ",g]}),o.jsx("button",{onClick:()=>m(k=>Math.min(g,k+1)),disabled:h===g,className:"relative inline-flex items-center rounded-md border border-gray-300 dark:border-slate-600 bg-white dark:bg-slate-700 px-3 py-1 text-xs font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-slate-600 disabled:opacity-50",children:"التالي"})]})]}):o.jsx("p",{className:"text-slate-500 dark:text-slate-400 bg-gray-100 dark:bg-slate-800 p-4 rounded-md text-center",children:"لا يوجد سجل كورسات لهذا الخادم."})});case"evaluations":return o.jsx("div",{className:"animate-fade-in-up space-y-4",children:s.length>0?s.map(k=>o.jsx(_w,{evaluation:k},k.id)):o.jsx("p",{className:"text-slate-500 dark:text-slate-400 bg-gray-100 dark:bg-slate-800 p-4 rounded-md text-center",children:"لا يوجد سجل تقييمات لهذا الخادم."})});default:return null}};return Ta.createPortal(o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50",onClick:t,children:o.jsxs("div",{className:"bg-gray-50 dark:bg-slate-900 rounded-2xl shadow-xl w-full max-w-4xl m-4 flex flex-col h-[90vh] animate-fade-in-up",onClick:k=>k.stopPropagation(),children:[o.jsxs("main",{className:"flex-grow flex flex-col overflow-hidden",children:[o.jsx(vw,{servant:e}),o.jsx("div",{className:"flex-grow overflow-y-auto",children:i?o.jsx("div",{className:"flex justify-center items-center h-full",children:o.jsx(xw,{})}):l?o.jsx("p",{className:"text-center text-red-500 py-10",children:l}):o.jsxs(o.Fragment,{children:[o.jsx(ww,{results:r,evaluations:s}),o.jsx("div",{className:"border-b border-gray-200 dark:border-slate-700 px-6",children:o.jsxs("nav",{className:"-mb-px flex justify-center gap-x-6 sm:gap-x-8","aria-label":"Tabs",children:[o.jsxs("button",{onClick:()=>u("evaluations"),className:`flex items-center gap-2 whitespace-nowrap py-4 px-1 border-b-4 font-semibold text-base transition-colors ${d==="evaluations"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-200 hover:border-gray-300 dark:hover:border-slate-600"}`,children:[o.jsx(Ko,{})," سجل التقييمات"]}),o.jsxs("button",{onClick:()=>u("results"),className:`flex items-center gap-2 whitespace-nowrap py-4 px-1 border-b-4 font-semibold text-base transition-colors ${d==="results"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-200 hover:border-gray-300 dark:hover:border-slate-600"}`,children:[o.jsx(mw,{})," سجل الكورسات"]})]})}),o.jsx("div",{className:"p-6",children:p()})]})})]}),o.jsx("footer",{className:"flex-shrink-0 text-center border-t border-gray-200 dark:border-slate-700 bg-white dark:bg-slate-800 p-4 rounded-b-2xl",children:o.jsxs("button",{onClick:t,className:"px-6 py-3 bg-gray-100 dark:bg-slate-700 text-slate-600 dark:text-slate-200 font-semibold rounded-lg hover:bg-gray-200 dark:hover:bg-slate-600 focus:outline-none focus:ring-2 focus:ring-gray-400 focus:ring-opacity-75 transition-all duration-300 transform hover:scale-105 flex items-center justify-center gap-2 mx-auto",children:[o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),o.jsx("span",{children:"إغلاق"})]})})]})}),document.body)},yw=()=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),bw=()=>o.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-indigo-600"}),Ew=()=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.5L15.232 5.232z"})}),Sw=()=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),Tw=()=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),Nw=()=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-4-4V7a4 4 0 014-4h5l4 4v1m-4 5h-2m2 0h2m-4 5a2 2 0 104 0 2 2 0 10-4 0zM12 6v6m0 0v6m0-6h6m-6 0H6"})}),Fw=()=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-green-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),Cw=()=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-red-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"})}),Aw=()=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-10 w-10 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-4-4V7a4 4 0 014-4h5l4 4v1m-4 5h-2m2 0h2m-4 5a2 2 0 104 0 2 2 0 10-4 0zM12 6v6m0 0v6m0-6h6m-6 0H6"})}),jw=()=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M5 15l7-7 7 7"})}),Dw=()=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M19 9l-7 7-7 7"})}),Iw=()=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",viewBox:"0 0 24 24",fill:"currentColor",children:o.jsx("path",{d:"M21.16,3.16a.5.5,0,0,0-.57-.16l-18,4A.5.5,0,0,0,2.5,8v8a.5.5,0,0,0,.16.37.5.5,0,0,0,.38.13l18,4a.5.5,0,0,0,.57-.6V3.5A.5.5,0,0,0,21.16,3.16ZM11,12.1,7.26,14.28,3.5,12.5,7.1,10.59Zm8.5,3.31-3.6-1.74,3.6-1.92ZM18,7.91,14.25,10,11,8.1,14.65,6Z"})}),Ow=()=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-16 w-16 mx-auto text-green-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),_n=50,Lw=()=>{const[e,t]=G.useState([]),[r,a]=G.useState(!0),[s,n]=G.useState(""),[i,c]=G.useState(""),[l,f]=G.useState("asc"),[d,u]=G.useState(1),[h,m]=G.useState("list"),[g,x]=G.useState(!1),[p,k]=G.useState(!1),[b,w]=G.useState(null),[j,R]=G.useState(!1),[I,E]=G.useState(null),[U,N]=G.useState(new Set),[B,L]=G.useState(!1),[P,Q]=G.useState(!1),[fe,ie]=G.useState([]),[pe,he]=G.useState(["الكل"]),[Ve,H]=G.useState(!1),we=G.useRef(null),{addToast:Ee}=os(),[A,M]=G.useState("idle"),[D,O]=G.useState([]),[W,ee]=G.useState(""),[se,J]=G.useState({success:0,failed:0,total:0}),[q,ke]=G.useState(""),S=G.useCallback(async()=>{a(!0),n("");try{const ue=(await qe.collection("servants").get()).docs.map(be=>({...be.data(),code:be.id}));t(ue);const oe=new Set;ue.forEach(be=>{Array.isArray(be.allServices)?be.allServices.forEach(De=>De&&oe.add(De.trim())):be.primaryService&&oe.add(be.primaryService.trim())}),ie(["الكل",...Array.from(oe).sort()])}catch(Z){console.error("Error fetching servants:",Z),n("حدث خطأ أثناء جلب بيانات الخدام.")}finally{a(!1)}},[]);G.useEffect(()=>{h==="list"&&S()},[h,S]),G.useEffect(()=>{const Z=ue=>{we.current&&!we.current.contains(ue.target)&&H(!1)};return document.addEventListener("mousedown",Z),()=>document.removeEventListener("mousedown",Z)},[]);const je=G.useMemo(()=>{let Z=[...e];if(!pe.includes("الكل")&&pe.length>0){const ue=new Set(pe);Z=Z.filter(oe=>(oe.allServices||[oe.primaryService]).some(De=>ue.has(De)))}if(i.trim()){const ue=i.toLowerCase().trim();Z=Z.filter(oe=>oe.name.toLowerCase().includes(ue)||oe.code.toLowerCase().includes(ue))}return Z.sort((ue,oe)=>{const be=ue.name.toUpperCase(),De=oe.name.toUpperCase();return be<De?l==="asc"?-1:1:be>De?l==="asc"?1:-1:0}),Z},[e,i,l,pe]),Ce=G.useMemo(()=>{const Z=(d-1)*_n;return je.slice(Z,Z+_n)},[je,d]),Be=Math.ceil(je.length/_n);G.useEffect(()=>{u(1)},[i,pe]);const Fe=async Z=>{R(!0);try{const{code:ue,...oe}=Z;await qe.collection("servants").doc(ue).set(oe,{merge:!0}),Ee(b?"تم تحديث الخادم.":"تم إضافة الخادم.","success"),S(),x(!1)}catch{Ee("فشل حفظ بيانات الخادم.","error")}finally{R(!1)}},ce=async()=>{if(b){R(!0);try{await qe.collection("servants").doc(b.code).delete(),Ee(`تم حذف الخادم "${b.name}".`,"success"),S(),k(!1)}catch{Ee("فشل حذف الخادم.","error")}finally{R(!1)}}},Ye=()=>{w(null),x(!0)},hr=Z=>{w(Z),x(!0)},Re=Z=>E(Z),Ur=Z=>{w(Z),k(!0)},Kr=Z=>{he(ue=>{if(Z==="الكل")return ue.includes("الكل")?[]:fe;const oe=new Set(ue.filter(be=>be!=="الكل"));return oe.has(Z)?oe.delete(Z):oe.add(Z),oe.size===fe.length-1?fe:Array.from(oe)})},$r=()=>{Q(!0);try{const Z=je.map(({code:be,name:De,mobileNumber:Pe,allServices:tr})=>({الكود:be,الاسم:De,"رقم الموبايل":Pe,الخدمات:tr==null?void 0:tr.join(", ")})),ue=ar.json_to_sheet(Z),oe=ar.book_new();ar.book_append_sheet(oe,ue,"Filtered Servants"),Mt(oe,`Filtered_Servants_${new Date().toISOString().split("T")[0]}.xlsx`)}catch{Ee("حدث خطأ أثناء تصدير البيانات.","error")}finally{Q(!1)}},cr=D.filter(Z=>Z.errors.length===0),ae=async Z=>{var oe;const ue=(oe=Z.target.files)==null?void 0:oe[0];if(ue){M("preview"),ee(ue.name),ke(""),O([]);try{const be=await ue.arrayBuffer(),De=ns(be),Pe=De.SheetNames[0],tr=De.Sheets[Pe],Et=ar.sheet_to_json(tr).map(Er=>{const ft=[];(!Er.code||String(Er.code).trim()==="")&&ft.push("الكود مطلوب"),(!Er.name||String(Er.name).trim()==="")&&ft.push("الاسم مطلوب");const dt=(Er.allServices||Er.primaryService||"").toString().split(",").map(pt=>pt.trim()).filter(Boolean);return{servant:{code:String(Er.code).trim(),name:String(Er.name).trim(),mobileNumber:String(Er.mobileNumber||"").trim(),primaryService:dt[0]||"",allServices:dt},errors:ft}});O(Et)}catch{ke("حدث خطأ أثناء قراءة الملف."),Ee("حدث خطأ أثناء قراءة الملف.","error"),M("idle")}finally{Z.target.value=""}}},re=()=>{const Z=[{code:"12345",name:"مثال اسم الخادم",mobileNumber:"01200000000",allServices:"خدمة ابتدائي, خدمة مدارس الأحد"}],ue=ar.json_to_sheet(Z),oe=ar.book_new();ar.book_append_sheet(oe,ue,"Servants"),Mt(oe,"Servant_Import_Template.xlsx")},ge=async()=>{M("importing");let Z=0;const ue=cr.length;J({success:0,failed:0,total:ue});const oe=[];for(let be=0;be<ue;be+=500)oe.push(cr.slice(be,be+500));for(const be of oe){const De=qe.batch();be.forEach(Pe=>{const tr=qe.collection("servants").doc(Pe.servant.code);De.set(tr,Pe.servant,{merge:!0})}),await De.commit(),Z+=be.length,J(Pe=>({...Pe,success:Z}))}M("complete"),Ee(`اكتمل الاستيراد! تم استيراد ${Z} سجل.`,"success"),S()},Te=()=>{M("idle"),m("list")};if(r&&e.length===0)return o.jsx("div",{className:"flex justify-center items-center py-20",children:o.jsx(bw,{})});const Oe=()=>o.jsxs("div",{className:"bg-white dark:bg-slate-800 p-6 md:p-8 rounded-lg shadow-sm border border-gray-200/80 dark:border-slate-700",children:[o.jsxs("header",{className:"flex justify-between items-center mb-8",children:[o.jsxs("div",{children:[o.jsx("h2",{className:"text-2xl font-bold text-slate-800 dark:text-slate-100",children:"استيراد بيانات الخدام"}),o.jsx("p",{className:"text-slate-500 dark:text-slate-400",children:"أضف أو حدِّث بيانات الخدام بشكل جماعي."})]}),o.jsx("button",{onClick:Te,className:"px-5 py-2 bg-gray-100 dark:bg-slate-700 text-slate-700 dark:text-slate-200 font-semibold rounded-lg hover:bg-gray-200 dark:hover:bg-slate-600",children:"العودة للقائمة"})]}),q&&o.jsx("div",{className:"mb-4 text-center text-red-600 bg-red-100 dark:bg-red-900/20 dark:text-red-400 p-3 rounded-lg",children:q}),A==="idle"&&o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8 items-center",children:[o.jsxs("div",{children:[o.jsx("h3",{className:"font-semibold text-lg text-slate-700 dark:text-slate-200 mb-3",children:"الخطوات"}),o.jsxs("ol",{className:"list-decimal list-inside space-y-3 text-slate-600 dark:text-slate-300",children:[o.jsxs("li",{children:[o.jsx("strong",{className:"font-semibold",children:"تنزيل القالب:"})," قم بتحميل ملف Excel لضمان تطابق الأعمدة."]}),o.jsxs("li",{children:[o.jsx("strong",{className:"font-semibold",children:"ملء البيانات:"})," املأ القالب ببيانات الخدام."]}),o.jsxs("li",{children:[o.jsx("strong",{className:"font-semibold",children:"رفع الملف:"})," اختر الملف المعبأ لبدء عملية الاستيراد."]})]}),o.jsx("button",{onClick:re,className:"mt-6 px-4 py-2 bg-green-600 text-white font-semibold rounded-lg hover:bg-green-700 transition",children:"تنزيل القالب"})]}),o.jsx("div",{className:"border-2 border-dashed border-gray-300 dark:border-slate-600 rounded-lg p-8 text-center",children:o.jsxs("label",{htmlFor:"file-upload",className:"cursor-pointer",children:[o.jsx(Aw,{}),o.jsx("p",{className:"mt-2 text-indigo-600 dark:text-indigo-400 font-semibold",children:"اختر ملفاً"}),o.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"XLSX, XLS, CSV"}),o.jsx("input",{id:"file-upload",type:"file",className:"hidden",onChange:ae,accept:".xlsx, .xls, .csv"})]})})]}),A==="preview"&&o.jsxs("div",{children:[o.jsxs("h3",{className:"font-semibold text-lg text-slate-700 dark:text-slate-200 mb-4",children:["معاينة البيانات من: ",o.jsx("span",{className:"font-normal text-indigo-600",children:W})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6",children:[o.jsxs("div",{className:"bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-700 p-4 rounded-lg text-center",children:[o.jsx("p",{className:"text-2xl font-bold text-green-700 dark:text-green-300",children:cr.length}),o.jsx("p",{className:"text-sm font-medium text-green-600 dark:text-green-400",children:"سجل صالح للاستيراد"})]}),o.jsxs("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-700 p-4 rounded-lg text-center",children:[o.jsx("p",{className:"text-2xl font-bold text-red-700 dark:text-red-300",children:D.length-cr.length}),o.jsx("p",{className:"text-sm font-medium text-red-600 dark:text-red-400",children:"سجل يحتوي على أخطاء"})]})]}),o.jsx("div",{className:"max-h-80 overflow-y-auto border dark:border-slate-600 rounded-lg",children:o.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-slate-600 text-sm",children:[o.jsx("thead",{className:"bg-gray-50 dark:bg-slate-700 sticky top-0",children:o.jsxs("tr",{className:"text-right",children:[o.jsx("th",{className:"px-4 py-2 font-medium text-gray-500 dark:text-gray-300",children:"الحالة"}),o.jsx("th",{className:"px-4 py-2 font-medium text-gray-500 dark:text-gray-300",children:"الكود"}),o.jsx("th",{className:"px-4 py-2 font-medium text-gray-500 dark:text-gray-300",children:"الاسم"}),o.jsx("th",{className:"px-4 py-2 font-medium text-gray-500 dark:text-gray-300",children:"الخدمات"}),o.jsx("th",{className:"px-4 py-2 font-medium text-gray-500 dark:text-gray-300",children:"الأخطاء"})]})}),o.jsx("tbody",{className:"bg-white dark:bg-slate-800 divide-y divide-gray-200 dark:divide-slate-600",children:D.slice(0,10).map(({servant:Z,errors:ue},oe)=>{var be;return o.jsxs("tr",{className:ue.length>0?"bg-red-50 dark:bg-red-900/20":"bg-green-50 dark:bg-green-900/20",children:[o.jsx("td",{className:"px-4 py-2",children:ue.length>0?o.jsx(Cw,{}):o.jsx(Fw,{})}),o.jsx("td",{className:"px-4 py-2 font-mono text-slate-800 dark:text-slate-200",children:Z.code}),o.jsx("td",{className:"px-4 py-2 text-slate-800 dark:text-slate-200",children:Z.name}),o.jsx("td",{className:"px-4 py-2 text-slate-800 dark:text-slate-200",children:(be=Z.allServices)==null?void 0:be.join(", ")}),o.jsx("td",{className:"px-4 py-2 text-red-600 dark:text-red-400",children:ue.join(", ")})]},oe)})})]})}),D.length>10&&o.jsxs("p",{className:"text-center text-sm text-gray-500 dark:text-gray-400 mt-2",children:["... و ",D.length-10," سجلات أخرى."]}),o.jsxs("div",{className:"mt-6 flex justify-end gap-4",children:[o.jsx("button",{onClick:Te,className:"px-5 py-2 bg-gray-100 dark:bg-slate-700 text-slate-700 dark:text-slate-200 font-semibold rounded-lg hover:bg-gray-200 dark:hover:bg-slate-600",children:"إلغاء"}),o.jsxs("button",{onClick:ge,disabled:cr.length===0,className:"px-5 py-2 bg-indigo-600 text-white font-bold rounded-lg hover:bg-indigo-700 disabled:bg-indigo-300",children:["بدء الاستيراد (",cr.length,")"]})]})]}),A==="importing"&&o.jsxs("div",{className:"text-center py-12",children:[o.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-indigo-600 mx-auto"}),o.jsx("h3",{className:"text-xl font-semibold text-slate-700 dark:text-slate-200 mt-6",children:"جاري الاستيراد..."}),o.jsxs("p",{className:"text-slate-500 dark:text-slate-400 mt-2",children:["تم استيراد ",se.success," من ",se.total," سجل."]})]}),A==="complete"&&o.jsxs("div",{className:"text-center py-12",children:[o.jsx(Ow,{}),o.jsx("h3",{className:"text-2xl font-bold text-green-700 dark:text-green-400 mt-4",children:"اكتمل الاستيراد بنجاح!"}),o.jsxs("p",{className:"text-slate-600 dark:text-slate-300 mt-2",children:["تمت معالجة ",se.success," سجل بنجاح."]}),o.jsx("button",{onClick:Te,className:"mt-6 px-6 py-2 bg-indigo-600 text-white font-semibold rounded-lg hover:bg-indigo-700",children:"استيراد ملف آخر"})]})]}),ye=()=>o.jsxs(o.Fragment,{children:[o.jsxs("header",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-8 gap-4",children:[o.jsxs("div",{children:[o.jsxs("h2",{className:"text-xl font-bold text-slate-800 dark:text-slate-100",children:["إدارة الخدام (",e.length,")"]}),o.jsx("p",{className:"text-slate-500 dark:text-slate-400 mt-1",children:"عرض، إضافة، تعديل، وحذف بيانات الخدام المسجلين."})]}),o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsxs("button",{onClick:()=>m("import"),className:"flex items-center justify-center px-4 py-2 bg-green-600 text-white font-semibold rounded-lg hover:bg-green-700",children:[o.jsx(Nw,{})," استيراد"]}),o.jsxs("button",{onClick:Ye,className:"flex items-center px-4 py-2 bg-indigo-600 text-white font-bold rounded-lg hover:bg-indigo-700",children:[o.jsx(Tw,{})," إضافة خادم"]})]})]}),o.jsxs("div",{className:"mb-4 flex flex-col sm:flex-row gap-4 justify-between",children:[o.jsxs("div",{className:"flex gap-4",children:[o.jsxs("div",{className:"relative",children:[o.jsx("input",{type:"text",placeholder:"ابحث بالاسم أو بالكود...",value:i,onChange:Z=>c(Z.target.value),className:"w-full sm:w-64 px-4 py-2 pr-10 text-gray-700 bg-white dark:bg-slate-800 border border-gray-300 dark:border-slate-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 dark:text-gray-200"}),o.jsx("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none",children:o.jsx(yw,{})})]}),o.jsxs("div",{ref:we,className:"relative w-full sm:w-48",children:[o.jsxs("button",{onClick:()=>H(!Ve),className:"w-full flex justify-between items-center px-4 py-2 bg-white dark:bg-slate-800 border border-gray-300 dark:border-slate-600 rounded-lg text-sm font-medium text-gray-700 dark:text-gray-200",children:[o.jsx("span",{children:"فلتر الخدمات"}),o.jsx("svg",{className:"h-5 w-5",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:o.jsx("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})]}),Ve&&o.jsx("div",{className:"absolute z-10 top-full mt-2 w-full bg-white dark:bg-slate-800 border border-gray-200 dark:border-slate-700 rounded-lg shadow-xl max-h-60 overflow-y-auto",children:fe.map(Z=>o.jsxs("label",{className:"flex items-center px-4 py-2 text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-50 dark:hover:bg-slate-700 cursor-pointer",children:[o.jsx("input",{type:"checkbox",checked:pe.includes(Z),onChange:()=>Kr(Z),className:"h-4 w-4 text-indigo-600 border-gray-300 rounded focus:ring-indigo-500"}),o.jsx("span",{className:"mr-3",children:Z})]},Z))})]})]}),o.jsxs("div",{className:"flex items-center gap-4",children:[o.jsxs("p",{className:"text-sm font-semibold text-slate-600 dark:text-slate-300",children:["يتم عرض: ",je.length," خدام"]}),o.jsxs("button",{onClick:$r,disabled:P,className:"flex items-center justify-center px-4 py-2 bg-green-100 text-green-800 font-semibold rounded-lg hover:bg-green-200 dark:bg-green-900/30 dark:text-green-300 disabled:opacity-50",children:[o.jsx(Iw,{})," ",P?"جاري...":"تصدير الكل"]})]})]}),o.jsxs("div",{className:"overflow-x-auto border border-gray-200 dark:border-slate-700 rounded-lg shadow-sm",children:[o.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-slate-700",children:[o.jsx("thead",{className:"bg-slate-100 dark:bg-slate-800",children:o.jsxs("tr",{children:[o.jsx("th",{className:"px-6 py-3 text-right text-sm font-medium text-gray-500 dark:text-gray-400",children:o.jsxs("button",{onClick:()=>f(Z=>Z==="asc"?"desc":"asc"),className:"flex items-center gap-1 group",children:[o.jsx("span",{children:"الاسم"})," ",l==="asc"?o.jsx(jw,{}):o.jsx(Dw,{})]})}),o.jsx("th",{className:"px-6 py-3 text-right text-sm font-medium text-gray-500 dark:text-gray-400",children:"الخدمات"}),o.jsx("th",{className:"px-6 py-3 text-right text-sm font-medium text-gray-500 dark:text-gray-400",children:"الموبايل"}),o.jsx("th",{className:"px-6 py-3 text-center text-sm font-medium text-gray-500 dark:text-gray-400",children:"إجراءات"})]})}),o.jsx("tbody",{className:"bg-white dark:bg-slate-900 divide-y divide-gray-200 dark:divide-slate-700",children:Ce.map(Z=>o.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-slate-800/60",children:[o.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[o.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-100 hover:text-indigo-600 cursor-pointer",onClick:()=>Re(Z),children:Z.name}),o.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400 font-mono",children:Z.code})]}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400 max-w-sm truncate",children:(Z.allServices||[]).join(", ")}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400 font-mono",children:Z.mobileNumber}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-center text-sm font-medium",children:o.jsxs("div",{className:"flex justify-center items-center gap-4",children:[o.jsx("button",{onClick:()=>hr(Z),className:"text-indigo-600 hover:text-indigo-900",title:"تعديل",children:o.jsx(Ew,{})}),o.jsx("button",{onClick:()=>Ur(Z),className:"text-red-600 hover:text-red-900",title:"حذف",children:o.jsx(Sw,{})})]})})]},Z.code))})]}),je.length===0&&o.jsx("div",{className:"text-center text-gray-500 py-10",children:"لا توجد نتائج."})]}),Be>1&&o.jsxs("nav",{className:"flex items-center justify-between border-t border-gray-200 dark:border-slate-700 bg-white dark:bg-slate-900 px-4 py-3 sm:px-6 mt-4 rounded-b-lg",children:[o.jsx("button",{onClick:()=>u(Z=>Math.max(1,Z-1)),disabled:d===1,children:"السابق"}),o.jsxs("span",{children:["صفحة ",d," من ",Be]}),o.jsx("button",{onClick:()=>u(Z=>Math.min(Be,Z+1)),disabled:d===Be,children:"التالي"})]}),g&&o.jsx(fw,{servant:b,onClose:()=>x(!1),onSave:Fe,isSubmitting:j}),p&&b&&o.jsx(cs,{title:"تأكيد الحذف",message:`هل تريد حذف "${b.name}"؟`,onConfirm:ce,onCancel:()=>k(!1),isConfirming:j,confirmButtonClass:"bg-red-600"}),I&&o.jsx(Jo,{servant:I,onClose:()=>E(null)})]});return o.jsx("div",{className:"animate-fade-in-up",children:h==="list"?ye():Oe()})},Rw=({result:e,onClose:t,onSave:r,isSubmitting:a})=>{const[s,n]=G.useState({servantCode:"",courseName:"",year:new Date().getFullYear().toString(),score:"",attendance:""}),[i,c]=G.useState({}),l=!!e;G.useEffect(()=>(document.body.style.overflow="hidden",()=>{document.body.style.overflow="unset"}),[]),G.useEffect(()=>{var h,m;e&&n({servantCode:e.servantCode||"",courseName:e.courseName||"",year:(e.year||new Date().getFullYear()).toString(),score:((h=e.score)==null?void 0:h.toString())||"",attendance:((m=e.attendance)==null?void 0:m.toString())||"0"})},[e]);const f=h=>{const{name:m,value:g}=h.target;n(x=>({...x,[m]:g})),i[m]&&c(x=>({...x,[m]:""}))},d=()=>{const h={};return s.servantCode.trim()||(h.servantCode="كود الخادم مطلوب"),s.courseName.trim()||(h.courseName="اسم الكورس مطلوب"),s.score.trim().toLowerCase()!=="غائب"&&(s.score.trim()===""||isNaN(Number(s.score)))&&(h.score='الدرجة يجب أن تكون رقمًا أو كلمة "غائب"'),(s.attendance.trim()===""||isNaN(Number(s.attendance)))&&(h.attendance="نسبة الحضور يجب أن تكون رقمًا"),(isNaN(Number(s.year))||s.year.length!==4)&&(h.year="السنة يجب أن تكون رقمًا صالحًا (مثال: 2024)"),c(h),Object.keys(h).length===0},u=h=>{if(h.preventDefault(),!d())return;const m={servantCode:s.servantCode.trim(),courseName:s.courseName.trim(),year:Number(s.year),score:s.score.trim().toLowerCase()==="غائب"?"غائب":Number(s.score),attendance:Number(s.attendance)};r(m)};return Ta.createPortal(o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50",children:o.jsxs("div",{className:"bg-white p-8 rounded-2xl shadow-xl w-full max-w-md m-4 animate-fade-in-up",role:"dialog","aria-modal":"true",children:[o.jsx("h3",{className:"text-xl font-bold text-slate-800 mb-6",children:l?"تعديل نتيجة كورس":"إضافة نتيجة كورس"}),o.jsxs("form",{onSubmit:u,noValidate:!0,children:[o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{htmlFor:"servantCode",className:"block text-sm font-medium text-gray-700",children:"كود الخادم"}),o.jsx("input",{type:"text",name:"servantCode",id:"servantCode",value:s.servantCode,onChange:f,className:`w-full mt-1 px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 ${i.servantCode?"border-red-500":"border-gray-300"}`,required:!0}),i.servantCode&&o.jsx("p",{className:"text-red-500 text-xs mt-1",children:i.servantCode})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"courseName",className:"block text-sm font-medium text-gray-700",children:"اسم الكورس"}),o.jsx("input",{type:"text",name:"courseName",id:"courseName",value:s.courseName,onChange:f,className:`w-full mt-1 px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 ${i.courseName?"border-red-500":"border-gray-300"}`,required:!0}),i.courseName&&o.jsx("p",{className:"text-red-500 text-xs mt-1",children:i.courseName})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"year",className:"block text-sm font-medium text-gray-700",children:"السنة"}),o.jsx("input",{type:"number",name:"year",id:"year",value:s.year,onChange:f,className:`w-full mt-1 px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 ${i.year?"border-red-500":"border-gray-300"}`}),i.year&&o.jsx("p",{className:"text-red-500 text-xs mt-1",children:i.year})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"score",className:"block text-sm font-medium text-gray-700",children:"الدرجة"}),o.jsx("input",{type:"text",name:"score",id:"score",placeholder:'ادخل درجة أو كلمة "غائب"',value:s.score,onChange:f,className:`w-full mt-1 px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 ${i.score?"border-red-500":"border-gray-300"}`}),i.score&&o.jsx("p",{className:"text-red-500 text-xs mt-1",children:i.score})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"attendance",className:"block text-sm font-medium text-gray-700",children:"نسبة الحضور (%)"}),o.jsx("input",{type:"number",name:"attendance",id:"attendance",value:s.attendance,onChange:f,className:`w-full mt-1 px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 ${i.attendance?"border-red-500":"border-gray-300"}`}),i.attendance&&o.jsx("p",{className:"text-red-500 text-xs mt-1",children:i.attendance})]})]}),o.jsxs("div",{className:"flex justify-end items-center gap-4 mt-8",children:[o.jsx("button",{type:"button",onClick:t,disabled:a,className:"px-5 py-2 bg-gray-100 text-slate-700 font-semibold rounded-lg hover:bg-gray-200 transition-colors disabled:opacity-50",children:"إلغاء"}),o.jsx("button",{type:"submit",disabled:a,className:"px-5 py-2 bg-indigo-600 text-white font-bold rounded-lg hover:bg-indigo-700 transition-colors disabled:bg-indigo-300 disabled:cursor-wait",children:a?"جاري الحفظ...":"حفظ"})]})]})]})}),document.body)},Mw=()=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),Di=()=>o.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-indigo-600"}),Ii=()=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.5L15.232 5.232z"})}),Oi=()=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),Pw=()=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),Bw=()=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-4-4V7a4 4 0 014-4h5l4 4v1m-4 5h-2m2 0h2m-4 5a2 2 0 104 0 2 2 0 10-4 0zM12 6v6m0 0v6m0-6h6m-6 0H6"})}),Uw=()=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-10 w-10 mx-auto text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-4-4V7a4 4 0 014-4h5l4 4v1m-4 5h-2m2 0h2m-4 5a2 2 0 104 0 2 2 0 10-4 0zM12 6v6m0 0v6m0-6h6m-6 0H6"})}),Ww=()=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-green-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),Hw=()=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-red-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"})}),Vw=()=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-16 w-16 mx-auto text-green-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),$w=()=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",viewBox:"0 0 24 24",fill:"currentColor",children:o.jsx("path",{d:"M21.16,3.16a.5.5,0,0,0-.57-.16l-18,4A.5.5,0,0,0,2.5,8v8a.5.5,0,0,0,.16.37.5.5,0,0,0,.38.13l18,4a.5.5,0,0,0,.57-.6V3.5A.5.5,0,0,0,21.16,3.16ZM11,12.1,7.26,14.28,3.5,12.5,7.1,10.59Zm8.5,3.31-3.6-1.74,3.6-1.92ZM18,7.91,14.25,10,11,8.1,14.65,6Z"})}),Fs=50,zw=()=>{const[e,t]=G.useState([]),[r,a]=G.useState(!0),[s,n]=G.useState(""),[i,c]=G.useState(""),[l,f]=G.useState(1),[d,u]=G.useState("list"),[h,m]=G.useState(!1),[g,x]=G.useState(!1),[p,k]=G.useState(null),[b,w]=G.useState(!1),[j,R]=G.useState(new Set),[I,E]=G.useState(!1),[U,N]=G.useState(!1),[B,L]=G.useState("idle"),[P,Q]=G.useState([]),[fe,ie]=G.useState(""),[pe,he]=G.useState({success:0,failed:0,total:0}),[Ve,H]=G.useState(""),{addToast:we}=os(),Ee=G.useCallback(async()=>{a(!0),n("");try{const ae=await qe.collection("servants").get(),re=new Map;ae.forEach(Oe=>{re.set(Oe.id,{code:Oe.id,...Oe.data()})});const Te=(await qe.collection("courseResults").get()).docs.map(Oe=>{const ye=Oe.data(),Z=String(ye.servantCode),ue=re.get(Z);return{...ye,servantCode:Z,id:Oe.id,servantName:(ue==null?void 0:ue.name)||"خادم غير معروف"}});t(Te.sort((Oe,ye)=>ye.year-Oe.year||Oe.servantName.localeCompare(ye.servantName)))}catch(ae){console.error("Error fetching course results:",ae),n("حدث خطأ أثناء جلب بيانات الكورسات.")}finally{a(!1)}},[]);G.useEffect(()=>{d==="list"&&Ee()},[Ee,d]);const A=()=>{k(null),m(!0)},M=ae=>{k(ae),m(!0)},D=ae=>{k(ae),x(!0)},O=async(ae,re)=>{w(!0),n("");try{if(!re&&!(await qe.collection("courseResults").where("servantCode","in",[ae.servantCode,Number(ae.servantCode)]).where("courseName","==",ae.courseName).where("year","==",ae.year).get()).empty){we("خطأ: هذا الخادم مسجل بالفعل في هذا الكورس لنفس السنة.","error"),w(!1);return}re?(await qe.collection("courseResults").doc(re).set(ae,{merge:!0}),we("تم تحديث النتيجة بنجاح.","success")):(await qe.collection("courseResults").add(ae),we("تم إضافة النتيجة بنجاح.","success")),await Ee(),m(!1),k(null)}catch(ge){console.error("Error saving result:",ge),n("فشل حفظ بيانات النتيجة."),we("فشل حفظ بيانات النتيجة.","error")}finally{w(!1)}},W=async()=>{if(p){w(!0),n("");try{await qe.collection("courseResults").doc(p.id).delete(),we("تم حذف النتيجة بنجاح.","success"),await Ee(),x(!1),k(null)}catch(ae){console.error("Error deleting result:",ae),n("فشل حذف النتيجة."),we("فشل حذف النتيجة.","error")}finally{w(!1)}}},ee=G.useMemo(()=>{if(!i.trim())return e;const ae=i.toLowerCase().trim();return e.filter(re=>re.servantName.toLowerCase().includes(ae)||String(re.servantCode).toLowerCase().includes(ae)||re.courseName.toLowerCase().includes(ae))},[e,i]),se=Math.ceil(ee.length/Fs),J=G.useMemo(()=>{const ae=(l-1)*Fs;return ee.slice(ae,ae+Fs)},[ee,l]);G.useEffect(()=>{f(1),R(new Set)},[i]),G.useEffect(()=>{const ae=Math.ceil(ee.length/Fs);ae>0&&l>ae&&f(ae)},[ee.length,l]);const q=ae=>{R(re=>{const ge=new Set(re);return ge.has(ae)?ge.delete(ae):ge.add(ae),ge})},ke=ae=>{if(ae.target.checked){const re=new Set(J.map(ge=>ge.id));R(re)}else R(new Set)},S=()=>E(!0),je=async()=>{w(!0);try{const ae=j.size,re=qe.batch();j.forEach(ge=>re.delete(qe.collection("courseResults").doc(ge))),await re.commit(),we(`تم حذف ${ae} نتائج بنجاح.`,"success"),await Ee()}catch(ae){console.error("Error bulk deleting results:",ae),n("حدث خطأ أثناء حذف النتائج المحددة."),we("فشل حذف النتائج المحددة.","error")}finally{w(!1),E(!1)}},Ce=()=>{const ae=e.filter(Te=>j.has(Te.id)),re=ar.json_to_sheet(ae.map(({servantCode:Te,servantName:Oe,courseName:ye,year:Z,score:ue,attendance:oe})=>({servantCode:Te,servantName:Oe,courseName:ye,year:Z,score:ue,attendance:oe}))),ge=ar.book_new();ar.book_append_sheet(ge,re,"Selected Results"),Mt(ge,`Selected_Results_${new Date().toISOString().split("T")[0]}.xlsx`)},Be=()=>{N(!0);try{const ae=ee.map(({servantCode:Te,servantName:Oe,courseName:ye,year:Z,score:ue,attendance:oe})=>({"كود الخادم":Te,"اسم الخادم":Oe,"اسم الكورس":ye,السنة:Z,الدرجة:ue,الحضار:typeof oe=="number"?`${Math.round(oe<=1?oe*100:oe)}%`:"-"})),re=ar.json_to_sheet(ae),ge=ar.book_new();ar.book_append_sheet(ge,re,"All Results"),Mt(ge,`All_Course_Results_${new Date().toISOString().split("T")[0]}.xlsx`)}catch(ae){console.error("Error exporting all results:",ae),we("حدث خطأ أثناء تصدير البيانات.","error")}finally{N(!1)}},Fe=J.length>0&&J.every(ae=>j.has(ae.id)),ce=P.filter(ae=>ae.errors.length===0),Ye=P.filter(ae=>ae.errors.length>0),hr=async ae=>{var ge;const re=(ge=ae.target.files)==null?void 0:ge[0];if(re){L("preview"),ie(re.name),H(""),Q([]);try{const Te=await re.arrayBuffer(),Oe=ns(Te),ye=Oe.SheetNames[0],Z=Oe.Sheets[ye],oe=ar.sheet_to_json(Z,{defval:null}).map(Pe=>{const tr=[];(!Pe.servantCode||String(Pe.servantCode).trim()==="")&&tr.push("كود الخادم مطلوب"),(!Pe.courseName||String(Pe.courseName).trim()==="")&&tr.push("اسم الكورس مطلوب"),Pe.score!=="غائب"&&(Pe.score===null||isNaN(Number(Pe.score)))&&tr.push('الدرجة يجب أن تكون رقمًا أو "غائب"'),(Pe.attendance===null||isNaN(Number(Pe.attendance)))&&tr.push("نسبة الحضور مطلوبة ويجب أن تكون رقمًا");const lt=String(Pe.score).trim().toLowerCase()==="غائب"?"غائب":Number(Pe.score);return{result:{servantCode:String(Pe.servantCode).trim(),courseName:String(Pe.courseName).trim(),year:Number(Pe.year)||new Date().getFullYear(),score:lt,attendance:Number(Pe.attendance)},errors:tr}}),be=new Map;for(const Pe of oe){if(Pe.errors.length>0){be.set(Math.random().toString(),Pe);continue}const{servantCode:tr,courseName:lt,year:Et,score:Er}=Pe.result,ft=`${tr}|${lt}|${Et}`,dt=be.get(ft);if(!dt)be.set(ft,Pe);else{const pt=dt.result.score==="غائب"?-1:dt.result.score;(Er==="غائب"?-1:Er)>pt&&be.set(ft,Pe)}}const De=Array.from(be.values());Q(De)}catch(Te){console.error(Te),H("حدث خطأ أثناء قراءة الملف. تأكد من أنه ملف Excel صالح."),we("حدث خطأ أثناء قراءة الملف.","error"),L("idle")}finally{ae.target.value=""}}},Re=()=>{const ae=[{servantCode:"12345",courseName:"كورس مجتمع يسوع",year:2024,score:95,attendance:100}],re=ar.json_to_sheet(ae),ge=ar.book_new();ar.book_append_sheet(ge,re,"Results"),Mt(ge,"Course_Results_Template.xlsx")},Ur=async()=>{L("importing");const ae=new Map;e.forEach(Z=>{const ue=`${Z.servantCode}|${Z.courseName}|${Z.year}`,oe=ae.get(ue);if(oe){const be=oe.score==="غائب"?-1:Number(oe.score);(Z.score==="غائب"?-1:Number(Z.score))>be&&ae.set(ue,{id:Z.id,score:Z.score})}else ae.set(ue,{id:Z.id,score:Z.score})});const re=[],ge=[],Te=[];ce.forEach(Z=>{const{result:ue}=Z,oe=`${ue.servantCode}|${ue.courseName}|${ue.year}`,be=ae.get(oe);if(be){const De=be.score==="غائب"?-1:Number(be.score);(ue.score==="غائب"?-1:Number(ue.score))>De?ge.push({id:be.id,data:ue}):Te.push(ue)}else re.push(ue)});let Oe=0;const ye=re.length+ge.length;he({success:0,failed:0,total:ye});try{const Z=[...re.map(oe=>({type:"add",data:oe})),...ge.map(oe=>({type:"update",id:oe.id,data:oe.data}))];for(let oe=0;oe<Z.length;oe+=500){const be=Z.slice(oe,oe+500),De=qe.batch();be.forEach(Pe=>{if(Pe.type==="add"){const tr=qe.collection("courseResults").doc();De.set(tr,Pe.data)}else if(Pe.type==="update"){const tr=qe.collection("courseResults").doc(Pe.id);De.set(tr,Pe.data,{merge:!0})}}),await De.commit(),Oe+=be.length,he(Pe=>({...Pe,success:Oe}))}L("complete");let ue="اكتمل الاستيراد! ";re.length>0&&(ue+=`تم إضافة ${re.length} نتيجة جديدة. `),ge.length>0&&(ue+=`تم تحديث ${ge.length} نتيجة. `),Te.length>0&&(ue+=`تم تخطي ${Te.length} نتيجة (الدرجة الحالية أعلى).`),we(ue.trim(),"success"),Ee()}catch(Z){console.error("Error during import:",Z),n("حدث خطأ فادح أثناء عملية الاستيراد."),we("حدث خطأ أثناء الاستيراد.","error"),L("preview")}},Kr=()=>{L("idle"),Q([]),ie(""),H(""),he({success:0,failed:0,total:0}),u("list")},$r=()=>o.jsxs("div",{className:"bg-white dark:bg-slate-800 p-6 md:p-8 rounded-lg shadow-sm border border-gray-200/80 dark:border-slate-700",children:[o.jsxs("header",{className:"flex justify-between items-center mb-8",children:[o.jsxs("div",{children:[o.jsx("h2",{className:"text-2xl font-bold text-slate-800 dark:text-slate-100",children:"استيراد نتائج الكورسات"}),o.jsx("p",{className:"text-slate-500 dark:text-slate-400",children:"أضف النتائج بشكل جماعي عن طريق رفع ملف Excel."})]}),o.jsx("button",{onClick:Kr,className:"px-5 py-2 bg-gray-100 dark:bg-slate-700 text-slate-700 dark:text-slate-200 font-semibold rounded-lg hover:bg-gray-200 dark:hover:bg-slate-600",children:"العودة للقائمة"})]}),Ve&&o.jsx("div",{className:"mb-4 text-center text-red-600 bg-red-100 dark:bg-red-900/20 dark:text-red-400 p-3 rounded-lg",children:Ve}),B==="idle"&&o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8 items-center",children:[o.jsxs("div",{children:[o.jsx("h3",{className:"font-semibold text-lg text-slate-700 dark:text-slate-200 mb-3",children:"الخطوات"}),o.jsxs("ol",{className:"list-decimal list-inside space-y-3 text-slate-600 dark:text-slate-300",children:[o.jsxs("li",{children:[o.jsx("strong",{className:"font-semibold",children:"تنزيل القالب:"})," قم بتحميل ملف Excel لضمان تطابق الأعمدة."]}),o.jsxs("li",{children:[o.jsx("strong",{className:"font-semibold",children:"ملء البيانات:"})," املأ القالب ببيانات النتائج."]}),o.jsxs("li",{children:[o.jsx("strong",{className:"font-semibold",children:"رفع الملف:"})," اختر الملف المعبأ لبدء عملية الاستيراد."]})]}),o.jsx("button",{onClick:Re,className:"mt-6 px-4 py-2 bg-green-600 text-white font-semibold rounded-lg hover:bg-green-700 transition",children:"تنزيل القالب"})]}),o.jsx("div",{className:"border-2 border-dashed border-gray-300 dark:border-slate-600 rounded-lg p-8 text-center",children:o.jsxs("label",{htmlFor:"file-upload",className:"cursor-pointer",children:[o.jsx(Uw,{}),o.jsx("p",{className:"mt-2 text-indigo-600 dark:text-indigo-400 font-semibold",children:"اختر ملفاً"}),o.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"XLSX, XLS, CSV"}),o.jsx("input",{id:"file-upload",type:"file",className:"hidden",onChange:hr,accept:".xlsx, .xls, .csv"})]})})]}),B==="preview"&&o.jsxs("div",{children:[o.jsxs("h3",{className:"font-semibold text-lg text-slate-700 dark:text-slate-200 mb-4",children:["معاينة البيانات من: ",o.jsx("span",{className:"font-normal text-indigo-600",children:fe})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6",children:[o.jsxs("div",{className:"bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-700 p-4 rounded-lg text-center",children:[o.jsx("p",{className:"text-2xl font-bold text-green-700 dark:text-green-300",children:ce.length}),o.jsx("p",{className:"text-sm font-medium text-green-600 dark:text-green-400",children:"نتيجة صالحة للاستيراد"})]}),o.jsxs("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-700 p-4 rounded-lg text-center",children:[o.jsx("p",{className:"text-2xl font-bold text-red-700 dark:text-red-300",children:Ye.length}),o.jsx("p",{className:"text-sm font-medium text-red-600 dark:text-red-400",children:"نتيجة تحتوي على أخطاء"})]})]}),o.jsx("div",{className:"max-h-80 overflow-y-auto border dark:border-slate-600 rounded-lg",children:o.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-slate-600 text-sm",children:[o.jsx("thead",{className:"bg-gray-50 dark:bg-slate-700 sticky top-0",children:o.jsxs("tr",{className:"text-right",children:[o.jsx("th",{className:"px-4 py-2 font-medium text-gray-500 dark:text-gray-300",children:"الحالة"}),o.jsx("th",{className:"px-4 py-2 font-medium text-gray-500 dark:text-gray-300",children:"كود الخادم"}),o.jsx("th",{className:"px-4 py-2 font-medium text-gray-500 dark:text-gray-300",children:"اسم الكورس"}),o.jsx("th",{className:"px-4 py-2 font-medium text-gray-500 dark:text-gray-300",children:"الدرجة"}),o.jsx("th",{className:"px-4 py-2 font-medium text-gray-500 dark:text-gray-300",children:"الأخطاء"})]})}),o.jsx("tbody",{className:"bg-white dark:bg-slate-800 divide-y divide-gray-200 dark:divide-slate-600",children:P.slice(0,10).map(({result:ae,errors:re},ge)=>o.jsxs("tr",{className:re.length>0?"bg-red-50 dark:bg-red-900/20":"bg-green-50 dark:bg-green-900/20",children:[o.jsx("td",{className:"px-4 py-2",children:re.length>0?o.jsx(Hw,{}):o.jsx(Ww,{})}),o.jsx("td",{className:"px-4 py-2 font-mono text-slate-800 dark:text-slate-200",children:ae.servantCode}),o.jsx("td",{className:"px-4 py-2 text-slate-800 dark:text-slate-200",children:ae.courseName}),o.jsx("td",{className:"px-4 py-2 text-slate-800 dark:text-slate-200",children:ae.score}),o.jsx("td",{className:"px-4 py-2 text-red-600 dark:text-red-400",children:re.join(", ")})]},ge))})]})}),P.length>10&&o.jsxs("p",{className:"text-center text-sm text-gray-500 dark:text-gray-400 mt-2",children:["... و ",P.length-10," نتائج أخرى."]}),o.jsxs("div",{className:"mt-6 flex justify-end gap-4",children:[o.jsx("button",{onClick:Kr,className:"px-5 py-2 bg-gray-100 dark:bg-slate-700 text-slate-700 dark:text-slate-200 font-semibold rounded-lg hover:bg-gray-200 dark:hover:bg-slate-600",children:"إلغاء"}),o.jsxs("button",{onClick:Ur,disabled:ce.length===0,className:"px-5 py-2 bg-indigo-600 text-white font-bold rounded-lg hover:bg-indigo-700 disabled:bg-indigo-300",children:["بدء الاستيراد (",ce.length,")"]})]})]}),B==="importing"&&o.jsxs("div",{className:"text-center py-12",children:[o.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-indigo-600 mx-auto"}),o.jsx("h3",{className:"text-xl font-semibold text-slate-700 dark:text-slate-200 mt-6",children:"جاري الاستيراد..."}),o.jsxs("p",{className:"text-slate-500 dark:text-slate-400 mt-2",children:["تم استيراد ",pe.success," من ",pe.total," نتيجة."]})]}),B==="complete"&&o.jsxs("div",{className:"text-center py-12",children:[o.jsx(Vw,{}),o.jsx("h3",{className:"text-2xl font-bold text-green-700 dark:text-green-400 mt-4",children:"اكتمل الاستيراد بنجاح!"}),o.jsxs("p",{className:"text-slate-600 dark:text-slate-300 mt-2",children:["تمت معالجة ",pe.success," نتيجة."]}),o.jsx("button",{onClick:Kr,className:"mt-6 px-6 py-2 bg-indigo-600 text-white font-semibold rounded-lg hover:bg-indigo-700",children:"استيراد ملف آخر"})]})]}),cr=()=>o.jsxs(o.Fragment,{children:[o.jsxs("header",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-8 gap-4",children:[o.jsxs("div",{children:[o.jsxs("h2",{className:"text-xl font-bold text-slate-800 dark:text-slate-100",children:["إدارة نتائج الكورسات (",e.length,")"]}),o.jsx("p",{className:"text-slate-500 dark:text-slate-400 mt-1",children:"عرض وإدارة جميع نتائج الكورسات المسجلة للخدام."})]}),o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsxs("button",{onClick:()=>u("import"),className:"flex items-center justify-center px-4 py-2 bg-green-600 text-white font-semibold rounded-lg hover:bg-green-700 transition-transform transform hover:scale-105",children:[o.jsx(Bw,{})," استيراد النتائج من Excel"]}),o.jsxs("button",{onClick:A,className:"flex items-center px-4 py-2 bg-indigo-600 text-white font-bold rounded-lg hover:bg-indigo-700 transition-transform transform hover:scale-105",children:[o.jsx(Pw,{})," إضافة نتيجة يدوياً"]})]})]}),s&&o.jsx("p",{className:"mb-4 text-center text-red-600 bg-red-100 p-3 rounded-lg",children:s}),o.jsxs("div",{className:"mb-4 flex flex-col sm:flex-row gap-4 justify-between",children:[o.jsxs("div",{className:"relative",children:[o.jsx("input",{type:"text",placeholder:"ابحث باسم الخادم أو الكود أو اسم الكورس...",value:i,onChange:ae=>c(ae.target.value),className:"w-full sm:max-w-md px-4 py-2 pr-10 text-gray-700 bg-white dark:bg-slate-800 border border-gray-300 dark:border-slate-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 dark:text-gray-200"}),o.jsx("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none",children:o.jsx(Mw,{})})]}),o.jsxs("button",{onClick:Be,disabled:U,className:"flex items-center justify-center px-4 py-2 bg-green-100 text-green-800 font-semibold rounded-lg hover:bg-green-200 transition-colors dark:bg-green-900/30 dark:text-green-300 dark:hover:bg-green-900/50 disabled:opacity-50 disabled:cursor-wait",children:[o.jsx($w,{})," ",U?"جاري التصدير...":"تصدير الكل (Excel)"]})]}),o.jsxs("div",{className:"hidden md:block overflow-x-auto border border-gray-200 dark:border-slate-700 rounded-lg shadow-sm",children:[j.size>0&&o.jsxs("div",{className:"p-4 bg-indigo-50 dark:bg-slate-800 border-b border-gray-200 dark:border-slate-700 flex justify-between items-center",children:[o.jsxs("p",{className:"font-semibold text-sm text-indigo-800 dark:text-indigo-200",children:[j.size," نتائج محددة"]}),o.jsxs("div",{className:"flex gap-2",children:[o.jsx("button",{onClick:Ce,className:"px-3 py-1.5 text-sm bg-green-600 text-white font-semibold rounded-md hover:bg-green-700 transition-colors",children:"تصدير المحدد"}),o.jsx("button",{onClick:S,className:"px-3 py-1.5 text-sm bg-red-600 text-white font-semibold rounded-md hover:bg-red-700 transition-colors",children:"حذف المحدد"})]})]}),o.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-slate-700",children:[o.jsx("thead",{className:"bg-slate-100 dark:bg-slate-800",children:o.jsxs("tr",{children:[o.jsx("th",{scope:"col",className:"p-4",children:o.jsx("input",{type:"checkbox",className:"h-4 w-4 text-indigo-600 border-gray-300 rounded focus:ring-indigo-500",checked:Fe,onChange:ke})}),o.jsx("th",{className:"px-6 py-3 text-right text-sm font-medium text-gray-500 dark:text-gray-400 uppercase",children:"اسم الخادم"}),o.jsx("th",{className:"px-6 py-3 text-right text-sm font-medium text-gray-500 dark:text-gray-400 uppercase",children:"الكورس"}),o.jsx("th",{className:"px-6 py-3 text-right text-sm font-medium text-gray-500 dark:text-gray-400 uppercase",children:"الدرجة"}),o.jsx("th",{className:"px-6 py-3 text-right text-sm font-medium text-gray-500 dark:text-gray-400 uppercase",children:"الحضور"}),o.jsx("th",{className:"px-6 py-3 text-center text-sm font-medium text-gray-500 dark:text-gray-400 uppercase",children:"إجراءات"})]})}),o.jsx("tbody",{className:"bg-white dark:bg-slate-900 divide-y divide-gray-200 dark:divide-slate-700",children:J.map(ae=>{const re=j.has(ae.id),ge=typeof ae.attendance=="number"?ae.attendance<=1?ae.attendance*100:ae.attendance:0;return o.jsxs("tr",{className:`transition-colors ${re?"bg-indigo-50 dark:bg-indigo-900/20":"hover:bg-gray-50 dark:hover:bg-slate-800/60"}`,children:[o.jsx("td",{className:"p-4",children:o.jsx("input",{type:"checkbox",className:"h-4 w-4 text-indigo-600 border-gray-300 rounded focus:ring-indigo-500",checked:re,onChange:()=>q(ae.id)})}),o.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-gray-100",children:[ae.servantName," ",o.jsxs("span",{className:"font-mono text-gray-400 dark:text-gray-500",children:["(",ae.servantCode,")"]})]}),o.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:[ae.courseName," (",ae.year,")"]}),o.jsx("td",{className:`px-6 py-4 whitespace-nowrap text-sm font-semibold ${ae.score==="غائب"?"text-red-500":"text-gray-800 dark:text-gray-200"}`,children:ae.score}),o.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:[Math.round(ge),"%"]}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-center text-sm font-medium",children:o.jsxs("div",{className:"flex justify-center items-center gap-4",children:[o.jsx("button",{onClick:()=>M(ae),className:"text-indigo-600 hover:text-indigo-900 dark:text-indigo-400 dark:hover:text-indigo-300",title:"تعديل",children:o.jsx(Ii,{})}),o.jsx("button",{onClick:()=>D(ae),className:"text-red-600 hover:text-red-900 dark:text-red-400 dark:hover:text-red-300",title:"حذف",children:o.jsx(Oi,{})})]})})]},ae.id)})})]}),ee.length===0&&o.jsx("div",{className:"text-center text-gray-500 py-10",children:r?o.jsx(Di,{}):"لا توجد نتائج تطابق بحثك."})]}),o.jsxs("div",{className:"md:hidden space-y-4",children:[J.length>0&&o.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center gap-4 mb-4",children:[o.jsxs("label",{className:"flex items-center gap-2 text-sm w-full",children:[o.jsx("input",{type:"checkbox",className:"h-4 w-4 text-indigo-600 border-gray-300 rounded focus:ring-indigo-500",onChange:ke,checked:Fe}),o.jsx("span",{className:"text-slate-700 dark:text-slate-200",children:"تحديد الكل"})]}),j.size>0&&o.jsxs("div",{className:"flex gap-2 w-full justify-end",children:[o.jsx("button",{onClick:Ce,className:"px-3 py-1.5 text-xs bg-green-600 text-white font-semibold rounded-md hover:bg-green-700",children:"تصدير"}),o.jsx("button",{onClick:S,className:"px-3 py-1.5 text-xs bg-red-600 text-white font-semibold rounded-md hover:bg-red-700",children:"حذف"})]})]}),J.map(ae=>{const re=j.has(ae.id),ge=typeof ae.attendance=="number"?ae.attendance<=1?ae.attendance*100:ae.attendance:0;return o.jsxs("div",{className:`p-4 border dark:border-slate-700 rounded-lg transition-colors ${re?"bg-indigo-50 dark:bg-indigo-900/20 border-indigo-200 dark:border-indigo-700":"bg-white dark:bg-slate-800 border-gray-200"}`,children:[o.jsxs("div",{className:"flex items-start justify-between gap-4",children:[o.jsxs("div",{className:"flex items-start gap-3 flex-grow",children:[o.jsx("input",{type:"checkbox",className:"h-4 w-4 mt-1 text-indigo-600 border-gray-300 rounded focus:ring-indigo-500",checked:re,onChange:()=>q(ae.id)}),o.jsxs("div",{className:"flex-grow",children:[o.jsxs("p",{className:"font-bold text-gray-800 dark:text-gray-100",children:[ae.servantName," ",o.jsxs("span",{className:"font-mono text-gray-400 dark:text-gray-500",children:["(",ae.servantCode,")"]})]}),o.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:[ae.courseName," (",ae.year,")"]})]})]}),o.jsxs("div",{className:"flex items-center gap-1 flex-shrink-0",children:[o.jsx("button",{onClick:()=>M(ae),className:"text-indigo-600 hover:text-indigo-900 dark:text-indigo-400 dark:hover:text-indigo-300 p-2",title:"تعديل",children:o.jsx(Ii,{})}),o.jsx("button",{onClick:()=>D(ae),className:"text-red-600 hover:text-red-900 dark:text-red-400 dark:hover:text-red-300 p-2",title:"حذف",children:o.jsx(Oi,{})})]})]}),o.jsxs("div",{className:"mt-3 pt-3 border-t border-gray-100 dark:border-slate-700 flex justify-between text-sm",children:[o.jsxs("p",{children:[o.jsx("strong",{children:"الدرجة:"})," ",o.jsx("span",{className:`font-semibold ${ae.score==="غائب"?"text-red-500":"text-gray-800 dark:text-gray-200"}`,children:ae.score})]}),o.jsxs("p",{children:[o.jsx("strong",{children:"الحضور:"})," ",o.jsxs("span",{className:"font-semibold text-gray-800 dark:text-gray-200",children:[Math.round(ge),"%"]})]})]})]},ae.id)})]}),se>1&&o.jsx("nav",{className:"flex items-center justify-between border-t border-gray-200 dark:border-slate-700 bg-white dark:bg-slate-900 px-4 py-3 sm:px-6 mt-4 rounded-b-lg",children:o.jsxs("div",{className:"flex flex-1 justify-between sm:justify-end gap-2",children:[o.jsx("button",{onClick:()=>f(ae=>Math.max(1,ae-1)),disabled:l===1,className:"relative inline-flex items-center rounded-md border border-gray-300 dark:border-slate-600 bg-white dark:bg-slate-800 px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-slate-700 disabled:opacity-50 disabled:cursor-not-allowed",children:"السابق"}),o.jsxs("span",{className:"text-sm text-gray-700 dark:text-gray-300 flex items-center",children:["صفحة ",o.jsx("strong",{className:"font-semibold mx-1",children:l})," من ",o.jsx("strong",{className:"font-semibold mx-1",children:se})]}),o.jsx("button",{onClick:()=>f(ae=>Math.min(se,ae+1)),disabled:l===se,className:"relative ml-3 inline-flex items-center rounded-md border border-gray-300 dark:border-slate-600 bg-white dark:bg-slate-800 px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-slate-700 disabled:opacity-50 disabled:cursor-not-allowed",children:"التالي"})]})}),h&&o.jsx(Rw,{result:p,onClose:()=>m(!1),onSave:ae=>O(ae,p==null?void 0:p.id),isSubmitting:b}),g&&p&&o.jsx(cs,{title:"تأكيد الحذف",message:`هل أنت متأكد من حذف نتيجة كورس "${p.courseName}" للخادم "${p.servantName}"؟`,onConfirm:W,onCancel:()=>x(!1),isConfirming:b,confirmText:"نعم، احذف",confirmButtonClass:"bg-red-600 hover:bg-red-700"}),I&&o.jsx(cs,{title:`تأكيد حذف ${j.size} نتائج`,message:"هل أنت متأكد من رغبتك في حذف النتائج المحددة؟ لا يمكن التراجع عن هذا الإجراء.",onConfirm:je,onCancel:()=>E(!1),isConfirming:b,confirmText:"نعم، احذف المحدد",confirmButtonClass:"bg-red-600 hover:bg-red-700"})]});return r&&e.length===0&&d==="list"?o.jsx("div",{className:"flex justify-center items-center py-20",children:o.jsx(Di,{})}):o.jsx("div",{className:"animate-fade-in-up",children:d==="list"?cr():$r()})},Gw=[{key:"spiritualLife",label:"الحياة الروحية"},{key:"commitment",label:"الالتزام والمواظبة"},{key:"preparationAndDelivery",label:"التحضير والأداء"},{key:"relationshipWithPeers",label:"العلاقة بالخدام"},{key:"relationshipWithCongregation",label:"العلاقة بالمخدومين"},{key:"personalGrowth",label:"النمو الشخصي والتطوير"}],Xw=({evaluation:e,onClose:t,onSave:r,isSubmitting:a})=>{const[s,n]=G.useState({servantCode:"",serviceName:"",year:new Date().getFullYear().toString(),scores:{spiritualLife:75,commitment:75,preparationAndDelivery:75,relationshipWithPeers:75,relationshipWithCongregation:75,personalGrowth:75},generalNotes:"",evaluatorName:""}),[i,c]=G.useState({}),l=!!e,f=G.useMemo(()=>{const g=Object.values(s.scores).reduce((x,p)=>x+Number(p),0);return Math.round(g/Object.keys(s.scores).length)},[s.scores]);G.useEffect(()=>(document.body.style.overflow="hidden",()=>{document.body.style.overflow="unset"}),[]),G.useEffect(()=>{e&&n({servantCode:e.servantCode||"",serviceName:e.serviceName||"",year:(e.year||new Date().getFullYear()).toString(),scores:e.scores,generalNotes:e.generalNotes||"",evaluatorName:e.evaluatorName||""})},[e]);const d=g=>{const{name:x,value:p}=g.target;n(k=>({...k,[x]:p})),i[x]&&c(k=>({...k,[x]:""}))},u=(g,x)=>{n(p=>({...p,scores:{...p.scores,[g]:x}}))},h=()=>{const g={};return s.servantCode.trim()||(g.servantCode="كود الخادم مطلوب"),s.serviceName.trim()||(g.serviceName="اسم الخدمة مطلوب"),s.evaluatorName.trim()||(g.evaluatorName="اسم المُقيِّم مطلوب"),(isNaN(Number(s.year))||s.year.length!==4)&&(g.year="السنة غير صالحة"),c(g),Object.keys(g).length===0},m=g=>{if(g.preventDefault(),!h())return;const x={servantCode:s.servantCode.trim(),serviceName:s.serviceName.trim(),year:Number(s.year),scores:s.scores,overallAverage:f,generalNotes:s.generalNotes.trim(),evaluatorName:s.evaluatorName.trim()};r(x,e==null?void 0:e.id)};return Ta.createPortal(o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50",children:o.jsxs("div",{className:"bg-white p-8 rounded-2xl shadow-xl w-full max-w-2xl m-4 animate-fade-in-up max-h-[90vh] flex flex-col",role:"dialog","aria-modal":"true",children:[o.jsx("h3",{className:"text-xl font-bold text-slate-800 mb-6 flex-shrink-0",children:l?"تعديل تقييم الخدمة":"إضافة تقييم جديد"}),o.jsxs("form",{onSubmit:m,noValidate:!0,className:"flex-grow overflow-y-auto pr-2",children:[o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{htmlFor:"servantCode",className:"block text-sm font-medium text-gray-700",children:"كود الخادم"}),o.jsx("input",{type:"text",name:"servantCode",id:"servantCode",value:s.servantCode,onChange:d,className:`w-full mt-1 px-3 py-2 border rounded-md shadow-sm ${i.servantCode?"border-red-500":"border-gray-300"}`,required:!0}),i.servantCode&&o.jsx("p",{className:"text-red-500 text-xs mt-1",children:i.servantCode})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"serviceName",className:"block text-sm font-medium text-gray-700",children:"اسم الخدمة"}),o.jsx("input",{type:"text",name:"serviceName",id:"serviceName",value:s.serviceName,onChange:d,className:`w-full mt-1 px-3 py-2 border rounded-md shadow-sm ${i.serviceName?"border-red-500":"border-gray-300"}`,required:!0}),i.serviceName&&o.jsx("p",{className:"text-red-500 text-xs mt-1",children:i.serviceName})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"year",className:"block text-sm font-medium text-gray-700",children:"سنة التقييم"}),o.jsx("input",{type:"number",name:"year",id:"year",value:s.year,onChange:d,className:`w-full mt-1 px-3 py-2 border rounded-md shadow-sm ${i.year?"border-red-500":"border-gray-300"}`}),i.year&&o.jsx("p",{className:"text-red-500 text-xs mt-1",children:i.year})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"evaluatorName",className:"block text-sm font-medium text-gray-700",children:"اسم المُقيِّم"}),o.jsx("input",{type:"text",name:"evaluatorName",id:"evaluatorName",value:s.evaluatorName,onChange:d,className:`w-full mt-1 px-3 py-2 border rounded-md shadow-sm ${i.evaluatorName?"border-red-500":"border-gray-300"}`,required:!0}),i.evaluatorName&&o.jsx("p",{className:"text-red-500 text-xs mt-1",children:i.evaluatorName})]})]}),o.jsxs("div",{className:"mt-6 pt-4 border-t",children:[o.jsxs("div",{className:"flex justify-between items-center mb-4",children:[o.jsx("h4",{className:"text-lg font-semibold text-slate-700",children:"محاور التقييم"}),o.jsxs("div",{className:"text-center",children:[o.jsx("p",{className:"text-sm font-medium text-gray-500",children:"المتوسط العام"}),o.jsxs("p",{className:"text-2xl font-bold text-indigo-600",children:[f,"%"]})]})]}),o.jsx("div",{className:"space-y-4",children:Gw.map(({key:g,label:x})=>o.jsxs("div",{children:[o.jsxs("label",{htmlFor:g,className:"flex justify-between items-center text-sm font-medium text-gray-700 mb-1",children:[o.jsx("span",{children:x}),o.jsxs("span",{className:"font-mono text-indigo-600 text-xs font-bold",children:[s.scores[g],"%"]})]}),o.jsx("input",{id:g,type:"range",min:"0",max:"100",value:s.scores[g],onChange:p=>u(g,parseInt(p.target.value,10)),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"})]},g))})]}),o.jsxs("div",{className:"mt-6",children:[o.jsx("label",{htmlFor:"generalNotes",className:"block text-sm font-medium text-gray-700",children:"ملاحظات عامة"}),o.jsx("textarea",{name:"generalNotes",id:"generalNotes",rows:3,value:s.generalNotes,onChange:d,className:"w-full mt-1 px-3 py-2 border border-gray-300 rounded-md shadow-sm"})]})]}),o.jsxs("div",{className:"flex justify-end items-center gap-4 mt-8 flex-shrink-0",children:[o.jsx("button",{type:"button",onClick:t,disabled:a,className:"px-5 py-2 bg-gray-100 text-slate-700 font-semibold rounded-lg hover:bg-gray-200 transition-colors disabled:opacity-50",children:"إلغاء"}),o.jsx("button",{type:"button",onClick:m,disabled:a,className:"px-5 py-2 bg-indigo-600 text-white font-bold rounded-lg hover:bg-indigo-700 transition-colors disabled:bg-indigo-300 disabled:cursor-wait",children:a?"جاري الحفظ...":"حفظ"})]})]})}),document.body)},Kw=()=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),Yw=()=>o.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-indigo-600"}),Jw=()=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.5L15.232 5.232z"})}),qw=()=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),Zw=()=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),Qw=()=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-4-4V7a4 4 0 014-4h5l4 4v1m-4 5h-2m2 0h2m-4 5a2 2 0 104 0 2 2 0 10-4 0zM12 6v6m0 0v6m0-6h6m-6 0H6"})}),ek=()=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-10 w-10 mx-auto text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-4-4V7a4 4 0 014-4h5l4 4v1m-4 5h-2m2 0h2m-4 5a2 2 0 104 0 2 2 0 10-4 0zM12 6v6m0 0v6m0-6h6m-6 0H6"})}),rk=()=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-16 w-16 mx-auto text-green-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),tk=()=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",viewBox:"0 0 24 24",fill:"currentColor",children:o.jsx("path",{d:"M21.16,3.16a.5.5,0,0,0-.57-.16l-18,4A.5.5,0,0,0,2.5,8v8a.5.5,0,0,0,.16.37.5.5,0,0,0,.38.13l18,4a.5.5,0,0,0,.57-.6V3.5A.5.5,0,0,0,21.16,3.16ZM11,12.1,7.26,14.28,3.5,12.5,7.1,10.59Zm8.5,3.31-3.6-1.74,3.6-1.92ZM18,7.91,14.25,10,11,8.1,14.65,6Z"})}),yn=[{key:"spiritualLife",label:"الحياة الروحية"},{key:"commitment",label:"الالتزام والمواظبة"},{key:"preparationAndDelivery",label:"التحضير والأداء"},{key:"relationshipWithPeers",label:"العلاقة بالخدام"},{key:"relationshipWithCongregation",label:"العلاقة بالمخدومين"},{key:"personalGrowth",label:"النمو الشخصي والتطوير"}],ak=()=>{const[e,t]=G.useState([]),[r,a]=G.useState(!0),[s,n]=G.useState(""),[i,c]=G.useState(""),[l,f]=G.useState("list"),[d,u]=G.useState(!1),[h,m]=G.useState(!1),[g,x]=G.useState(null),[p,k]=G.useState(!1),[b,w]=G.useState("idle"),[j,R]=G.useState([]),[I,E]=G.useState(""),[U,N]=G.useState({success:0,failed:0,total:0}),[B,L]=G.useState(""),[P,Q]=G.useState(!1),{addToast:fe}=os(),ie=G.useCallback(async()=>{a(!0),n("");try{const W=await qe.collection("servants").get(),ee=new Map;W.forEach(q=>{ee.set(q.id,{code:q.id,...q.data()})});const J=(await qe.collection("evaluations").get()).docs.map(q=>{const ke=q.data(),S=String(ke.servantCode),je=ee.get(S);return{...ke,id:q.id,servantName:(je==null?void 0:je.name)||"خادم غير معروف"}});t(J.sort((q,ke)=>ke.year-q.year||q.servantName.localeCompare(ke.servantName)))}catch(W){console.error("Error fetching evaluations:",W),n("حدث خطأ أثناء جلب بيانات التقييمات.")}finally{a(!1)}},[]);G.useEffect(()=>{l==="list"&&ie()},[ie,l]);const pe=async(W,ee)=>{k(!0);try{ee?(await qe.collection("evaluations").doc(ee).set(W,{merge:!0}),fe("تم تحديث التقييم بنجاح.","success")):(await qe.collection("evaluations").add(W),fe("تم إضافة التقييم بنجاح.","success")),ie(),u(!1)}catch{fe("فشل حفظ بيانات التقييم.","error")}finally{k(!1)}},he=async()=>{if(g){k(!0);try{await qe.collection("evaluations").doc(g.id).delete(),fe("تم حذف التقييم بنجاح.","success"),ie(),m(!1)}catch{fe("فشل حذف التقييم.","error")}finally{k(!1)}}},Ve=()=>{Q(!0);try{const W=A.map(J=>({"كود الخادم":J.servantCode,"اسم الخادم":J.servantName,الخدمة:J.serviceName,السنة:J.year,المُقيِّم:J.evaluatorName,...Object.fromEntries(yn.map(q=>[q.label,J.scores[q.key]])),"المتوسط العام":J.overallAverage,ملاحظات:J.generalNotes})),ee=ar.json_to_sheet(W),se=ar.book_new();ar.book_append_sheet(se,ee,"All Evaluations"),Mt(se,`All_Evaluations_${new Date().toISOString().split("T")[0]}.xlsx`)}catch{fe("حدث خطأ أثناء تصدير البيانات.","error")}finally{Q(!1)}},H=async W=>{var se;const ee=(se=W.target.files)==null?void 0:se[0];if(ee){w("preview"),E(ee.name),L("");try{const J=await ee.arrayBuffer(),q=ns(J),ke=q.Sheets[q.SheetNames[0]],je=ar.sheet_to_json(ke,{defval:null}).map(Ce=>{const Be=[],Fe={};let ce=0,Ye=0;return yn.forEach(hr=>{const Re=Ce[hr.label];Re===null||isNaN(Number(Re))||Number(Re)<0||Number(Re)>100?Be.push(`قيمة "${hr.label}" غير صالحة`):(Fe[hr.key]=Number(Re),ce+=Number(Re),Ye++)}),Ce["كود الخادم"]||Be.push("كود الخادم مطلوب"),Ce.الخدمة||Be.push("اسم الخدمة مطلوب"),{evaluation:{servantCode:String(Ce["كود الخادم"]||"").trim(),serviceName:String(Ce.الخدمة||"").trim(),year:Number(Ce.السنة)||new Date().getFullYear(),evaluatorName:String(Ce.المُقيِّم||"").trim(),scores:Fe,overallAverage:Ye>0?Math.round(ce/Ye):0,generalNotes:String(Ce.ملاحظات||"").trim()},errors:Be}});R(je)}catch{L("حدث خطأ أثناء قراءة الملف."),fe("حدث خطأ أثناء قراءة الملف.","error"),w("idle")}finally{W.target.value=""}}},we=()=>{const W=[{"كود الخادم":"12345",الخدمة:"خدمة ابتدائي",السنة:2024,المُقيِّم:"أمين الخدمة",...Object.fromEntries(yn.map(J=>[J.label,80])),ملاحظات:"خادم ممتاز وملتزم"}],ee=ar.json_to_sheet(W),se=ar.book_new();ar.book_append_sheet(se,ee,"Evaluations"),Mt(se,"Evaluations_Import_Template.xlsx")},Ee=async()=>{w("importing");const W=j.filter(ke=>ke.errors.length===0);N({success:0,failed:0,total:W.length});const ee=new Map;e.forEach(ke=>{const S=`${ke.servantCode}|${ke.serviceName}|${ke.year}`;ee.set(S,ke.id)});const se=[],J=[];W.forEach(ke=>{const{evaluation:S}=ke,je=`${S.servantCode}|${S.serviceName}|${S.year}`,Ce=ee.get(je);Ce?J.push({id:Ce,data:S}):se.push(S)});let q=0;try{const ke=[...se.map(je=>({type:"add",data:je})),...J.map(je=>({type:"update",id:je.id,data:je.data}))];for(let je=0;je<ke.length;je+=500){const Ce=ke.slice(je,je+500),Be=qe.batch();Ce.forEach(Fe=>{if(Fe.type==="add"){const ce=qe.collection("evaluations").doc();Be.set(ce,Fe.data)}else if(Fe.type==="update"){const ce=qe.collection("evaluations").doc(Fe.id);Be.set(ce,Fe.data,{merge:!0})}}),await Be.commit(),q+=Ce.length,N(Fe=>({...Fe,success:q}))}w("complete");let S="اكتمل الاستيراد! ";se.length>0&&(S+=`تم إضافة ${se.length} تقييم جديد. `),J.length>0&&(S+=`تم تحديث ${J.length} تقييم.`),fe(S.trim(),"success"),ie()}catch(ke){console.error("Error during evaluation import:",ke),fe("حدث خطأ أثناء استيراد التقييمات.","error"),w("preview")}},A=G.useMemo(()=>{if(!i.trim())return e;const W=i.toLowerCase().trim();return e.filter(ee=>ee.servantName.toLowerCase().includes(W)||ee.servantCode.toLowerCase().includes(W)||ee.serviceName.toLowerCase().includes(W))},[e,i]),M=()=>f("list");if(r&&l==="list")return o.jsx("div",{className:"flex justify-center items-center py-20",children:o.jsx(Yw,{})});const D=()=>o.jsxs(o.Fragment,{children:[o.jsxs("header",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-8 gap-4",children:[o.jsxs("div",{children:[o.jsxs("h2",{className:"text-xl font-bold text-slate-800 dark:text-slate-100",children:["إدارة التقييمات (",e.length,")"]}),o.jsx("p",{className:"text-slate-500 dark:text-slate-400 mt-1",children:"عرض وإدارة جميع تقييمات الخدام."})]}),o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsxs("button",{onClick:()=>f("import"),className:"flex items-center justify-center px-4 py-2 bg-green-600 text-white font-semibold rounded-lg hover:bg-green-700",children:[o.jsx(Qw,{})," استيراد"]}),o.jsxs("button",{onClick:()=>{x(null),u(!0)},className:"flex items-center px-4 py-2 bg-indigo-600 text-white font-bold rounded-lg hover:bg-indigo-700",children:[o.jsx(Zw,{})," إضافة تقييم"]})]})]}),o.jsxs("div",{className:"mb-4 flex flex-col sm:flex-row gap-4 justify-between",children:[o.jsxs("div",{className:"relative",children:[o.jsx("input",{type:"text",placeholder:"ابحث باسم الخادم, الكود, الخدمة...",value:i,onChange:W=>c(W.target.value),className:"w-full sm:max-w-md px-4 py-2 pr-10 text-gray-700 bg-white dark:bg-slate-800 border border-gray-300 dark:border-slate-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 dark:text-gray-200"}),o.jsx("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none",children:o.jsx(Kw,{})})]}),o.jsxs("button",{onClick:Ve,disabled:P,className:"flex items-center justify-center px-4 py-2 bg-green-100 text-green-800 font-semibold rounded-lg hover:bg-green-200 dark:bg-green-900/30 dark:text-green-300 disabled:opacity-50",children:[o.jsx(tk,{})," ",P?"جاري...":"تصدير الكل"]})]}),o.jsx("div",{className:"space-y-4",children:A.map(W=>o.jsxs("div",{className:"bg-white dark:bg-slate-800 p-4 rounded-lg shadow-sm border border-gray-200/80 dark:border-slate-700 flex flex-col sm:flex-row justify-between items-start gap-4",children:[o.jsxs("div",{className:"flex-grow",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("p",{className:"font-bold text-indigo-700 dark:text-indigo-300",children:[W.servantName," ",o.jsxs("span",{className:"font-mono text-xs text-gray-400",children:["(",W.servantCode,")"]})]}),o.jsx("span",{className:"text-sm font-semibold bg-indigo-100 text-indigo-800 px-2 py-0.5 rounded-full dark:bg-slate-700 dark:text-indigo-300",children:W.year})]}),o.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:["الخدمة: ",o.jsx("span",{className:"font-medium text-gray-700 dark:text-gray-300",children:W.serviceName})]}),o.jsx("div",{className:"flex items-center gap-2 mt-2",children:o.jsxs("p",{className:"text-sm font-semibold text-gray-800 dark:text-gray-200",children:["المتوسط: ",W.overallAverage,"%"]})})]}),o.jsxs("div",{className:"flex items-center gap-2 self-end sm:self-center",children:[o.jsx("button",{onClick:()=>{x(W),u(!0)},className:"text-indigo-600 hover:text-indigo-900 p-2",children:o.jsx(Jw,{})}),o.jsx("button",{onClick:()=>{x(W),m(!0)},className:"text-red-600 hover:text-red-900 p-2",children:o.jsx(qw,{})})]})]},W.id))})]}),O=()=>o.jsxs("div",{className:"bg-white dark:bg-slate-800 p-6 md:p-8 rounded-lg shadow-sm border border-gray-200/80 dark:border-slate-700",children:[o.jsxs("header",{className:"flex justify-between items-center mb-8",children:[o.jsxs("div",{children:[o.jsx("h2",{className:"text-2xl font-bold text-slate-800 dark:text-slate-100",children:"استيراد التقييمات"}),o.jsx("p",{className:"text-slate-500 dark:text-slate-400",children:"أضف التقييمات بشكل جماعي."})]}),o.jsx("button",{onClick:M,className:"px-5 py-2 bg-gray-100 dark:bg-slate-700 text-slate-700 dark:text-slate-200 font-semibold rounded-lg hover:bg-gray-200 dark:hover:bg-slate-600",children:"العودة للقائمة"})]}),B&&o.jsx("div",{className:"mb-4 text-center text-red-600 bg-red-100 dark:bg-red-900/20 dark:text-red-400 p-3 rounded-lg",children:B}),b==="idle"&&o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8 items-center",children:[o.jsxs("div",{children:[o.jsx("h3",{className:"font-semibold text-lg",children:"الخطوات"}),o.jsxs("ol",{className:"list-decimal list-inside space-y-3 mt-3",children:[o.jsxs("li",{children:[o.jsx("strong",{className:"font-semibold",children:"تنزيل القالب:"})," لضمان تطابق الأعمدة."]}),o.jsxs("li",{children:[o.jsx("strong",{className:"font-semibold",children:"ملء البيانات:"})," املأ القالب ببيانات التقييمات."]}),o.jsxs("li",{children:[o.jsx("strong",{className:"font-semibold",children:"رفع الملف:"})," لبدء عملية الاستيراد."]})]}),o.jsx("button",{onClick:we,className:"mt-6 px-4 py-2 bg-green-600 text-white font-semibold rounded-lg",children:"تنزيل القالب"})]}),o.jsx("div",{className:"border-2 border-dashed rounded-lg p-8 text-center",children:o.jsxs("label",{htmlFor:"file-upload",className:"cursor-pointer",children:[o.jsx(ek,{}),o.jsx("p",{className:"mt-2 text-indigo-600 font-semibold",children:"اختر ملفاً"}),o.jsx("input",{id:"file-upload",type:"file",className:"hidden",onChange:H,accept:".xlsx, .xls, .csv"})]})})]}),b==="preview"&&o.jsxs("div",{children:[o.jsxs("h3",{className:"font-semibold text-lg",children:["معاينة البيانات من: ",o.jsx("span",{className:"font-normal text-indigo-600",children:I})]}),o.jsxs("div",{className:"mt-6 flex justify-end gap-4",children:[o.jsx("button",{onClick:M,className:"px-5 py-2 bg-gray-100 rounded-lg",children:"إلغاء"}),o.jsx("button",{onClick:Ee,disabled:j.filter(W=>W.errors.length===0).length===0,className:"px-5 py-2 bg-indigo-600 text-white font-bold rounded-lg",children:"بدء الاستيراد"})]})]}),b==="complete"&&o.jsxs("div",{className:"text-center py-12",children:[o.jsx(rk,{}),o.jsx("h3",{className:"text-2xl font-bold mt-4",children:"اكتمل الاستيراد!"}),o.jsx("button",{onClick:M,className:"mt-6 px-6 py-2 bg-indigo-600 text-white rounded-lg",children:"استيراد ملف آخر"})]})]});return o.jsxs("div",{className:"animate-fade-in-up",children:[l==="list"?D():O(),d&&o.jsx(Xw,{evaluation:g,onClose:()=>u(!1),onSave:(W,ee)=>pe(W,ee),isSubmitting:p}),h&&g&&o.jsx(cs,{title:"تأكيد الحذف",message:`هل أنت متأكد من حذف تقييم ${g.serviceName}؟`,onConfirm:he,onCancel:()=>m(!1),isConfirming:p,confirmButtonClass:"bg-red-600"})]})},bn=[{id:"indigo",name:"نيلي (افتراضي)",color:"#4f46e5",primary:"bg-indigo-600",accent:"text-indigo-600",light:"bg-indigo-50"},{id:"teal",name:"أزرق مخضر",color:"#0d9488",primary:"bg-teal-600",accent:"text-teal-600",light:"bg-teal-50"},{id:"rose",name:"وردي",color:"#e11d48",primary:"bg-rose-600",accent:"text-rose-600",light:"bg-rose-50"},{id:"purple",name:"بنفسجي",color:"#9333ea",primary:"bg-purple-600",accent:"text-purple-600",light:"bg-purple-50"},{id:"green",name:"أخضر",color:"#166534",primary:"bg-green-800",accent:"text-green-800",light:"bg-green-50"},{id:"amber",name:"عنبري",color:"#d97706",primary:"bg-amber-500",accent:"text-amber-600",light:"bg-amber-50"},{id:"cyan",name:"سماوي",color:"#0891b2",primary:"bg-cyan-600",accent:"text-cyan-600",light:"bg-cyan-50"},{id:"lime",name:"ليموني",color:"#65a30d",primary:"bg-lime-500",accent:"text-lime-600",light:"bg-lime-50"}],sk={a4:"A4 (قياسي)",a5:"A5 (صغير)",letter:"Letter"},nk=["#000000","#374151","#7f1d1d","#b91c1c","#d97706","#166534","#065f46","#115e59","#0891b2","#0c4a6e","#1e3a8a","#4f46e5","#6d28d9","#9333ea","#be185d","#e11d48"],ik=()=>o.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:[o.jsx("path",{d:"M17.414 2.586a2 2 0 00-2.828 0L7 10.172V13h2.828l7.586-7.586a2 2 0 000-2.828z"}),o.jsx("path",{fillRule:"evenodd",d:"M2 6a2 2 0 012-2h4a1 1 0 010 2H4v10h10v-4a1 1 0 112 0v4a2 2 0 01-2 2H4a2 2 0 01-2-2V6z",clipRule:"evenodd"})]}),ck=()=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor",children:o.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})}),Cs=({label:e,value:t,onChange:r})=>o.jsxs("div",{children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:e}),o.jsxs("div",{className:"relative w-28 h-8 border border-gray-300 dark:border-slate-600 rounded-md flex items-center",children:[o.jsx("input",{type:"color",value:t,onChange:a=>r(a.target.value),className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer"}),o.jsx("div",{className:"w-8 h-full rounded-r-md",style:{backgroundColor:t}}),o.jsx("input",{type:"text",value:t,onChange:a=>r(a.target.value),className:"w-20 px-2 py-1 text-xs font-mono bg-transparent focus:outline-none text-gray-700 dark:text-gray-300"})]})]}),o.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:nk.map(a=>o.jsx("button",{type:"button",onClick:()=>r(a),className:`w-6 h-6 rounded-full border border-gray-300 dark:border-slate-500 cursor-pointer transition transform hover:scale-110 ${t===a?"ring-2 ring-offset-2 ring-[rgb(var(--color-primary-rgb))]":""}`,style:{backgroundColor:a},"aria-label":`Select color ${a}`},a))})]}),ok=({setTheme:e,isDarkMode:t,setIsDarkMode:r,customStyles:a,setCustomStyles:s,setBackgroundUrl:n,backgroundUrl:i,backgroundGallery:c,setBackgroundGallery:l})=>{const[f,d]=G.useState(()=>localStorage.getItem("theme")||"indigo"),[u,h]=G.useState(""),[m,g]=G.useState(!1),[x,p]=G.useState(null),[k,b]=G.useState("");G.useEffect(()=>{const N=bn.find(B=>B.color===a.primaryColor);N?(d(N.id),e(N.id)):(d("custom"),e(""))},[a.primaryColor,e]);const w=N=>{const B=bn.find(L=>L.id===N);B&&(d(N),e(N),s(L=>({...L,primaryColor:B.color})))},j=(N,B)=>{s(L=>({...L,[N]:B}))},R=N=>{N.preventDefault(),u.trim()&&n(u.trim())},I=N=>{var L;const B=(L=N.target.files)==null?void 0:L[0];if(B){const P=new FileReader;P.onloadstart=()=>g(!0),P.onloadend=()=>{n(P.result),g(!1)},P.onerror=()=>{g(!1),alert("حدث خطأ أثناء قراءة الصورة.")},P.readAsDataURL(B)}},E=(N,B)=>{var P;const L=(P=N.target.files)==null?void 0:P[0];if(L){const Q=new FileReader;Q.onloadend=()=>{const fe=[...c];fe[B]=Q.result,l(fe),p(null)},Q.readAsDataURL(L)}},U=(N,B)=>{if(N.preventDefault(),k.trim()){const L=[...c];L[B]=k.trim(),l(L),p(null)}};return o.jsxs("div",{className:"space-y-8",children:[o.jsxs("div",{className:"bg-white dark:bg-slate-800 p-8 rounded-lg shadow-sm border border-gray-200/80 dark:border-slate-700",children:[o.jsx("h3",{className:"text-xl font-bold text-slate-700 dark:text-slate-200 mb-2",children:"تخصيص نظام الألوان"}),o.jsx("p",{className:"text-slate-500 dark:text-slate-400 mb-6",children:"اختر نظام الألوان للوحة التحكم والعناصر الرئيسية."}),o.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-6",children:bn.map(N=>o.jsxs("div",{onClick:()=>w(N.id),className:`p-4 rounded-lg border-2 cursor-pointer transition-all duration-200 ${f===N.id?"border-[rgb(var(--color-primary-rgb))] ring-2 ring-[rgb(var(--color-primary-rgb))]":"border-gray-300 dark:border-slate-600 hover:border-gray-400 dark:hover:border-slate-500"}`,children:[o.jsxs("div",{className:"flex items-center justify-between mb-3",children:[o.jsx("p",{className:"font-semibold text-slate-800 dark:text-slate-200",children:N.name}),f===N.id&&o.jsx("div",{className:"text-[rgb(var(--color-primary-rgb))]",children:o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",viewBox:"0 0 20 20",fill:"currentColor",children:o.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})})})]}),o.jsxs("div",{className:`${N.light} dark:bg-slate-700 p-3 rounded-md`,children:[o.jsx("p",{className:`text-sm font-medium ${N.accent}`,children:N.name}),o.jsx("button",{className:`px-3 py-1 text-xs text-white rounded-md mt-2 ${N.primary}`,children:"زر"})]})]},N.id))})]}),o.jsxs("div",{className:"bg-white dark:bg-slate-800 p-8 rounded-lg shadow-sm border border-gray-200/80 dark:border-slate-700",children:[o.jsx("h3",{className:"text-xl font-bold text-slate-700 dark:text-slate-200 mb-2",children:"خلفية التطبيق"}),o.jsx("p",{className:"text-slate-500 dark:text-slate-400 mb-6",children:"اختر الخلفية لواجهة المستخدم الرئيسية."}),o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{children:[o.jsx("h4",{className:"font-semibold text-slate-600 dark:text-slate-300 mb-3",children:"الخلفية الافتراضية"}),o.jsx("button",{onClick:()=>n(el),className:"px-5 py-2 bg-gray-100 text-slate-700 font-semibold rounded-lg hover:bg-gray-200 dark:bg-slate-700 dark:text-slate-200 dark:hover:bg-slate-600",children:"استعادة الخلفية الافتراضية"})]}),o.jsxs("div",{className:"border-t border-gray-200 dark:border-slate-700 pt-6",children:[o.jsx("h4",{className:"font-semibold text-slate-600 dark:text-slate-300 mb-3",children:"رفع صورة من الجهاز"}),o.jsx("label",{htmlFor:"bg-upload",className:"cursor-pointer inline-flex items-center px-5 py-2 bg-[rgb(var(--color-primary-light-rgb))] text-[rgb(var(--color-primary-dark-text-rgb))] font-semibold rounded-lg hover:bg-[rgb(var(--color-primary-accent-rgb))]/20",children:m?"جاري الرفع...":"اختر صورة"}),o.jsx("input",{id:"bg-upload",type:"file",className:"hidden",onChange:I,accept:"image/*"})]}),o.jsxs("div",{className:"border-t border-gray-200 dark:border-slate-700 pt-6",children:[o.jsx("h4",{className:"font-semibold text-slate-600 dark:text-slate-300 mb-3",children:"استخدام رابط صورة"}),o.jsxs("form",{onSubmit:R,className:"flex items-center gap-2",children:[o.jsx("input",{type:"url",placeholder:"https://example.com/image.jpg",value:u,onChange:N=>h(N.target.value),className:"w-full sm:max-w-md px-4 py-2 text-gray-700 bg-white dark:bg-slate-700 border border-gray-300 dark:border-slate-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-[rgb(var(--color-primary-rgb))] dark:text-gray-200"}),o.jsx("button",{type:"submit",className:"px-5 py-2 bg-[rgb(var(--color-primary-rgb))] text-white font-bold rounded-lg hover:bg-[rgb(var(--color-primary-accent-rgb))]",children:"تطبيق"})]})]}),o.jsxs("div",{className:"border-t border-gray-200 dark:border-slate-700 pt-6",children:[o.jsx("h4",{className:"font-semibold text-slate-600 dark:text-slate-300 mb-2",children:"معرض الخلفيات"}),o.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400 mb-4",children:"اضغط على صورة لتغيير الخلفية مباشرةً، أو مرر الفأرة لتعديلها."}),o.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:c.map((N,B)=>o.jsxs("div",{className:"relative group aspect-video rounded-lg overflow-hidden shadow-md cursor-pointer",onClick:()=>n(N),children:[o.jsx("img",{src:N,alt:`خلفية ${B+1}`,className:"w-full h-full object-cover transition-transform duration-300 group-hover:scale-110",onError:L=>L.currentTarget.src="https://i.postimg.cc/8zW3pL2T/placeholder.png"}),i===N&&o.jsx("div",{className:"absolute inset-0 ring-4 ring-offset-2 ring-indigo-500 dark:ring-offset-slate-800 pointer-events-none rounded-lg"}),o.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-40 transition-all duration-300 flex items-center justify-center opacity-0 group-hover:opacity-100",children:o.jsx("button",{onClick:L=>{L.stopPropagation(),p(B),b("")},className:"p-3 bg-white/80 dark:bg-slate-900/80 rounded-full text-slate-800 dark:text-white hover:scale-110 transition-transform","aria-label":"تعديل الصورة",children:o.jsx(ik,{})})}),x===B&&o.jsxs("div",{className:"absolute inset-0 bg-black/80 z-10 flex flex-col justify-center items-center p-2 text-white animate-fade-in-up",onClick:L=>L.stopPropagation(),children:[o.jsx("button",{onClick:()=>p(null),className:"absolute top-1 right-1 text-white/70 hover:text-white",children:o.jsx(ck,{})}),o.jsxs("h5",{className:"text-xs font-bold mb-2",children:["تعديل الخلفية ",B+1]}),o.jsxs("form",{onSubmit:L=>U(L,B),className:"w-full flex gap-1 mb-2",children:[o.jsx("input",{type:"url",value:k,onChange:L=>b(L.target.value),placeholder:"لصق رابط...",className:"w-full text-xs px-2 py-1 bg-slate-700 text-white border border-slate-500 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500"}),o.jsx("button",{type:"submit",className:"text-xs px-2 py-1 bg-indigo-600 rounded-md hover:bg-indigo-700",children:"حفظ"})]}),o.jsxs("div",{className:"relative my-1 w-full flex items-center",children:[o.jsx("span",{className:"flex-grow border-t border-slate-600"}),o.jsx("span",{className:"flex-shrink mx-2 text-xs text-slate-400",children:"أو"}),o.jsx("span",{className:"flex-grow border-t border-slate-600"})]}),o.jsx("label",{htmlFor:`gallery-upload-${B}`,className:"w-full text-center text-xs px-2 py-1 bg-slate-600 rounded-md hover:bg-slate-500 cursor-pointer",children:"رفع صورة"}),o.jsx("input",{id:`gallery-upload-${B}`,type:"file",onChange:L=>E(L,B),accept:"image/*",className:"hidden"})]})]},B))})]})]})]}),o.jsxs("div",{className:"bg-white dark:bg-slate-800 p-8 rounded-lg shadow-sm border border-gray-200/80 dark:border-slate-700",children:[o.jsx("h3",{className:"text-xl font-bold text-slate-700 dark:text-slate-200 mb-2",children:"الوضع الليلي"}),o.jsxs("div",{className:"flex items-center justify-between bg-slate-50 dark:bg-slate-700/50 p-4 rounded-lg",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[t?o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-yellow-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"})}):o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-slate-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"})}),o.jsxs("span",{className:"font-semibold text-slate-700 dark:text-slate-200",children:["الوضع الليلي ",t?"مُفعّل":"غير مُفعّل"]})]}),o.jsx("button",{onClick:()=>r(!t),className:`relative inline-flex flex-shrink-0 h-6 w-11 border-2 border-transparent rounded-full cursor-pointer transition-colors ease-in-out duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-[rgb(var(--color-primary-rgb))] ${t?"bg-[rgb(var(--color-primary-rgb))]":"bg-gray-200"}`,children:o.jsx("span",{className:`inline-block w-5 h-5 bg-white rounded-full shadow-lg transform ring-0 transition ease-in-out duration-200 ${t?"-translate-x-5":"translate-x-0"}`})})]})]}),o.jsxs("div",{className:"bg-white dark:bg-slate-800 p-8 rounded-lg shadow-sm border border-gray-200/80 dark:border-slate-700",children:[o.jsx("h3",{className:"text-xl font-bold text-slate-700 dark:text-slate-200 mb-2",children:"إعدادات الشهادة المتقدمة"}),o.jsx("p",{className:"text-slate-500 dark:text-slate-400 mb-6",children:"تحكم في أبعاد وجودة الشهادات عند تصديرها كملفات."}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-6",children:[o.jsxs("div",{children:[o.jsx("label",{htmlFor:"paper-size",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"حجم الورق (لـ PDF)"}),o.jsx("select",{id:"paper-size",value:a.paperSize,onChange:N=>j("paperSize",N.target.value),className:"w-full p-2 border border-gray-300 dark:border-slate-600 rounded-md shadow-sm focus:ring-[rgb(var(--color-primary-rgb))] focus:border-[rgb(var(--color-primary-rgb))] bg-white dark:bg-slate-700 text-gray-800 dark:text-gray-200",children:Object.entries(sk).map(([N,B])=>o.jsx("option",{value:N,children:B},N))})]}),o.jsxs("div",{children:[o.jsxs("label",{htmlFor:"quality-scale",className:"flex justify-between items-center text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[o.jsx("span",{children:"مقياس الجودة (تكبير/تصغير)"}),o.jsxs("span",{className:"font-mono text-[rgb(var(--color-primary-dark-text-rgb))] dark:text-[rgb(var(--color-primary-light-text-rgb))] text-xs font-bold",children:[a.qualityScale,"x"]})]}),o.jsx("input",{id:"quality-scale",type:"range",min:"1",max:"5",step:"1",value:a.qualityScale,onChange:N=>j("qualityScale",Number(N.target.value)),className:"w-full h-2 bg-gray-200 dark:bg-slate-700 rounded-lg appearance-none cursor-pointer"})]})]})]}),o.jsxs("div",{className:"bg-white dark:bg-slate-800 p-8 rounded-lg shadow-sm border border-gray-200/80 dark:border-slate-700",children:[o.jsx("h3",{className:"text-xl font-bold text-slate-700 dark:text-slate-200 mb-2",children:"إعدادات المظهر المتقدمة"}),o.jsx("p",{className:"text-slate-500 dark:text-slate-400 mb-6",children:"تحكم في شفافية وضبابية وألوان البطاقات والنصوص في واجهة المستخدم الرئيسية."}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-6",children:[o.jsxs("div",{children:[o.jsxs("label",{htmlFor:"cardOpacity",className:"flex justify-between items-center text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[o.jsx("span",{children:"شفافية البطاقات (العتامة)"}),o.jsxs("span",{className:"font-mono text-[rgb(var(--color-primary-dark-text-rgb))] dark:text-[rgb(var(--color-primary-light-text-rgb))] text-xs font-bold",children:[Math.round(a.cardOpacity*100),"%"]})]}),o.jsx("input",{id:"cardOpacity",type:"range",min:"0",max:"100",value:a.cardOpacity*100,onChange:N=>j("cardOpacity",Number(N.target.value)/100),className:"w-full h-2 bg-gray-200 dark:bg-slate-700 rounded-lg appearance-none cursor-pointer"})]}),o.jsxs("div",{children:[o.jsxs("label",{htmlFor:"cardBorderOpacity",className:"flex justify-between items-center text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[o.jsx("span",{children:"شفافية حدود البطاقات"}),o.jsxs("span",{className:"font-mono text-[rgb(var(--color-primary-dark-text-rgb))] dark:text-[rgb(var(--color-primary-light-text-rgb))] text-xs font-bold",children:[Math.round(a.cardBorderOpacity*100),"%"]})]}),o.jsx("input",{id:"cardBorderOpacity",type:"range",min:"0",max:"100",value:a.cardBorderOpacity*100,onChange:N=>j("cardBorderOpacity",Number(N.target.value)/100),className:"w-full h-2 bg-gray-200 dark:bg-slate-700 rounded-lg appearance-none cursor-pointer"})]}),o.jsxs("div",{children:[o.jsxs("label",{htmlFor:"cardBlur",className:"flex justify-between items-center text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[o.jsx("span",{children:"ضبابية الخلفية"}),o.jsxs("span",{className:"font-mono text-[rgb(var(--color-primary-dark-text-rgb))] dark:text-[rgb(var(--color-primary-light-text-rgb))] text-xs font-bold",children:[a.cardBlur,"px"]})]}),o.jsx("input",{id:"cardBlur",type:"range",min:"0",max:"32",value:a.cardBlur,onChange:N=>j("cardBlur",Number(N.target.value)),className:"w-full h-2 bg-gray-200 dark:bg-slate-700 rounded-lg appearance-none cursor-pointer"})]}),o.jsx("div",{})," ",o.jsx(Cs,{label:"لون البطاقات الأساسي",value:a.cardColor,onChange:N=>j("cardColor",N)}),o.jsx(Cs,{label:"اللون الأساسي (للأزرار)",value:a.primaryColor,onChange:N=>j("primaryColor",N)}),o.jsx(Cs,{label:"لون النص (الوضع النهاري)",value:a.mainTextColorLight,onChange:N=>j("mainTextColorLight",N)}),o.jsx(Cs,{label:"لون النص (الوضع الليلي)",value:a.mainTextColorDark,onChange:N=>j("mainTextColorDark",N)})]})]})]})},lk=()=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-8 w-8",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v.01"})}),fk=()=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-8 w-8",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),dk=()=>o.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-indigo-600"}),hk=()=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),Li=({icon:e,title:t,value:r,color:a})=>o.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl p-6 shadow-md border border-gray-200/80 dark:border-slate-700 flex items-center gap-6",children:[o.jsx("div",{className:`rounded-full p-4 ${a}`,children:e}),o.jsxs("div",{children:[o.jsx("p",{className:"text-lg text-gray-500 dark:text-gray-400 font-medium",children:t}),o.jsx("p",{className:"text-4xl font-bold text-gray-800 dark:text-gray-200",children:r})]})]}),uk=()=>{const[e,t]=G.useState([]),[r,a]=G.useState(!0),[s,n]=G.useState(""),[i,c]=G.useState(!1),[l,f]=G.useState(!1),{addToast:d}=os();G.useEffect(()=>{(async()=>{a(!0),n("");try{const k=(await qe.collection("queryLogs").orderBy("timestamp","desc").limit(1e3).get()).docs.map(b=>({id:b.id,...b.data()}));t(k)}catch(x){console.error("Error fetching usage stats:",x),n("حدث خطأ أثناء تحميل سجل الاستخدام. قد تكون أذونات الوصول إلى قاعدة البيانات غير كافية.")}finally{a(!1)}})()},[]);const u=G.useMemo(()=>{const g=new Date;g.setHours(0,0,0,0);const x=e.filter(p=>p.timestamp&&p.timestamp.toDate()>=g);return{totalQueries:e.length,todayQueries:x.length}},[e]),h=async()=>{f(!0);try{const g=qe.collection("queryLogs");let x=await g.limit(500).get();for(;x.size>0;){const p=qe.batch();x.docs.forEach(k=>p.delete(k.ref)),await p.commit(),x=await g.limit(500).get()}d("تم مسح سجل الاستعلامات بنجاح.","success"),t([])}catch(g){console.error("Error clearing logs:",g),d("فشل مسح السجل.","error"),n("حدث خطأ أثناء محاولة مسح السجل.")}finally{f(!1),c(!1)}};if(r)return o.jsx("div",{className:"flex justify-center items-center py-20",children:o.jsx(dk,{})});if(s&&e.length===0)return o.jsx("p",{className:"text-red-500 text-center py-10 font-semibold",children:s});const m=e.slice(0,100);return o.jsxs("div",{className:"space-y-8 animate-fade-in-up",children:[o.jsxs("header",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[o.jsxs("div",{children:[o.jsx("h2",{className:"text-xl font-bold text-slate-800 dark:text-slate-100",children:"ملخص الاستخدام"}),o.jsx("p",{className:"text-slate-500 dark:text-slate-400 mt-1",children:"نظرة عامة على عمليات الاستعلام التي تمت في التطبيق."})]}),o.jsxs("button",{onClick:()=>c(!0),className:"flex items-center justify-center px-4 py-2 bg-red-600 text-white font-semibold rounded-lg hover:bg-red-700 transition-transform transform hover:scale-105",children:[o.jsx(hk,{}),"مسح السجل"]})]}),s&&o.jsx("p",{className:"text-red-500 text-center py-2 font-semibold bg-red-100 dark:bg-red-900/30 rounded-lg",children:s}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-2 gap-6",children:[o.jsx(Li,{icon:o.jsx(lk,{}),title:"إجمالي الاستعلامات (آخر 1000)",value:u.totalQueries,color:"bg-blue-100 text-blue-600 dark:bg-blue-900/50 dark:text-blue-300"}),o.jsx(Li,{icon:o.jsx(fk,{}),title:"استعلامات اليوم",value:u.todayQueries,color:"bg-green-100 text-green-600 dark:bg-green-900/50 dark:text-green-300"})]}),o.jsxs("div",{className:"bg-white dark:bg-slate-800 p-6 rounded-lg shadow-sm border border-gray-200/80 dark:border-slate-700",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-800 dark:text-gray-200 mb-4",children:"سجل الاستعلامات (آخر 100 عملية)"}),o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-slate-700",children:[o.jsx("thead",{className:"bg-slate-100 dark:bg-slate-700",children:o.jsxs("tr",{children:[o.jsx("th",{className:"px-6 py-3 text-right text-sm font-medium text-gray-500 dark:text-gray-400",children:"الوقت والتاريخ"}),o.jsx("th",{className:"px-6 py-3 text-right text-sm font-medium text-gray-500 dark:text-gray-400",children:"اسم الخادم"}),o.jsx("th",{className:"px-6 py-3 text-right text-sm font-medium text-gray-500 dark:text-gray-400",children:"الكود"}),o.jsx("th",{className:"px-6 py-3 text-right text-sm font-medium text-gray-500 dark:text-gray-400",children:"المدخل للبحث"})]})}),o.jsx("tbody",{className:"bg-white dark:bg-slate-800 divide-y divide-gray-200 dark:divide-slate-700",children:m.length>0?m.map(g=>o.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-slate-700/50",children:[o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:g.timestamp?g.timestamp.toDate().toLocaleString("ar-EG"):"غير متوفر"}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-gray-100",children:g.foundName}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400 font-mono",children:g.foundCode}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400 font-mono",children:g.searchedId})]},g.id)):o.jsx("tr",{children:o.jsx("td",{colSpan:4,className:"text-center text-gray-500 py-10",children:"لا توجد سجلات استعلام لعرضها."})})})]})})]}),i&&o.jsx(cs,{title:"تأكيد مسح السجل",message:"هل أنت متأكد من رغبتك في مسح جميع سجلات الاستعلام؟ لا يمكن التراجع عن هذا الإجراء.",onConfirm:h,onCancel:()=>c(!1),isConfirming:l,confirmText:"نعم، امسح السجل",confirmButtonClass:"bg-red-600 hover:bg-red-700"})]})},xk=()=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})}),mk=()=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),Ri=()=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M15 21v-1a6 6 0 00-1.78-4.125"})}),gk=()=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),pk=()=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),vk=()=>o.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:[o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 14l9-5-9-5-9 5 9 5z"}),o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 14l6.16-3.422a12.083 12.083 0 01.665 6.479A11.952 11.952 0 0012 20.055a11.952 11.952 0 00-6.824-2.998 12.078 12.078 0 01.665-6.479L12 14z"}),o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 14v6m-4-3v3m8-3v3"})]}),wk=()=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"})}),kk=()=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 3v4M3 5h4M6.343 17.657l-2.828 2.828m14.142-14.142l2.828 2.828m-12.728 0l2.828-2.828m0 0l2.828 2.828M3 12a9 9 0 1118 0 9 9 0 01-18 0z"})}),_k=()=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),yk=()=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),bk=()=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"})}),Ek=()=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.52 4.674c.3.921-.755 1.688-1.54 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976-2.888c-.784.57-1.838-.197-1.539-1.118l1.52-4.674a1 1 0 00-.363-1.118L2.98 9.11c-.783-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.52-4.674z"})}),Sk=()=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),Tk=()=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 3v2m6-2v2M9 19v2m6-2v2M5 9H3m2 6H3m18-6h-2m2 6h-2M12 6V3m0 18v-3m6-9h-2m-4 0H9m12 0a9 9 0 11-18 0 9 9 0 0118 0z"})}),Nk=()=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zm0 0h12a2 2 0 002-2v-4a2 2 0 00-2-2h-2.343M11 7.343l1.657-1.657a2 2 0 012.828 0l2.829 2.829a2 2 0 010 2.828l-8.486 8.485M7 17h.01"})}),Fk=()=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"})}),Ck=()=>o.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"}),o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 13a3 3 0 11-6 0 3 3 0 016 0z"})]}),As=({icon:e,title:t,value:r,unit:a,color:s,description:n,onClick:i})=>o.jsxs("div",{onClick:i,className:`bg-white dark:bg-slate-800 rounded-xl p-6 shadow-md border border-gray-200/80 dark:border-slate-700 flex flex-col justify-between hover:shadow-lg hover:-translate-y-1 transition-all duration-300 ${i?"cursor-pointer":""}`,children:[o.jsxs("div",{className:"flex items-center gap-4",children:[o.jsx("div",{className:`rounded-full p-3 ${s}`,children:e}),o.jsxs("div",{children:[o.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 font-medium",children:t}),o.jsxs("p",{className:"text-2xl font-bold text-gray-800 dark:text-gray-200",children:[r,o.jsx("span",{className:"text-lg font-normal text-gray-600 dark:text-gray-300",children:a})]})]})]}),n&&o.jsx("p",{className:"text-xs text-gray-400 dark:text-gray-500 mt-2",children:n})]}),Mi=({title:e,data:t,colors:r,total:a,unit:s="خدام",icon:n,onBarClick:i})=>o.jsxs("div",{className:"bg-white dark:bg-slate-800 p-6 rounded-xl shadow-md border border-gray-200/80 dark:border-slate-700 h-full",children:[o.jsxs("h3",{className:"text-lg font-semibold text-gray-800 dark:text-gray-200 mb-4 flex items-center gap-2",children:[n," ",e]}),o.jsx("div",{className:"space-y-4",children:Object.entries(t).map(([c,l])=>{if(l===0)return null;const f=a>0?Number(l)/a*100:0;return o.jsxs("div",{className:`group ${i?"cursor-pointer":""}`,onClick:()=>i==null?void 0:i(c),children:[o.jsxs("div",{className:"flex justify-between items-center mb-1 text-sm",children:[o.jsx("span",{className:"font-medium text-gray-700 dark:text-gray-300",children:c}),o.jsxs("span",{className:"font-semibold text-gray-600 dark:text-gray-400 group-hover:text-[rgb(var(--color-primary-dark-text-rgb))] transition-colors",children:[l," ",s]})]}),o.jsx("div",{className:"w-full bg-gray-200 dark:bg-slate-700 rounded-full h-2.5",children:o.jsx("div",{className:`${r[c]} h-2.5 rounded-full transition-all duration-500 ease-out`,style:{width:`${f}%`}})})]},c)})})]}),jk=({onLogout:e,certificateTexts:t,setCertificateTexts:r,setTheme:a,isDarkMode:s,setIsDarkMode:n,customStyles:i,setCustomStyles:c,setBackgroundUrl:l,backgroundUrl:f,backgroundGallery:d,setBackgroundGallery:u})=>{const[h,m]=G.useState([]),[g,x]=G.useState(!0),[p,k]=G.useState(""),[b,w]=G.useState(""),[j,R]=G.useState("info"),[I,E]=G.useState([]),[U,N]=G.useState(!1),B=G.useRef(null),[L,P]=G.useState([]),[Q,fe]=G.useState(!1),ie=G.useRef(null),[pe,he]=G.useState(null),[Ve,H]=G.useState(!1),[we,Ee]=G.useState(""),[A,M]=G.useState([]),[D,O]=G.useState(!1),[W,ee]=G.useState(null),se=G.useRef(null),J=G.useRef(null),[q,ke]=G.useState(!1),[S,je]=G.useState(!1);G.useEffect(()=>{(async()=>{x(!0),k("");try{const ge=await qe.collection("servants").get(),Te=await qe.collection("courseResults").get(),Oe=new Map;ge.forEach(oe=>{const be=oe.data();be.code=oe.id,Oe.set(oe.id,be)});const ye=new Map;Te.forEach(oe=>{const be=oe.data(),De=String(be.servantCode);ye.has(De)||ye.set(De,[]),ye.get(De).push(be)});const Z=[];for(const oe of ye.values()){const be=new Map;for(const De of oe){const Pe=`${De.courseName}|${De.year}`,tr=be.get(Pe);if(!tr)be.set(Pe,De);else{const lt=tr.score==="غائب"?-1:tr.score;(De.score==="غائب"?-1:De.score)>lt&&be.set(Pe,De)}}Z.push(...Array.from(be.values()))}const ue=[];Z.forEach(oe=>{const be=String(oe.servantCode),De=Oe.get(be);De&&ue.push({code:De.code,name:De.name||"اسم غير متوفر",mobileNumber:De.mobileNumber||"غير متوفر",service:Array.isArray(De.allServices)&&De.allServices.length>0?De.allServices.join(" / "):De.primaryService||"خدمة غير محددة",courseName:oe.courseName||"كورس غير مسمى",score:oe.score??"غائب",attendance:oe.attendance||0})}),m(ue)}catch(ge){console.error("Error fetching students:",ge),ge.message.includes("permission-denied")||ge.message.includes("insufficient permissions")?k("خطأ في الأذونات: تأكد من تحديث قواعد أمان Firestore للسماح بقراءة البيانات."):k("حدث خطأ أثناء جلب بيانات الخدام. يرجى المحاولة مرة أخرى.")}finally{x(!1)}})()},[]),G.useEffect(()=>{const re=ge=>{se.current&&!se.current.contains(ge.target)&&O(!1),B.current&&!B.current.contains(ge.target)&&N(!1),ie.current&&!ie.current.contains(ge.target)&&fe(!1)};return document.addEventListener("mousedown",re),()=>document.removeEventListener("mousedown",re)},[]);const Ce=G.useMemo(()=>{const re=new Map;return h.forEach(ge=>{re.has(ge.code)||re.set(ge.code,{code:ge.code,name:ge.name,mobileNumber:ge.mobileNumber,primaryService:ge.service.split(" / ")[0]||"",allServices:ge.service.split(" / ").map(Te=>Te.trim()).filter(Boolean)})}),Array.from(re.values())},[h]);G.useEffect(()=>{if(we.trim()){const re=we.toLowerCase().trim(),ge=Ce.filter(Te=>Te.name.toLowerCase().includes(re)||Te.code.toLowerCase().includes(re)).slice(0,7);M(ge)}else M([])},[we,Ce]);const Be=re=>{ee(re),Ee(""),M([]),O(!1)},Fe=G.useMemo(()=>{if(h.length===0)return[];const re=new Set(h.map(ge=>ge.courseName.trim()).filter(Boolean));return["الكل",...Array.from(re).sort()]},[h]),ce=G.useMemo(()=>{if(h.length===0)return[];const re=new Set;return h.forEach(ge=>{ge.service.split(" / ").forEach(Te=>{Te.trim()&&re.add(Te.trim())})}),["الكل",...Array.from(re).sort()]},[h]);G.useEffect(()=>{Fe.length>1&&E(["الكل"]),ce.length>1&&P(["الكل"])},[Fe.length,ce.length]);const Ye=re=>{E(ge=>{const Te=Fe.filter(ye=>ye!=="الكل");if(re==="الكل")return ge.includes("الكل")?[]:Fe;let Oe=new Set(ge.filter(ye=>ye!=="الكل"));return Oe.has(re)?Oe.delete(re):Oe.add(re),Oe.size===Te.length?Fe:Array.from(Oe)})},hr=re=>{P(ge=>{const Te=ce.filter(ye=>ye!=="الكل");if(re==="الكل")return ge.includes("الكل")?[]:ce;let Oe=new Set(ge.filter(ye=>ye!=="الكل"));return Oe.has(re)?Oe.delete(re):Oe.add(re),Oe.size===Te.length?ce:Array.from(Oe)})},Re=G.useMemo(()=>{if(h.length===0)return null;const re=!I.includes("الكل"),ge=!L.includes("الكل");let Te=h;if(I.length===0||L.length===0)Te=[];else{if(re){const Ne=new Set(I);Te=Te.filter(Je=>Ne.has(Je.courseName.trim()))}if(ge){const Ne=new Set(L);Te=Te.filter(Je=>Je.service.split(" / ").map(Xt=>Xt.trim()).some(Xt=>Ne.has(Xt)))}}const Oe=new Set(h.map(Ne=>Ne.code)).size,ye=new Set(Te.map(Ne=>Ne.code)).size,Z=Te.filter(Ne=>Ne.score==="غائب"),ue=Te.filter(Ne=>typeof Ne.score=="number"),oe=Te.length,be=Z.length,De=ue.length,Pe=ue.reduce((Ne,Je)=>Ne+Je.score,0),tr=De>0?Math.round(Pe/De):0,lt=Te.reduce((Ne,Je)=>{const ua=typeof Je.attendance=="number"?Je.attendance:0,Xt=ua<=1?ua*100:ua;return Ne+Xt},0),Et=oe>0?Math.round(lt/oe):0,Er={"ممتاز (90+)":ue.filter(Ne=>Ne.score>=90),"جيد جداً (80-89)":ue.filter(Ne=>Ne.score>=80&&Ne.score<90),"جيد (70-79)":ue.filter(Ne=>Ne.score>=70&&Ne.score<80),"مقبول (60-69)":ue.filter(Ne=>Ne.score>=60&&Ne.score<70),"راسب (<60)":ue.filter(Ne=>Ne.score<60)},ft=Object.fromEntries(Object.entries(Er).map(([Ne,Je])=>[Ne,Je.length])),dt={"ممتاز (90+%)":Te.filter(Ne=>(Ne.attendance<=1?Ne.attendance*100:Ne.attendance)>=90),"جيد (75-89%)":Te.filter(Ne=>{const Je=Ne.attendance<=1?Ne.attendance*100:Ne.attendance;return Je>=75&&Je<90}),"مقبول (50-74%)":Te.filter(Ne=>{const Je=Ne.attendance<=1?Ne.attendance*100:Ne.attendance;return Je>=50&&Je<75}),"ضعيف (<50%)":Te.filter(Ne=>(Ne.attendance<=1?Ne.attendance*100:Ne.attendance)<50)},pt=Object.fromEntries(Object.entries(dt).map(([Ne,Je])=>[Ne,Je.length])),zt=new Map;ue.forEach(Ne=>{(!zt.has(Ne.code)||Ne.score>zt.get(Ne.code).score)&&zt.set(Ne.code,Ne)});const Qs=Array.from(zt.values()).sort((Ne,Je)=>Je.score-Ne.score).slice(0,5),Gt={};h.forEach(Ne=>{const Je=Ne.courseName.trim();Je&&(Gt[Je]||(Gt[Je]=[]),Gt[Je].push(Ne))});const en=Object.entries(Gt).map(([Ne,Je])=>({course:Ne,count:Je.length})).sort((Ne,Je)=>Je.count-Ne.count).slice(0,5);return{total:ye,totalUniqueInDB:Oe,present:De,absent:be,avgScore:tr,avgAttendance:Et,gradeDistribution:ft,courseDistribution:en,topPerformers:Qs,attendanceDistribution:pt,totalRegistrations:h.length,absentStudents:Z,presentStudents:ue,gradeDistributionLists:Er,attendanceDistributionLists:dt,courseDistributionAllRecords:Gt,isFiltered:re||ge,selectedRegistrations:oe}},[h,I,L]),Ur=re=>{Re!=null&&Re.gradeDistributionLists[re]&&he({title:`الخدام الحاصلون على تقدير "${re}"`,students:Re.gradeDistributionLists[re]})},Kr=re=>{Re!=null&&Re.attendanceDistributionLists[re]&&he({title:`الخدام في فئة الحضور "${re}"`,students:Re.attendanceDistributionLists[re]})},$r=()=>{!J.current||!window.html2canvas||(ke(!0),window.html2canvas(J.current,{scale:2,useCORS:!0,backgroundColor:s?"#1e293b":"#f8fafc"}).then(re=>{const ge=document.createElement("a");ge.href=re.toDataURL("image/png"),ge.download="dashboard.png",ge.click()}).catch(re=>console.error("Error exporting image:",re)).finally(()=>ke(!1)))},cr=[{id:"info",name:"المعلومات والإحصائيات",icon:o.jsx(gk,{})},{id:"ai_chat",name:"المساعد الذكي",icon:o.jsx(kk,{})},{id:"servants_data",name:"إدارة الخدام",icon:o.jsx(Ri,{})},{id:"courses_data",name:"إدارة نتائج الكورسات",icon:o.jsx(vk,{})},{id:"evaluations_data",name:"إدارة التقييمات",icon:o.jsx(wk,{})},{id:"usage_stats",name:"إحصائيات الاستخدام",icon:o.jsx(Fk,{})},{id:"texts_settings",name:"إعدادات نصوص الشهادة",icon:o.jsx(pk,{})},{id:"general_settings",name:"الإعدادات العامة والمظهر",icon:o.jsx(Nk,{})}],ae=()=>{if(g)return o.jsx("div",{className:"flex justify-center items-center h-96",children:o.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-indigo-600"})});switch(j){case"info":if(!Re)return o.jsx("p",{children:"لا توجد بيانات كافية لعرض الإحصائيات."});const re={"ممتاز (90+)":"bg-green-500","جيد جداً (80-89)":"bg-sky-500","جيد (70-79)":"bg-yellow-500","مقبول (60-69)":"bg-orange-500","راسب (<60)":"bg-red-500"},ge={"ممتاز (90+%)":"bg-green-500","جيد (75-89%)":"bg-sky-500","مقبول (50-74%)":"bg-orange-500","ضعيف (<50%)":"bg-red-500"};return o.jsxs("div",{ref:J,className:"space-y-8 bg-slate-50 dark:bg-slate-900 p-4 sm:p-6 rounded-lg",children:[o.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start gap-4",children:[o.jsxs("div",{children:[o.jsx("h2",{className:"text-2xl font-bold text-slate-800 dark:text-slate-100",children:"لوحة المعلومات"}),o.jsx("p",{className:"text-slate-500 dark:text-slate-400 mt-1",children:"نظرة شاملة على أداء الخدام في الكورسات المحددة."})]}),o.jsx("div",{className:"flex items-center gap-2",children:o.jsxs("button",{onClick:$r,disabled:q,className:"flex items-center px-4 py-2 bg-sky-100 text-sky-800 font-semibold rounded-lg hover:bg-sky-200 disabled:opacity-50 dark:bg-sky-900/50 dark:text-sky-300 dark:hover:bg-sky-900/70",children:[o.jsx(Ck,{})," ",q?"جاري الحفظ...":"حفظ كصورة"]})})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[o.jsx(As,{icon:o.jsx(Ri,{}),title:"إجمالي الخدام",value:Re.total,unit:" خادم",color:"bg-indigo-100 text-indigo-600 dark:bg-indigo-900/50 dark:text-indigo-300",description:`من إجمالي ${Re.totalUniqueInDB} في قاعدة البيانات`}),o.jsx(As,{icon:o.jsx(yk,{}),title:"الحضور",value:Re.present,unit:" خادم",color:"bg-green-100 text-green-600 dark:bg-green-900/50 dark:text-green-300",description:`${Re.selectedRegistrations>0?Math.round(Re.present/Re.selectedRegistrations*100):0}% من المحدد`,onClick:()=>he({title:"الخدام الحاضرون",students:Re.presentStudents})}),o.jsx(As,{icon:o.jsx(bk,{}),title:"الغياب",value:Re.absent,unit:" خادم",color:"bg-red-100 text-red-600 dark:bg-red-900/50 dark:text-red-300",description:`${Re.selectedRegistrations>0?Math.round(Re.absent/Re.selectedRegistrations*100):0}% من المحدد`,onClick:()=>he({title:"الخدام الغائبون",students:Re.absentStudents})}),o.jsx(As,{icon:o.jsx(Tk,{}),title:"متوسط الدرجات",value:Re.avgScore,unit:"/100",color:"bg-yellow-100 text-yellow-600 dark:bg-yellow-900/50 dark:text-yellow-300",description:"للخدام الحاضرين فقط"})]}),o.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[o.jsx(Mi,{title:"توزيع التقديرات",data:Re.gradeDistribution,colors:re,total:Re.present,icon:o.jsx(Ek,{}),onBarClick:Ur}),o.jsx(Mi,{title:"توزيع الحضور",data:Re.attendanceDistribution,colors:ge,total:Re.selectedRegistrations,icon:o.jsx(Sk,{}),onBarClick:Kr})]})]});case"ai_chat":return o.jsx(sw,{students:h});case"servants_data":return o.jsx(Lw,{});case"courses_data":return o.jsx(zw,{});case"evaluations_data":return o.jsx(ak,{});case"texts_settings":return o.jsx(lw,{certificateTexts:t,setCertificateTexts:r});case"general_settings":return o.jsx(ok,{setTheme:a,isDarkMode:s,setIsDarkMode:n,customStyles:i,setCustomStyles:c,setBackgroundUrl:l,backgroundUrl:f,backgroundGallery:d,setBackgroundGallery:u});case"usage_stats":return o.jsx(uk,{});default:return null}};return o.jsxs("div",{className:"w-full max-w-7xl mx-auto admin-font bg-slate-50 dark:bg-slate-900 rounded-2xl shadow-2xl border border-black/5 dark:border-white/5 animate-fade-in-up mt-[-2rem] mb-8",children:[o.jsxs("div",{className:"flex flex-col lg:flex-row min-h-[80vh]",children:[o.jsxs("div",{className:"lg:hidden p-4 flex justify-between items-center border-b border-gray-200 dark:border-slate-700",children:[o.jsx("h2",{className:"text-lg font-bold text-slate-800 dark:text-slate-100",children:"لوحة التحكم"}),o.jsx("button",{onClick:()=>H(!Ve),className:"p-2 rounded-md hover:bg-gray-100 dark:hover:bg-slate-800",children:Ve?o.jsx(mk,{}):o.jsx(xk,{})})]}),o.jsxs("aside",{className:`flex-shrink-0 w-full lg:w-64 bg-white dark:bg-slate-800/50 border-r border-gray-200 dark:border-slate-700/50 rounded-r-2xl lg:rounded-r-none lg:rounded-l-2xl transition-all duration-300 ${Ve?"block":"hidden"} lg:block`,children:[o.jsxs("div",{className:"p-6",children:[o.jsx("h2",{className:"text-xl font-bold text-slate-800 dark:text-slate-100",children:"لوحة التحكم"}),o.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400 mt-1",children:"كنيسة القديس بولس"})]}),o.jsxs("nav",{className:"flex flex-col p-4",children:[cr.map(re=>o.jsxs("button",{onClick:()=>{R(re.id),H(!1)},className:`flex items-center gap-3 px-4 py-3 rounded-lg text-sm font-semibold transition-colors ${j===re.id?"bg-indigo-50 dark:bg-indigo-500/10 text-indigo-700 dark:text-indigo-300":"text-slate-600 dark:text-slate-300 hover:bg-gray-100 dark:hover:bg-slate-700/50"}`,children:[re.icon,o.jsx("span",{children:re.name})]},re.id)),o.jsxs("button",{onClick:e,className:"flex items-center gap-3 px-4 py-3 mt-4 rounded-lg text-sm font-semibold text-slate-600 dark:text-slate-300 hover:bg-gray-100 dark:hover:bg-slate-700/50",children:[o.jsx(_k,{}),o.jsx("span",{children:"تسجيل الخروج"})]})]})]}),o.jsxs("main",{className:"flex-grow p-4 sm:p-6 lg:p-8",children:[o.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start gap-4 mb-6",children:[o.jsxs("div",{ref:se,className:"relative w-full sm:max-w-md",children:[o.jsx("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none",children:o.jsx("svg",{className:"h-5 w-5 text-gray-400",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),o.jsx("input",{type:"text",placeholder:"بحث سريع عن خادم...",value:we,onChange:re=>Ee(re.target.value),onFocus:()=>O(!0),className:"w-full px-4 py-2 pr-10 text-gray-700 bg-white dark:bg-slate-800 border border-gray-300 dark:border-slate-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 dark:text-gray-200"}),D&&A.length>0&&o.jsx("div",{className:"absolute z-10 top-full mt-2 w-full bg-white dark:bg-slate-800 border border-gray-200 dark:border-slate-700 rounded-lg shadow-xl overflow-hidden",children:o.jsx("ul",{className:"divide-y divide-gray-100 dark:divide-slate-700",children:A.map(re=>o.jsxs("li",{onClick:()=>Be(re),className:"px-4 py-3 hover:bg-gray-50 dark:hover:bg-slate-700 cursor-pointer",children:[o.jsx("p",{className:"font-semibold text-gray-800 dark:text-gray-200",children:re.name}),o.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:["الكود: ",re.code]})]},re.code))})})]}),j==="info"&&o.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 w-full sm:w-auto",children:[o.jsxs("div",{ref:B,className:"relative w-full sm:w-48",children:[o.jsxs("button",{onClick:()=>N(!U),className:"w-full flex justify-between items-center px-4 py-2 bg-white dark:bg-slate-800 border border-gray-300 dark:border-slate-600 rounded-lg text-sm font-medium text-gray-700 dark:text-gray-200",children:[o.jsx("span",{children:"فلتر الكورسات"}),o.jsx("svg",{className:"h-5 w-5",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:o.jsx("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})]}),U&&o.jsx("div",{className:"absolute z-10 top-full mt-2 w-full bg-white dark:bg-slate-800 border border-gray-200 dark:border-slate-700 rounded-lg shadow-xl max-h-60 overflow-y-auto",children:Fe.map(re=>o.jsxs("label",{className:"flex items-center px-4 py-2 text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-50 dark:hover:bg-slate-700 cursor-pointer",children:[o.jsx("input",{type:"checkbox",checked:I.includes(re),onChange:()=>Ye(re),className:"h-4 w-4 text-indigo-600 border-gray-300 rounded focus:ring-indigo-500"}),o.jsx("span",{className:"mr-3",children:re})]},re))})]}),o.jsxs("div",{ref:ie,className:"relative w-full sm:w-48",children:[o.jsxs("button",{onClick:()=>fe(!Q),className:"w-full flex justify-between items-center px-4 py-2 bg-white dark:bg-slate-800 border border-gray-300 dark:border-slate-600 rounded-lg text-sm font-medium text-gray-700 dark:text-gray-200",children:[o.jsx("span",{children:"فلتر الخدمات"}),o.jsx("svg",{className:"h-5 w-5",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:o.jsx("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})]}),Q&&o.jsx("div",{className:"absolute z-10 top-full mt-2 w-full bg-white dark:bg-slate-800 border border-gray-200 dark:border-slate-700 rounded-lg shadow-xl max-h-60 overflow-y-auto",children:ce.map(re=>o.jsxs("label",{className:"flex items-center px-4 py-2 text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-50 dark:hover:bg-slate-700 cursor-pointer",children:[o.jsx("input",{type:"checkbox",checked:L.includes(re),onChange:()=>hr(re),className:"h-4 w-4 text-indigo-600 border-gray-300 rounded focus:ring-indigo-500"}),o.jsx("span",{className:"mr-3",children:re})]},re))})]})]})]}),ae()]})]}),pe&&o.jsx(cw,{title:pe.title,students:pe.students,onClose:()=>he(null)}),W&&o.jsx(Jo,{servant:W,onClose:()=>ee(null)})]})};export{jk as default};
